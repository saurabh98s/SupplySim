[0m22:19:24.445288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c8c7417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c89f89a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c89f8bbf0>]}


============================== 22:19:24.451671 | 4c771165-743c-4dba-a96a-2e57a6141953 ==============================
[0m22:19:24.451671 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:19:24.452911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:19:24.465756 [info ] [MainThread]: dbt version: 1.8.7
[0m22:19:24.466839 [info ] [MainThread]: python version: 3.12.3
[0m22:19:24.467761 [info ] [MainThread]: python path: /home/airflow/.local/bin/python
[0m22:19:24.468603 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m22:19:25.229346 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m22:19:25.231034 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m22:19:25.232458 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_project.yml
[0m22:19:25.233877 [info ] [MainThread]: adapter type: snowflake
[0m22:19:25.234968 [info ] [MainThread]: adapter version: 1.8.4
[0m22:19:25.325396 [info ] [MainThread]: Configuration:
[0m22:19:25.326730 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:19:25.327821 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:19:25.328778 [info ] [MainThread]: Required dependencies:
[0m22:19:25.329669 [debug] [MainThread]: Executing "git --help"
[0m22:19:25.331220 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m22:19:25.332090 [info ] [MainThread]: Connection:
[0m22:19:25.333020 [info ] [MainThread]:   account: VTREECD-SF05286
[0m22:19:25.333886 [info ] [MainThread]:   user: imsaurabh
[0m22:19:25.334706 [info ] [MainThread]:   database: STOCK_PRICE_DB
[0m22:19:25.335541 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m22:19:25.336355 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m22:19:25.337207 [info ] [MainThread]:   schema: RAW_DATA
[0m22:19:25.338017 [info ] [MainThread]:   authenticator: None
[0m22:19:25.338910 [info ] [MainThread]:   oauth_client_id: None
[0m22:19:25.339773 [info ] [MainThread]:   query_tag: None
[0m22:19:25.340909 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:19:25.342043 [info ] [MainThread]:   host: None
[0m22:19:25.343186 [info ] [MainThread]:   port: None
[0m22:19:25.344246 [info ] [MainThread]:   proxy_host: None
[0m22:19:25.345212 [info ] [MainThread]:   proxy_port: None
[0m22:19:25.346127 [info ] [MainThread]:   protocol: None
[0m22:19:25.347029 [info ] [MainThread]:   connect_retries: 1
[0m22:19:25.347954 [info ] [MainThread]:   connect_timeout: None
[0m22:19:25.348850 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:19:25.349886 [info ] [MainThread]:   retry_all: False
[0m22:19:25.350812 [info ] [MainThread]:   insecure_mode: False
[0m22:19:25.351771 [info ] [MainThread]:   reuse_connections: None
[0m22:19:25.352852 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:19:25.441443 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:19:25.443167 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:19:25.444156 [debug] [MainThread]: On debug: select 1 as id
[0m22:19:25.445017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:26.088226 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.643 seconds
[0m22:19:26.089984 [debug] [MainThread]: On debug: Close
[0m22:19:26.242703 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:19:26.244143 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:19:26.245477 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m22:19:26.247167 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.901959, "process_user_time": 2.778745, "process_kernel_time": 1.317303, "process_mem_max_rss": "228836", "process_in_blocks": "736", "process_out_blocks": "1232", "command_success": false}
[0m22:19:26.248528 [debug] [MainThread]: Command `dbt debug` failed at 22:19:26.248362 after 1.90 seconds
[0m22:19:26.249516 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:19:26.250969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c8a90b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c59249ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c58315880>]}
[0m22:19:26.252396 [debug] [MainThread]: Flushing usage events
[0m22:19:32.790389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0615b0e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f061696db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0614016ab0>]}


============================== 22:19:32.797284 | 40482fac-97aa-4e97-bbb8-0bf19ef08cf5 ==============================
[0m22:19:32.797284 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:19:32.798701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:19:33.678640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40482fac-97aa-4e97-bbb8-0bf19ef08cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dec68770>]}
[0m22:19:33.734396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40482fac-97aa-4e97-bbb8-0bf19ef08cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0614e0ab10>]}
[0m22:19:33.736146 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:19:33.839603 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:19:33.843101 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:19:33.844404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40482fac-97aa-4e97-bbb8-0bf19ef08cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dfe8da30>]}
[0m22:19:35.096232 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: A 'timestamp' snapshot should not have 'check_cols'
[0m22:19:35.098444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4054246, "process_user_time": 4.033894, "process_kernel_time": 1.172761, "process_mem_max_rss": "237112", "process_in_blocks": "2464", "command_success": false, "process_out_blocks": "0"}
[0m22:19:35.099632 [debug] [MainThread]: Command `dbt run` failed at 22:19:35.099490 after 2.41 seconds
[0m22:19:35.100599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0614c433b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05de2f67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05de4a1e50>]}
[0m22:19:35.101545 [debug] [MainThread]: Flushing usage events
[0m22:20:38.744036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54ba46480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54ac474a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa549efe840>]}


============================== 22:20:38.750222 | ab3f7ce4-7ab2-40f9-9424-fe22d97f11c2 ==============================
[0m22:20:38.750222 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:20:38.751472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:20:39.645937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab3f7ce4-7ab2-40f9-9424-fe22d97f11c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51859c230>]}
[0m22:20:39.704026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab3f7ce4-7ab2-40f9-9424-fe22d97f11c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa519b5d6d0>]}
[0m22:20:39.705829 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:20:39.804116 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:20:39.807108 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:20:39.808314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab3f7ce4-7ab2-40f9-9424-fe22d97f11c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54b425f40>]}
[0m22:20:41.071426 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:20:41.073010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ab3f7ce4-7ab2-40f9-9424-fe22d97f11c2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51875d580>]}
[0m22:20:41.431390 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='schema.yml', modification_time=1733177242.5861285, project_root='/opt/airflow/dbt') @ metrics: {'name': 'monthly_revenue', 'label': 'Monthly Revenue', 'model': "ref('monthly_sales')", 'calculation_method': 'expression', 'expression': 'total_revenue', 'timestamp': 'sales_month', 'time_grains': ['month', 'quarter', 'year'], 'dimensions': ['SKU']} - at path []: Additional properties are not allowed ('calculation_method', 'dimensions', 'expression', 'model', 'time_grains', 'timestamp' were unexpected)
[0m22:20:41.433463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.792045, "process_user_time": 4.383131, "process_kernel_time": 1.293876, "process_mem_max_rss": "245084", "process_in_blocks": "72", "command_success": false, "process_out_blocks": "0"}
[0m22:20:41.434878 [debug] [MainThread]: Command `dbt run` failed at 22:20:41.434727 after 2.79 seconds
[0m22:20:41.435830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa549f7b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa549a44b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa511ef0140>]}
[0m22:20:41.436840 [debug] [MainThread]: Flushing usage events
[0m22:24:16.197331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54ca42abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54ca7721e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54ca6ffb30>]}


============================== 22:24:16.203858 | 4e24f5ce-475c-4ae1-8cd8-46097fdbbe94 ==============================
[0m22:24:16.203858 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:24:16.205034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:24:17.069358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e24f5ce-475c-4ae1-8cd8-46097fdbbe94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5498bf63f0>]}
[0m22:24:17.123132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e24f5ce-475c-4ae1-8cd8-46097fdbbe94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f549a2bd910>]}
[0m22:24:17.124962 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:24:17.214273 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:24:17.217103 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:24:17.218394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e24f5ce-475c-4ae1-8cd8-46097fdbbe94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5498a563f0>]}
[0m22:24:18.524877 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m22:24:18.526235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e24f5ce-475c-4ae1-8cd8-46097fdbbe94', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54987a91c0>]}
[0m22:24:18.879648 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='schema.yml', modification_time=1733178232.1016164, project_root='/opt/airflow/dbt') @ metrics: {'name': 'monthly_revenue', 'label': 'Monthly Revenue', 'model': "ref('monthly_sales')", 'calculation_method': 'expression', 'expression': 'total_revenue', 'timestamp': 'sales_month', 'time_grains': ['month', 'quarter', 'year'], 'dimensions': ['SKU']} - at path []: Additional properties are not allowed ('calculation_method', 'dimensions', 'expression', 'model', 'time_grains', 'timestamp' were unexpected)
[0m22:24:18.881897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7977462, "process_user_time": 4.477349, "process_kernel_time": 1.248349, "process_mem_max_rss": "242728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:24:18.883055 [debug] [MainThread]: Command `dbt run` failed at 22:24:18.882892 after 2.80 seconds
[0m22:24:18.883889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5499650770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5498149760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54981b83b0>]}
[0m22:24:18.884666 [debug] [MainThread]: Flushing usage events
[0m22:26:49.632442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7d8d5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7da87680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b8021dc40>]}


============================== 22:26:49.639540 | c9637a35-17b3-47e5-9e10-a4d96af9cd3e ==============================
[0m22:26:49.639540 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:26:49.640703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:26:50.523803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9637a35-17b3-47e5-9e10-a4d96af9cd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7d390f80>]}
[0m22:26:50.580805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9637a35-17b3-47e5-9e10-a4d96af9cd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7d391130>]}
[0m22:26:50.582684 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:26:50.674923 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:26:50.677999 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:26:50.679043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9637a35-17b3-47e5-9e10-a4d96af9cd3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7e7263f0>]}
[0m22:26:51.988095 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='metrics.yml', modification_time=1733178396.3117754, project_root='/opt/airflow/dbt') @ metrics: {'name': 'monthly_revenue', 'label': 'Monthly Revenue', 'description': 'Total revenue generated monthly', 'calculation_method': 'sum', 'expression': 'total_revenue', 'timestamp': 'sales_month', 'dimensions': ['SKU'], 'time_grains': ['month', 'quarter', 'year']} - at path []: Additional properties are not allowed ('calculation_method', 'dimensions', 'expression', 'time_grains', 'timestamp' were unexpected)
[0m22:26:51.990069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4565668, "process_user_time": 4.045639, "process_kernel_time": 1.218686, "process_mem_max_rss": "238464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:26:51.991521 [debug] [MainThread]: Command `dbt run` failed at 22:26:51.991354 after 2.46 seconds
[0m22:26:51.992633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b7dfe97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b47d6fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b47c05ca0>]}
[0m22:26:51.993775 [debug] [MainThread]: Flushing usage events
[0m22:27:51.830527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05d82b4a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05d82b4aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05d82b4b30>]}


============================== 22:27:51.836796 | 4d9b0708-22dc-461e-ad65-40825d707d77 ==============================
[0m22:27:51.836796 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:27:51.837941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:27:52.724562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d9b0708-22dc-461e-ad65-40825d707d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a7d62330>]}
[0m22:27:52.778887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d9b0708-22dc-461e-ad65-40825d707d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a5f39640>]}
[0m22:27:52.780508 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:27:52.875772 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:27:52.878968 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:27:52.880173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d9b0708-22dc-461e-ad65-40825d707d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a63e8d70>]}
[0m22:27:54.214494 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='metrics.yml', modification_time=1733178464.9936252, project_root='/opt/airflow/dbt') @ metrics: {'name': 'monthly_revenue', 'label': 'Monthly Revenue', 'description': 'Total revenue generated monthly', 'type': 'sum', 'sql': 'total_revenue', 'timestamp': 'sales_month', 'filters': [{'field': 'SKU', 'operator': 'is_not_null'}], 'time_grains': ['month', 'quarter', 'year']} - at path []: Additional properties are not allowed ('filters', 'sql', 'time_grains', 'timestamp' were unexpected)
[0m22:27:54.216689 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4930375, "process_user_time": 4.117206, "process_kernel_time": 1.255245, "process_mem_max_rss": "244684", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:27:54.218099 [debug] [MainThread]: Command `dbt run` failed at 22:27:54.217941 after 2.49 seconds
[0m22:27:54.219122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a569e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a5616930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05a41904a0>]}
[0m22:27:54.219949 [debug] [MainThread]: Flushing usage events
[0m22:29:12.848208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed80193ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed82225b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7f8ce9c0>]}


============================== 22:29:12.854261 | 32575935-d824-49d0-b4d9-ad2e1769cf43 ==============================
[0m22:29:12.854261 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:29:12.855473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:29:13.709513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32575935-d824-49d0-b4d9-ad2e1769cf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed80d8c2f0>]}
[0m22:29:13.765077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32575935-d824-49d0-b4d9-ad2e1769cf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4a0dc620>]}
[0m22:29:13.767076 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:29:13.870008 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:29:13.873504 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:29:13.874698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32575935-d824-49d0-b4d9-ad2e1769cf43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed8023b9b0>]}
[0m22:29:15.193952 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='metrics.yml', modification_time=1733178548.4599464, project_root='/opt/airflow/dbt') @ metrics: {'name': 'monthly_revenue', 'label': 'Monthly Revenue', 'description': 'Total revenue generated monthly', 'calculation_method': 'sum', 'expression': 'total_revenue', 'timestamp': 'sales_month', 'dimensions': ['SKU'], 'time_grains': ['month', 'quarter', 'year']} - at path []: Additional properties are not allowed ('calculation_method', 'dimensions', 'expression', 'time_grains', 'timestamp' were unexpected)
[0m22:29:15.196868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.444956, "process_user_time": 4.007887, "process_kernel_time": 1.293185, "process_mem_max_rss": "220124", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:29:15.198286 [debug] [MainThread]: Command `dbt run` failed at 22:29:15.198137 after 2.45 seconds
[0m22:29:15.199464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed80193ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1b9bca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed5059b170>]}
[0m22:29:15.200454 [debug] [MainThread]: Flushing usage events
[0m22:32:32.283239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295bcd6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295c9ab5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295be2f920>]}


============================== 22:32:32.290104 | 6e880ce1-8edf-4095-a027-42d1e9dc0775 ==============================
[0m22:32:32.290104 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:32:32.291513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:32:33.247743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e880ce1-8edf-4095-a027-42d1e9dc0775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295b784050>]}
[0m22:32:33.315404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e880ce1-8edf-4095-a027-42d1e9dc0775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295cb4be90>]}
[0m22:32:33.317324 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:32:33.451642 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:32:33.455122 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:32:33.456462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e880ce1-8edf-4095-a027-42d1e9dc0775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2926319d60>]}
[0m22:32:34.894999 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='metrics.yml', modification_time=1733178745.3897157, project_root='/opt/airflow/dbt') @ metrics: {'name': 'monthly_revenue', 'description': 'Total revenue generated monthly', 'type': 'simple', 'label': 'Monthly Revenue', 'type_params': {'measure': {'name': 'total_revenue', 'fill_nulls_with': 0}}, 'time_granularity': 'month'} - at path []: Additional properties are not allowed ('time_granularity' was unexpected)
[0m22:32:34.897504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7189407, "process_user_time": 4.261393, "process_kernel_time": 1.296508, "process_mem_max_rss": "235712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:32:34.898829 [debug] [MainThread]: Command `dbt run` failed at 22:32:34.898699 after 2.72 seconds
[0m22:32:34.899792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295c84c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2925f00230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290fc04440>]}
[0m22:32:34.900710 [debug] [MainThread]: Flushing usage events
[0m22:40:22.577953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f6a8cd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f67fa7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f6891ed80>]}


============================== 22:40:22.583898 | 0f522360-d583-4f43-baf8-ac01cf20d9b0 ==============================
[0m22:40:22.583898 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:40:22.585290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:40:23.440448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f522360-d583-4f43-baf8-ac01cf20d9b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f33b182f0>]}
[0m22:40:23.493788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f522360-d583-4f43-baf8-ac01cf20d9b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f32ca0fe0>]}
[0m22:40:23.495528 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:40:23.596803 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:40:23.599619 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:40:23.600776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f522360-d583-4f43-baf8-ac01cf20d9b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f325d9cd0>]}
[0m22:40:24.890812 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='metrics.yml', modification_time=1733178745.3897157, project_root='/opt/airflow/dbt') @ metrics: {'name': 'monthly_revenue', 'description': 'Total revenue generated monthly', 'type': 'simple', 'label': 'Monthly Revenue', 'type_params': {'measure': {'name': 'total_revenue', 'fill_nulls_with': 0}}, 'time_granularity': 'month'} - at path []: Additional properties are not allowed ('time_granularity' was unexpected)
[0m22:40:24.893757 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4156826, "process_user_time": 4.043662, "process_kernel_time": 1.202989, "process_mem_max_rss": "240248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:40:24.895063 [debug] [MainThread]: Command `dbt run` failed at 22:40:24.894938 after 2.42 seconds
[0m22:40:24.896008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f6bdc6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f3267e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f303549e0>]}
[0m22:40:24.896903 [debug] [MainThread]: Flushing usage events
[0m22:41:41.535377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df00188f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df0019d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df001a870>]}


============================== 22:41:41.541700 | afa08611-e36a-4adc-857e-d34dfa5d6ee7 ==============================
[0m22:41:41.541700 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:41:41.543005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:41:42.440035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afa08611-e36a-4adc-857e-d34dfa5d6ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df12e06e0>]}
[0m22:41:42.494791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afa08611-e36a-4adc-857e-d34dfa5d6ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dbac3ee40>]}
[0m22:41:42.496537 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:41:42.592284 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:41:42.595145 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:41:42.596285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'afa08611-e36a-4adc-857e-d34dfa5d6ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dba8ad160>]}
[0m22:41:44.020782 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid metrics config given in FilePath(searched_path='models', relative_path='metrics.yml', modification_time=1733179296.8966277, project_root='/opt/airflow/dbt') @ metrics: {'name': 'stock_turnover_ratio', 'description': 'Ratio of total products sold to average stock levels', 'type': 'ratio', 'label': 'Stock Turnover Ratio', 'type_params': {'numerator': {'name': 'total_products_sold', 'fill_nulls_with': 0}, 'denominator': {'name': 'average_stock_levels', 'fill_nulls_with': 1}}} - at path ['type_params']['numerator']: {'name': 'total_products_sold', 'fill_nulls_with': 0} is not valid under any of the given schemas
[0m22:41:44.023009 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5882943, "process_user_time": 4.081048, "process_kernel_time": 1.320339, "process_mem_max_rss": "239828", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:41:44.024282 [debug] [MainThread]: Command `dbt run` failed at 22:41:44.024126 after 2.59 seconds
[0m22:41:44.025273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5defdb0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d7be052e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dba529610>]}
[0m22:41:44.026184 [debug] [MainThread]: Flushing usage events
[0m00:29:26.005963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb237d2e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2361e4ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb238b95be0>]}


============================== 00:29:26.012641 | c2188541-de38-440e-a778-e13313390a78 ==============================
[0m00:29:26.012641 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:29:26.013994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:29:26.847994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2188541-de38-440e-a778-e13313390a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb206754b00>]}
[0m00:29:26.900821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2188541-de38-440e-a778-e13313390a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2362529f0>]}
[0m00:29:26.903144 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:29:26.994864 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:29:26.998188 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:29:26.999478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2188541-de38-440e-a778-e13313390a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb236344890>]}
[0m00:29:28.372148 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:29:28.373851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c2188541-de38-440e-a778-e13313390a78', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fe3d15b0>]}
[0m00:29:28.643054 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid semantic_models config given in FilePath(searched_path='models', relative_path='schema.yml', modification_time=1733185741.8845353, project_root='/opt/airflow/dbt') @ semantic_models: {'name': 'monthly_sales_semantic', 'model': "ref('monthly_sales')", 'description': 'Semantic model for monthly sales data', 'primary_key': ['SKU', 'sales_month'], 'dimensions': [{'name': 'sales_month', 'type': 'time', 'type_params': {'time_granularity': 'month'}}, {'name': 'SKU', 'type': 'categorical'}, {'name': 'PRODUCT_TYPE', 'type': 'categorical'}], 'measures': [{'name': 'total_revenue', 'expr': 'total_revenue', 'agg': 'sum'}, {'name': 'total_products_sold', 'expr': 'total_products_sold', 'agg': 'sum'}, {'name': 'average_stock_levels', 'expr': 'average_stock_levels', 'agg': 'average'}, {'name': 'total_costs', 'expr': 'total_costs', 'agg': 'sum'}, {'name': 'total_profit', 'expr': 'total_revenue - total_costs', 'agg': 'sum'}]} - at path []: Additional properties are not allowed ('primary_key' was unexpected)
[0m00:29:28.645762 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7459795, "process_user_time": 4.318707, "process_kernel_time": 1.279617, "process_mem_max_rss": "239788", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:29:28.647169 [debug] [MainThread]: Command `dbt run` failed at 00:29:28.647033 after 2.75 seconds
[0m00:29:28.648192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb237a305c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1fe3e9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb20c568ad0>]}
[0m00:29:28.649179 [debug] [MainThread]: Flushing usage events
[0m00:30:14.138603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb950c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ec096f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb952db0>]}


============================== 00:30:14.144781 | 24471b5f-e48c-4a0b-8dc6-46eb6d836af5 ==============================
[0m00:30:14.144781 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:30:14.146263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:30:15.009125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24471b5f-e48c-4a0b-8dc6-46eb6d836af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ec702570>]}
[0m00:30:15.065213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24471b5f-e48c-4a0b-8dc6-46eb6d836af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ecb77aa0>]}
[0m00:30:15.066926 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:30:15.161394 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:30:15.164539 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:30:15.165746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24471b5f-e48c-4a0b-8dc6-46eb6d836af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b5f11880>]}
[0m00:30:16.547305 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:30:16.549208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '24471b5f-e48c-4a0b-8dc6-46eb6d836af5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b60ae2a0>]}
[0m00:30:16.898227 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.supply_chain_project.sales_data' (models/sales_data.sql) depends on a source named 'live.live_data' which was not found
[0m00:30:16.900149 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.8604949, "process_user_time": 4.3972, "process_kernel_time": 1.31558, "process_mem_max_rss": "241392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:30:16.901264 [debug] [MainThread]: Command `dbt run` failed at 00:30:16.901143 after 2.86 seconds
[0m00:30:16.902103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0eb97bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08f953e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08f9943e0>]}
[0m00:30:16.902908 [debug] [MainThread]: Flushing usage events
[0m00:31:11.250568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ca5217f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ca522870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ca522ba0>]}


============================== 00:31:11.257096 | f39cf17a-9b2d-407c-820a-1a1efd770839 ==============================
[0m00:31:11.257096 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:31:11.258380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:31:12.111250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f39cf17a-9b2d-407c-820a-1a1efd770839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f629ae2eed0>]}
[0m00:31:12.164843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f39cf17a-9b2d-407c-820a-1a1efd770839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6299d97c50>]}
[0m00:31:12.166713 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:31:12.258984 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:31:12.262338 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:31:12.263503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f39cf17a-9b2d-407c-820a-1a1efd770839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62caade780>]}
[0m00:31:13.698966 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:31:13.700248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f39cf17a-9b2d-407c-820a-1a1efd770839', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f629869af90>]}
[0m00:31:14.101889 [error] [MainThread]: Encountered an error:
Parsing Error in metric stock_turnover_ratio (models/metrics.yml)
  The metric `total_products_sold` does not exist but was referenced.
[0m00:31:14.104698 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9516587, "process_user_time": 4.666292, "process_kernel_time": 1.343175, "process_mem_max_rss": "247692", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:31:14.106419 [debug] [MainThread]: Command `dbt run` failed at 00:31:14.106247 after 2.95 seconds
[0m00:31:14.107561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62cb3b2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62cbd57da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f629813cad0>]}
[0m00:31:14.108719 [debug] [MainThread]: Flushing usage events
[0m00:34:38.250812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370efa0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370eab4aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370fdfe270>]}


============================== 00:34:38.256692 | 65d303a1-40a4-4f75-9cd3-e928c76cf0eb ==============================
[0m00:34:38.256692 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:34:38.258090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt parse', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:34:39.088949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65d303a1-40a4-4f75-9cd3-e928c76cf0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370fabc1d0>]}
[0m00:34:39.147526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65d303a1-40a4-4f75-9cd3-e928c76cf0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dd25c500>]}
[0m00:34:39.150026 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:34:39.253174 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:34:39.255969 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:34:39.257046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '65d303a1-40a4-4f75-9cd3-e928c76cf0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370fa4d8b0>]}
[0m00:34:40.779139 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:34:40.782333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '65d303a1-40a4-4f75-9cd3-e928c76cf0eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dd033e60>]}
[0m00:34:41.228527 [error] [MainThread]: Encountered an error:
Parsing Error in metric stock_turnover_ratio (models/metrics.yml)
  The metric `total_products_sold` does not exist but was referenced.
[0m00:34:41.230910 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_wall_clock_time": 3.0775013, "process_user_time": 4.664165, "process_kernel_time": 1.235141, "process_mem_max_rss": "227708", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:34:41.232168 [debug] [MainThread]: Command `dbt parse` failed at 00:34:41.232025 after 3.08 seconds
[0m00:34:41.233037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370efa0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36dcf18c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36df22c200>]}
[0m00:34:41.233885 [debug] [MainThread]: Flushing usage events
[0m00:38:24.187065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5188e720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca50194d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca50194c80>]}


============================== 00:38:24.193617 | c1aa0c39-0c16-422f-8072-4c9d98d59c3a ==============================
[0m00:38:24.193617 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:38:24.194897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:38:25.045331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1aa0c39-0c16-422f-8072-4c9d98d59c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1db44800>]}
[0m00:38:25.105411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1aa0c39-0c16-422f-8072-4c9d98d59c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1d845ca0>]}
[0m00:38:25.107081 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:38:25.219276 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:38:25.222332 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:38:25.223592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1aa0c39-0c16-422f-8072-4c9d98d59c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1d6f49e0>]}
[0m00:38:26.615958 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:38:26.617870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1aa0c39-0c16-422f-8072-4c9d98d59c3a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1d1e61e0>]}
[0m00:38:27.023963 [error] [MainThread]: Encountered an error:
Parsing Error in metric stock_turnover_ratio (models/metrics.yml)
  The metric `total_products_sold` does not exist but was referenced.
[0m00:38:27.026259 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9415119, "process_user_time": 4.459475, "process_kernel_time": 1.313952, "process_mem_max_rss": "239072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:38:27.027341 [debug] [MainThread]: Command `dbt run` failed at 00:38:27.027220 after 2.94 seconds
[0m00:38:27.028227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca52ccb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1d349250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca1d3481d0>]}
[0m00:38:27.029139 [debug] [MainThread]: Flushing usage events
[0m00:46:36.968951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7d5653a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7da0e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7b13c980>]}


============================== 00:46:36.975063 | 9defcab9-8c25-40bb-bc2c-f180753bf1cc ==============================
[0m00:46:36.975063 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:46:36.976229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:46:37.817128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9defcab9-8c25-40bb-bc2c-f180753bf1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7b7d9d00>]}
[0m00:46:37.869539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9defcab9-8c25-40bb-bc2c-f180753bf1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7bcfaf00>]}
[0m00:46:37.871502 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:46:37.968801 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:46:37.971837 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:46:37.973012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9defcab9-8c25-40bb-bc2c-f180753bf1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7be330e0>]}
[0m00:46:39.361857 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:46:39.363552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9defcab9-8c25-40bb-bc2c-f180753bf1cc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c49549e80>]}
[0m00:46:39.791935 [error] [MainThread]: Encountered an error:
Parsing Error
  The semantic layer requires a 'metricflow_time_spine' model in the project, but none was found. Guidance on creating this model can be found on our docs site (https://docs.getdbt.com/docs/build/metricflow-time-spine) 
[0m00:46:39.794025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9269192, "process_user_time": 4.49929, "process_kernel_time": 1.295554, "process_mem_max_rss": "244048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:46:39.795067 [debug] [MainThread]: Command `dbt run` failed at 00:46:39.794953 after 2.93 seconds
[0m00:46:39.795981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7bbca300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c23039610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c230396a0>]}
[0m00:46:39.796943 [debug] [MainThread]: Flushing usage events
[0m00:55:19.322172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d16c8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91cf142c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91cf1400e0>]}


============================== 00:55:19.328801 | 0b040bf2-206b-4700-addd-89b473d3f64f ==============================
[0m00:55:19.328801 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:55:19.329947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select metricflow_time_spine', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:55:20.198990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b040bf2-206b-4700-addd-89b473d3f64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91cedaca40>]}
[0m00:55:20.253199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b040bf2-206b-4700-addd-89b473d3f64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919dc853a0>]}
[0m00:55:20.255005 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:55:20.349120 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:55:20.352440 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:55:20.353528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b040bf2-206b-4700-addd-89b473d3f64f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f919db14890>]}
[0m00:55:21.726132 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:55:21.727601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b040bf2-206b-4700-addd-89b473d3f64f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91ced85460>]}
[0m00:55:22.164544 [error] [MainThread]: Invalid name `SKU` - names may only contain lower case letters, numbers, and underscores. Additionally, names must start with a lower case letter, cannot end with an underscore, cannot contain dunders (double underscores, or __), and must be at least 2 characters long.
[0m00:55:22.166399 [error] [MainThread]: Invalid name `PRODUCT_TYPE` - names may only contain lower case letters, numbers, and underscores. Additionally, names must start with a lower case letter, cannot end with an underscore, cannot contain dunders (double underscores, or __), and must be at least 2 characters long.
[0m00:55:22.167672 [error] [MainThread]: An error occurred while checking aggregation time dimension for a semantic model - AssertionError: Aggregation time dimension for measure total_revenue is not set! This should either be set directly on the measure specification in the model, or else defaulted to the primary time dimension in the data source containing the measure.

[0m00:55:22.168865 [error] [MainThread]: The semantic model monthly_sales_semantic contains dimensions, but it does not define a primary entity. Either add an entity with type PRIMARY or set a value for the primary_entity key.
[0m00:55:22.170216 [error] [MainThread]: Encountered an error:
Parsing Error
  Semantic Manifest validation failed.
[0m00:55:22.172057 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9516692, "process_user_time": 4.507381, "process_kernel_time": 1.293509, "process_mem_max_rss": "243712", "process_in_blocks": "56", "command_success": false, "process_out_blocks": "0"}
[0m00:55:22.173374 [debug] [MainThread]: Command `dbt run` failed at 00:55:22.173242 after 2.95 seconds
[0m00:55:22.174545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d16c8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9177206ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d1f15c70>]}
[0m00:55:22.175542 [debug] [MainThread]: Flushing usage events
[0m00:58:06.561848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6188bdca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa617d617f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa617d62060>]}


============================== 00:58:06.568089 | 2c0b7112-b73d-4970-b6a5-0ff619c539a3 ==============================
[0m00:58:06.568089 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:58:06.569380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:58:07.431651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c0b7112-b73d-4970-b6a5-0ff619c539a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e1e18d40>]}
[0m00:58:07.485364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c0b7112-b73d-4970-b6a5-0ff619c539a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61762bf80>]}
[0m00:58:07.487175 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:58:07.584172 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:58:07.587350 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:58:07.588673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c0b7112-b73d-4970-b6a5-0ff619c539a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e1ce9880>]}
[0m00:58:08.989540 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:58:08.991128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2c0b7112-b73d-4970-b6a5-0ff619c539a3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e1a74980>]}
[0m00:58:09.417451 [error] [MainThread]: The semantic model `monthly_sales_semantic` has an entity named `sku` with type primary but it also has the `primary_entity` field set to `sku`. Both should not be present in the model.
[0m00:58:09.418907 [error] [MainThread]: Encountered an error:
Parsing Error
  Semantic Manifest validation failed.
[0m00:58:09.420532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9584105, "process_user_time": 4.634465, "process_kernel_time": 1.181602, "process_mem_max_rss": "241180", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:58:09.421732 [debug] [MainThread]: Command `dbt run` failed at 00:58:09.421603 after 2.96 seconds
[0m00:58:09.422592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6188bdca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e185d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5bb6f5e50>]}
[0m00:58:09.423391 [debug] [MainThread]: Flushing usage events
[0m00:58:41.977149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e149a840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e1674740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e14993d0>]}


============================== 00:58:41.983277 | 7b115bea-b1bc-4a81-9ca5-eab2137079cb ==============================
[0m00:58:41.983277 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:58:41.984521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:58:42.827986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ab32baa0>]}
[0m00:58:42.883880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e0bab500>]}
[0m00:58:42.885653 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:58:42.981955 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:58:42.985584 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:58:42.986834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4b70647d0>]}
[0m00:58:44.761329 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:58:44.763660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ab208050>]}
[0m00:58:45.421177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ab0acef0>]}
[0m00:58:45.612375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ab362930>]}
[0m00:58:45.613338 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 4 sources, 8 metrics, 459 macros, 1 semantic model
[0m00:58:45.614332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ab1aa960>]}
[0m00:58:45.617523 [info ] [MainThread]: 
[0m00:58:45.618925 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:58:45.624809 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_PRICE_DB'
[0m00:58:45.641271 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB"
[0m00:58:45.642853 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB"} */
show terse schemas in database STOCK_PRICE_DB
    limit 10000
[0m00:58:45.643972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:46.338389 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.694 seconds
[0m00:58:46.340973 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: Close
[0m00:58:46.550771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB, now list_DEV_SNAPSHOTS)
[0m00:58:46.561925 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOTS"
[0m00:58:46.563183 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOTS"} */
show objects in DEV.SNAPSHOTS limit 10000
[0m00:58:46.564124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:47.530684 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8c5ba-0003-6cdc-0003-431a000e1022
[0m00:58:47.531904 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m00:58:47.532970 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m00:58:47.533759 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:58:47.534619 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: Close
[0m00:58:47.747024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOTS, now list_STOCK_PRICE_DB_RAW_DATA_analytics)
[0m00:58:47.750899 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB_RAW_DATA_analytics"
[0m00:58:47.752006 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB_RAW_DATA_analytics"} */
show objects in STOCK_PRICE_DB.RAW_DATA_analytics limit 10000
[0m00:58:47.753075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:58:48.403540 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.650 seconds
[0m00:58:48.407063 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_analytics: Close
[0m00:58:48.686379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ab363bc0>]}
[0m00:58:48.688020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:58:48.688980 [info ] [MainThread]: 
[0m00:58:48.697274 [debug] [Thread-1 (]: Began running node model.supply_chain_project.metricflow_time_spine
[0m00:58:48.698627 [info ] [Thread-1 (]: 1 of 10 START sql table model RAW_DATA_analytics.metricflow_time_spine ......... [RUN]
[0m00:58:48.699776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB_RAW_DATA_analytics, now model.supply_chain_project.metricflow_time_spine)
[0m00:58:48.700720 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.metricflow_time_spine
[0m00:58:48.709193 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.metricflow_time_spine"
[0m00:58:48.720140 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.metricflow_time_spine
[0m00:58:48.750551 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.metricflow_time_spine"
[0m00:58:48.761880 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.metricflow_time_spine"
[0m00:58:48.762794 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.metricflow_time_spine"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.metricflow_time_spine
         as
        (

WITH recursive_date_spine AS (
    -- Start date and end date for the time spine
    SELECT
        CAST('2023-01-01' AS DATE) AS date_spine -- Update start date as needed
    UNION ALL
    SELECT
        date_spine + 1
    FROM
        recursive_date_spine
    WHERE
        date_spine + 1 <= CAST('2030-12-31' AS DATE) -- Update end date as needed
)

SELECT
    date_spine AS time_spine_date,
    DATE_TRUNC('month', date_spine) AS time_spine_month,
    DATE_TRUNC('quarter', date_spine) AS time_spine_quarter,
    DATE_TRUNC('year', date_spine) AS time_spine_year
FROM
    recursive_date_spine
        );
[0m00:58:48.763687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:51.186831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.423 seconds
[0m00:58:51.209987 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: Close
[0m00:58:51.364464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4ab4c7230>]}
[0m00:58:51.365906 [info ] [Thread-1 (]: 1 of 10 OK created sql table model RAW_DATA_analytics.metricflow_time_spine .... [[32mSUCCESS 1[0m in 2.66s]
[0m00:58:51.367243 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.metricflow_time_spine
[0m00:58:51.368225 [debug] [Thread-1 (]: Began running node model.supply_chain_project.predictions
[0m00:58:51.369273 [info ] [Thread-1 (]: 2 of 10 START sql view model RAW_DATA_analytics.predictions .................... [RUN]
[0m00:58:51.370277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.metricflow_time_spine, now model.supply_chain_project.predictions)
[0m00:58:51.371181 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.predictions
[0m00:58:51.374788 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.predictions"
[0m00:58:51.384322 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.predictions
[0m00:58:51.409028 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.predictions"
[0m00:58:51.420219 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.predictions"
[0m00:58:51.421231 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.predictions"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.predictions
  
   as (
    

SELECT 
    *,
    -- Example: Calculate average revenue per product
    CASE 
        WHEN "Number_of_products_sold" > 0 THEN "Revenue_Generated" / "Number_of_products_sold"
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Example: Restock flag based on stock levels
    CASE
        WHEN "Stock_levels" < ("Demand_Factor" * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM STOCK_PRICE_DB.raw.supply_chain_data;
[0m00:58:51.422105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:51.965295 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8c5bb-0003-6b7a-0003-431a000dd162
[0m00:58:51.966445 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 41 unexpected ';'.
[0m00:58:51.967577 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: Close
[0m00:58:52.113496 [debug] [Thread-1 (]: Database Error in model predictions (models/warehouse/predictions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 41 unexpected ';'.
  compiled code at target/run/supply_chain_project/models/warehouse/predictions.sql
[0m00:58:52.114776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a80f9850>]}
[0m00:58:52.115997 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model RAW_DATA_analytics.predictions ........... [[31mERROR[0m in 0.74s]
[0m00:58:52.117267 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.predictions
[0m00:58:52.118570 [debug] [Thread-1 (]: Began running node model.supply_chain_project.raw_data
[0m00:58:52.120123 [info ] [Thread-1 (]: 3 of 10 START sql view model RAW_DATA_analytics.raw_data ....................... [RUN]
[0m00:58:52.121258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.predictions, now model.supply_chain_project.raw_data)
[0m00:58:52.122158 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.raw_data
[0m00:58:52.126065 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.raw_data"
[0m00:58:52.137952 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.raw_data
[0m00:58:52.143529 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.raw_data"
[0m00:58:52.154121 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.raw_data"
[0m00:58:52.155283 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.raw_data"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.raw_data
  
   as (
    

SELECT 
    *,
    -- Example: Calculate average revenue per product
    CASE 
        WHEN "Number_of_products_sold" > 0 THEN "Revenue_Generated" / "Number_of_products_sold"
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Example: Restock flag based on stock levels
    CASE
        WHEN "Stock_levels" < ("Demand_Factor" * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM STOCK_PRICE_DB.raw.supply_chain_data;
[0m00:58:52.156294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:52.774563 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8c5bb-0003-6cdc-0003-431a000e102a
[0m00:58:52.776074 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 41 unexpected ';'.
[0m00:58:52.777357 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: Close
[0m00:58:52.948125 [debug] [Thread-1 (]: Database Error in model raw_data (models/staging/raw_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 41 unexpected ';'.
  compiled code at target/run/supply_chain_project/models/staging/raw_data.sql
[0m00:58:52.949450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a818c320>]}
[0m00:58:52.950908 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model RAW_DATA_analytics.raw_data .............. [[31mERROR[0m in 0.83s]
[0m00:58:52.952351 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.raw_data
[0m00:58:52.953516 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sales_data
[0m00:58:52.954670 [info ] [Thread-1 (]: 4 of 10 START sql view model RAW_DATA_analytics.sales_data ..................... [RUN]
[0m00:58:52.955919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.raw_data, now model.supply_chain_project.sales_data)
[0m00:58:52.956983 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sales_data
[0m00:58:52.961971 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sales_data"
[0m00:58:52.971585 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sales_data
[0m00:58:52.976360 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sales_data"
[0m00:58:52.984355 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sales_data"
[0m00:58:52.985678 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sales_data"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
  
   as (
    

SELECT
    ld.DATE_INSERT,
    ld.SKU,
    ld.PRODUCT_TYPE,
    ld.PRICE,
    ld.NUMBER_OF_PRODUCTS_SOLD,
    ld.STOCK_LEVELS,
    ld.COSTS
FROM DEV.LIVE.live_data ld

UNION ALL

SELECT
    wp.DATE_INSERT,
    wp.SKU,
    NULL AS PRODUCT_TYPE,
    NULL AS PRICE,
    wp.NUMBER_OF_PRODUCTS_SOLD,
    wp.STOCK_LEVELS,
    wp.COSTS
FROM DEV.LIVE.weekly_predictions wp
  );
[0m00:58:52.986677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:53.437019 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8c5bb-0003-6c40-0003-431a000df0b2
[0m00:58:53.438231 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001790 (42601): SQL compilation error:
inconsistent data type for result columns for set operator input branches, expected DATE, got NUMBER(38,0)
[0m00:58:53.439468 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: Close
[0m00:58:53.672732 [debug] [Thread-1 (]: Database Error in model sales_data (models/sales_data.sql)
  001790 (42601): SQL compilation error:
  inconsistent data type for result columns for set operator input branches, expected DATE, got NUMBER(38,0)
  compiled code at target/run/supply_chain_project/models/sales_data.sql
[0m00:58:53.674121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b115bea-b1bc-4a81-9ca5-eab2137079cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a8145e80>]}
[0m00:58:53.675409 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model RAW_DATA_analytics.sales_data ............ [[31mERROR[0m in 0.72s]
[0m00:58:53.676936 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sales_data
[0m00:58:53.678691 [debug] [Thread-1 (]: Began running node model.supply_chain_project.demand_forecast
[0m00:58:53.679634 [info ] [Thread-1 (]: 5 of 10 SKIP relation RAW_DATA_analytics.demand_forecast ....................... [[33mSKIP[0m]
[0m00:58:53.680651 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.demand_forecast
[0m00:58:53.681584 [debug] [Thread-1 (]: Began running node model.supply_chain_project.inventory_efficiency
[0m00:58:53.682497 [info ] [Thread-1 (]: 6 of 10 SKIP relation RAW_DATA_analytics.inventory_efficiency .................. [[33mSKIP[0m]
[0m00:58:53.683417 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.inventory_efficiency
[0m00:58:53.684342 [debug] [Thread-1 (]: Began running node model.supply_chain_project.monthly_sales
[0m00:58:53.685158 [info ] [Thread-1 (]: 7 of 10 SKIP relation RAW_DATA_analytics.monthly_sales ......................... [[33mSKIP[0m]
[0m00:58:53.686158 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.monthly_sales
[0m00:58:53.687147 [debug] [Thread-1 (]: Began running node model.supply_chain_project.product_performance
[0m00:58:53.688175 [info ] [Thread-1 (]: 8 of 10 SKIP relation RAW_DATA_analytics.product_performance ................... [[33mSKIP[0m]
[0m00:58:53.689447 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.product_performance
[0m00:58:53.690447 [debug] [Thread-1 (]: Began running node model.supply_chain_project.safety_stock
[0m00:58:53.691341 [info ] [Thread-1 (]: 9 of 10 SKIP relation RAW_DATA_analytics.safety_stock .......................... [[33mSKIP[0m]
[0m00:58:53.692528 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.safety_stock
[0m00:58:53.693644 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sku_performance
[0m00:58:53.694669 [info ] [Thread-1 (]: 10 of 10 SKIP relation RAW_DATA_analytics.sku_performance ...................... [[33mSKIP[0m]
[0m00:58:53.695841 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sku_performance
[0m00:58:53.697856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:53.698607 [debug] [MainThread]: Connection 'model.supply_chain_project.sales_data' was properly closed.
[0m00:58:53.699484 [info ] [MainThread]: 
[0m00:58:53.700385 [info ] [MainThread]: Finished running 4 table models, 6 view models in 0 hours 0 minutes and 8.08 seconds (8.08s).
[0m00:58:53.702316 [debug] [MainThread]: Command end result
[0m00:58:53.752238 [info ] [MainThread]: 
[0m00:58:53.753369 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m00:58:53.754302 [info ] [MainThread]: 
[0m00:58:53.755239 [error] [MainThread]:   Database Error in model predictions (models/warehouse/predictions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 41 unexpected ';'.
  compiled code at target/run/supply_chain_project/models/warehouse/predictions.sql
[0m00:58:53.756058 [info ] [MainThread]: 
[0m00:58:53.756920 [error] [MainThread]:   Database Error in model raw_data (models/staging/raw_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 41 unexpected ';'.
  compiled code at target/run/supply_chain_project/models/staging/raw_data.sql
[0m00:58:53.757717 [info ] [MainThread]: 
[0m00:58:53.758603 [error] [MainThread]:   Database Error in model sales_data (models/sales_data.sql)
  001790 (42601): SQL compilation error:
  inconsistent data type for result columns for set operator input branches, expected DATE, got NUMBER(38,0)
  compiled code at target/run/supply_chain_project/models/sales_data.sql
[0m00:58:53.759372 [info ] [MainThread]: 
[0m00:58:53.760203 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=6 TOTAL=10
[0m00:58:53.761636 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.88263, "process_user_time": 5.698878, "process_kernel_time": 1.367331, "process_mem_max_rss": "249836", "process_in_blocks": "568", "process_out_blocks": "8", "command_success": false}
[0m00:58:53.762549 [debug] [MainThread]: Command `dbt run` failed at 00:58:53.762445 after 11.88 seconds
[0m00:58:53.763308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e1674740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e13ffef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4e0fd58e0>]}
[0m00:58:53.764027 [debug] [MainThread]: Flushing usage events
[0m01:04:27.692665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f88abc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f88ab29f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f88ab1820>]}


============================== 01:04:27.699070 | 6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4 ==============================
[0m01:04:27.699070 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:04:27.700191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:04:28.554929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f533c2450>]}
[0m01:04:28.607823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5393dc10>]}
[0m01:04:28.609667 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:04:28.705599 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:04:29.041626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:04:29.043714 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/sales_data.sql
[0m01:04:29.044784 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/warehouse/predictions.sql
[0m01:04:29.045795 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/staging/raw_data.sql
[0m01:04:29.284308 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:04:29.286068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f52d71ee0>]}
[0m01:04:29.535763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f50c97110>]}
[0m01:04:29.710005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f50cdcfe0>]}
[0m01:04:29.710981 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 4 sources, 8 metrics, 459 macros, 1 semantic model
[0m01:04:29.711850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f50b07b00>]}
[0m01:04:29.714930 [info ] [MainThread]: 
[0m01:04:29.716205 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:04:29.721963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_PRICE_DB'
[0m01:04:29.736384 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB"
[0m01:04:29.737583 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB"} */
show terse schemas in database STOCK_PRICE_DB
    limit 10000
[0m01:04:29.738516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:30.419025 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.680 seconds
[0m01:04:30.421597 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: Close
[0m01:04:30.583525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB, now list_DEV_SNAPSHOTS)
[0m01:04:30.593995 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOTS"
[0m01:04:30.595125 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOTS"} */
show objects in DEV.SNAPSHOTS limit 10000
[0m01:04:30.595873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:31.108990 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8c5c0-0003-6dca-0003-431a000d50c6
[0m01:04:31.110107 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:04:31.111137 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:04:31.111891 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:04:31.112672 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: Close
[0m01:04:31.270733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOTS, now list_STOCK_PRICE_DB_RAW_DATA_analytics)
[0m01:04:31.274351 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB_RAW_DATA_analytics"
[0m01:04:31.275660 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB_RAW_DATA_analytics"} */
show objects in STOCK_PRICE_DB.RAW_DATA_analytics limit 10000
[0m01:04:31.276684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:31.829586 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.553 seconds
[0m01:04:31.832281 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_analytics: Close
[0m01:04:31.988651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f88699130>]}
[0m01:04:31.990013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:04:31.990980 [info ] [MainThread]: 
[0m01:04:32.000581 [debug] [Thread-1 (]: Began running node model.supply_chain_project.metricflow_time_spine
[0m01:04:32.001916 [info ] [Thread-1 (]: 1 of 10 START sql table model RAW_DATA_analytics.metricflow_time_spine ......... [RUN]
[0m01:04:32.002989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB_RAW_DATA_analytics, now model.supply_chain_project.metricflow_time_spine)
[0m01:04:32.003902 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.metricflow_time_spine
[0m01:04:32.013174 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.metricflow_time_spine"
[0m01:04:32.020491 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.metricflow_time_spine
[0m01:04:32.052036 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.metricflow_time_spine"
[0m01:04:32.059322 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.metricflow_time_spine"
[0m01:04:32.060605 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.metricflow_time_spine"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.metricflow_time_spine
         as
        (

WITH recursive_date_spine AS (
    -- Start date and end date for the time spine
    SELECT
        CAST('2023-01-01' AS DATE) AS date_spine -- Update start date as needed
    UNION ALL
    SELECT
        date_spine + 1
    FROM
        recursive_date_spine
    WHERE
        date_spine + 1 <= CAST('2030-12-31' AS DATE) -- Update end date as needed
)

SELECT
    date_spine AS time_spine_date,
    DATE_TRUNC('month', date_spine) AS time_spine_month,
    DATE_TRUNC('quarter', date_spine) AS time_spine_quarter,
    DATE_TRUNC('year', date_spine) AS time_spine_year
FROM
    recursive_date_spine
        );
[0m01:04:32.061550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:33.738658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.677 seconds
[0m01:04:33.763823 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: Close
[0m01:04:33.943713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f533c3890>]}
[0m01:04:33.945248 [info ] [Thread-1 (]: 1 of 10 OK created sql table model RAW_DATA_analytics.metricflow_time_spine .... [[32mSUCCESS 1[0m in 1.94s]
[0m01:04:33.946671 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.metricflow_time_spine
[0m01:04:33.947727 [debug] [Thread-1 (]: Began running node model.supply_chain_project.predictions
[0m01:04:33.948746 [info ] [Thread-1 (]: 2 of 10 START sql view model RAW_DATA_analytics.predictions .................... [RUN]
[0m01:04:33.949810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.metricflow_time_spine, now model.supply_chain_project.predictions)
[0m01:04:33.951308 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.predictions
[0m01:04:33.955470 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.predictions"
[0m01:04:33.962202 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.predictions
[0m01:04:33.987883 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.predictions"
[0m01:04:33.995252 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.predictions"
[0m01:04:33.996417 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.predictions"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.predictions
  
   as (
    

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN "Number_of_products_sold" > 0 THEN "Revenue_Generated" / "Number_of_products_sold"
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN "Stock_levels" < ("Demand_Factor" * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM STOCK_PRICE_DB.raw.supply_chain_data
  );
[0m01:04:33.997672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:34.654087 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8c5c0-0003-6ea6-0003-431a000e600a
[0m01:04:34.655174 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 13
invalid identifier '"Number_of_products_sold"'
[0m01:04:34.656099 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: Close
[0m01:04:34.808119 [debug] [Thread-1 (]: Database Error in model predictions (models/warehouse/predictions.sql)
  000904 (42000): SQL compilation error: error line 10 at position 13
  invalid identifier '"Number_of_products_sold"'
  compiled code at target/run/supply_chain_project/models/warehouse/predictions.sql
[0m01:04:34.809357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0bf0f020>]}
[0m01:04:34.810459 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model RAW_DATA_analytics.predictions ........... [[31mERROR[0m in 0.86s]
[0m01:04:34.811922 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.predictions
[0m01:04:34.813068 [debug] [Thread-1 (]: Began running node model.supply_chain_project.raw_data
[0m01:04:34.814572 [info ] [Thread-1 (]: 3 of 10 START sql view model RAW_DATA_analytics.raw_data ....................... [RUN]
[0m01:04:34.815581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.predictions, now model.supply_chain_project.raw_data)
[0m01:04:34.816390 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.raw_data
[0m01:04:34.820056 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.raw_data"
[0m01:04:34.825890 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.raw_data
[0m01:04:34.829688 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.raw_data"
[0m01:04:34.836390 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.raw_data"
[0m01:04:34.837267 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.raw_data"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.raw_data
  
   as (
    

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN "Number_of_products_sold" > 0 THEN "Revenue_Generated" / "Number_of_products_sold"
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN "Stock_levels" < ("Demand_Factor" * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM STOCK_PRICE_DB.raw.supply_chain_data
  );
[0m01:04:34.838205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:35.474443 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8c5c0-0003-6cdc-0003-431a000e102e
[0m01:04:35.475778 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 13
invalid identifier '"Number_of_products_sold"'
[0m01:04:35.476899 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: Close
[0m01:04:35.661565 [debug] [Thread-1 (]: Database Error in model raw_data (models/staging/raw_data.sql)
  000904 (42000): SQL compilation error: error line 10 at position 13
  invalid identifier '"Number_of_products_sold"'
  compiled code at target/run/supply_chain_project/models/staging/raw_data.sql
[0m01:04:35.662932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f501d6450>]}
[0m01:04:35.664274 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model RAW_DATA_analytics.raw_data .............. [[31mERROR[0m in 0.85s]
[0m01:04:35.665589 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.raw_data
[0m01:04:35.666669 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sales_data
[0m01:04:35.667686 [info ] [Thread-1 (]: 4 of 10 START sql view model RAW_DATA_analytics.sales_data ..................... [RUN]
[0m01:04:35.668809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.raw_data, now model.supply_chain_project.sales_data)
[0m01:04:35.669721 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sales_data
[0m01:04:35.673896 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sales_data"
[0m01:04:35.680562 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sales_data
[0m01:04:35.685087 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sales_data"
[0m01:04:35.691975 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sales_data"
[0m01:04:35.693071 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sales_data"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
  
   as (
    

SELECT
    TO_TIMESTAMP_NTZ(ld.DATE_INSERT) AS DATE_INSERT,
    ld.SKU,
    ld.PRODUCT_TYPE,
    ld.PRICE,
    ld.NUMBER_OF_PRODUCTS_SOLD,
    ld.STOCK_LEVELS,
    ld.COSTS
FROM DEV.LIVE.live_data ld

UNION ALL

SELECT
    wp.DATE_INSERT,
    wp.SKU,
    NULL AS PRODUCT_TYPE,
    NULL AS PRICE,
    wp.NUMBER_OF_PRODUCTS_SOLD,
    wp.STOCK_LEVELS,
    wp.COSTS
FROM DEV.LIVE.weekly_predictions wp
  );
[0m01:04:35.693960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:36.530054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.836 seconds
[0m01:04:36.533158 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: Close
[0m01:04:36.695607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f501d4890>]}
[0m01:04:36.698229 [info ] [Thread-1 (]: 4 of 10 OK created sql view model RAW_DATA_analytics.sales_data ................ [[32mSUCCESS 1[0m in 1.03s]
[0m01:04:36.700357 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sales_data
[0m01:04:36.703581 [debug] [Thread-1 (]: Began running node model.supply_chain_project.demand_forecast
[0m01:04:36.705597 [info ] [Thread-1 (]: 5 of 10 START sql table model RAW_DATA_analytics.demand_forecast ............... [RUN]
[0m01:04:36.707303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.sales_data, now model.supply_chain_project.demand_forecast)
[0m01:04:36.708884 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.demand_forecast
[0m01:04:36.714893 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.demand_forecast"
[0m01:04:36.722759 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.demand_forecast
[0m01:04:36.727103 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.demand_forecast"
[0m01:04:36.733497 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.demand_forecast"
[0m01:04:36.734502 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.demand_forecast"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.demand_forecast
         as
        (

WITH historical_sales AS (
    SELECT
        DATE_TRUNC('week', DATE_INSERT) AS sales_week,
        SKU,
        SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold
    FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
    GROUP BY 1, 2
)

SELECT
    SKU,
    DATEADD('week', 1, MAX(sales_week)) AS forecast_week,
    AVG(total_units_sold) AS forecast_units_sold
FROM historical_sales
GROUP BY SKU
        );
[0m01:04:36.735634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:39.475796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.740 seconds
[0m01:04:39.478818 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: Close
[0m01:04:39.659725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0bfcbd40>]}
[0m01:04:39.661110 [info ] [Thread-1 (]: 5 of 10 OK created sql table model RAW_DATA_analytics.demand_forecast .......... [[32mSUCCESS 1[0m in 2.95s]
[0m01:04:39.662330 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.demand_forecast
[0m01:04:39.663359 [debug] [Thread-1 (]: Began running node model.supply_chain_project.inventory_efficiency
[0m01:04:39.664314 [info ] [Thread-1 (]: 6 of 10 START sql view model RAW_DATA_analytics.inventory_efficiency ........... [RUN]
[0m01:04:39.665226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.demand_forecast, now model.supply_chain_project.inventory_efficiency)
[0m01:04:39.666090 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.inventory_efficiency
[0m01:04:39.670119 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.inventory_efficiency"
[0m01:04:39.675347 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.inventory_efficiency
[0m01:04:39.679022 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.inventory_efficiency"
[0m01:04:39.685979 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.inventory_efficiency"
[0m01:04:39.687405 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.inventory_efficiency"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.inventory_efficiency
  
   as (
    

SELECT
    SKU,
    AVG(STOCK_LEVELS) AS average_stock,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    (SUM(NUMBER_OF_PRODUCTS_SOLD) / NULLIF(AVG(STOCK_LEVELS), 0)) AS inventory_turnover
FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
GROUP BY SKU
  );
[0m01:04:39.688468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:40.345452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m01:04:40.348474 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: Close
[0m01:04:40.571268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f0bfcf860>]}
[0m01:04:40.572854 [info ] [Thread-1 (]: 6 of 10 OK created sql view model RAW_DATA_analytics.inventory_efficiency ...... [[32mSUCCESS 1[0m in 0.91s]
[0m01:04:40.574023 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.inventory_efficiency
[0m01:04:40.574893 [debug] [Thread-1 (]: Began running node model.supply_chain_project.monthly_sales
[0m01:04:40.575802 [info ] [Thread-1 (]: 7 of 10 START sql table model RAW_DATA_analytics.monthly_sales ................. [RUN]
[0m01:04:40.576773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.inventory_efficiency, now model.supply_chain_project.monthly_sales)
[0m01:04:40.577549 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.monthly_sales
[0m01:04:40.582675 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.monthly_sales"
[0m01:04:40.587650 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.monthly_sales
[0m01:04:40.679846 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.monthly_sales"
[0m01:04:40.685982 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.monthly_sales"
[0m01:04:40.686932 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.monthly_sales"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.monthly_sales
         as
        (

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        SKU,
        NUMBER_OF_PRODUCTS_SOLD,
        STOCK_LEVELS,
        COSTS,
        PRICE
    FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
)

SELECT
    DATE_TRUNC('month', sales_date) AS sales_month,
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_products_sold,
    AVG(STOCK_LEVELS) AS average_stock_levels,
    SUM(COSTS) AS total_costs,
    AVG(PRICE) AS average_price,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue
FROM daily_sales
GROUP BY 1, 2
        );
[0m01:04:40.687810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:43.025789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.338 seconds
[0m01:04:43.029013 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: Close
[0m01:04:43.216342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f892ce600>]}
[0m01:04:43.218031 [info ] [Thread-1 (]: 7 of 10 OK created sql table model RAW_DATA_analytics.monthly_sales ............ [[32mSUCCESS 1[0m in 2.64s]
[0m01:04:43.219363 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.monthly_sales
[0m01:04:43.220377 [debug] [Thread-1 (]: Began running node model.supply_chain_project.product_performance
[0m01:04:43.221354 [info ] [Thread-1 (]: 8 of 10 START sql view model RAW_DATA_analytics.product_performance ............ [RUN]
[0m01:04:43.222550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.monthly_sales, now model.supply_chain_project.product_performance)
[0m01:04:43.223504 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.product_performance
[0m01:04:43.227559 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.product_performance"
[0m01:04:43.232924 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.product_performance
[0m01:04:43.236581 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.product_performance"
[0m01:04:43.243260 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.product_performance"
[0m01:04:43.244347 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.product_performance"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.product_performance
  
   as (
    

SELECT
    PRODUCT_TYPE,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
GROUP BY PRODUCT_TYPE
ORDER BY total_profit DESC
  );
[0m01:04:43.245274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:44.126586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.881 seconds
[0m01:04:44.129734 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: Close
[0m01:04:44.288526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f88449910>]}
[0m01:04:44.289888 [info ] [Thread-1 (]: 8 of 10 OK created sql view model RAW_DATA_analytics.product_performance ....... [[32mSUCCESS 1[0m in 1.07s]
[0m01:04:44.291286 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.product_performance
[0m01:04:44.292174 [debug] [Thread-1 (]: Began running node model.supply_chain_project.safety_stock
[0m01:04:44.293045 [info ] [Thread-1 (]: 9 of 10 START sql table model RAW_DATA_analytics.safety_stock .................. [RUN]
[0m01:04:44.293952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.product_performance, now model.supply_chain_project.safety_stock)
[0m01:04:44.294755 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.safety_stock
[0m01:04:44.298323 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.safety_stock"
[0m01:04:44.303217 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.safety_stock
[0m01:04:44.307180 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.safety_stock"
[0m01:04:44.313027 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.safety_stock"
[0m01:04:44.313921 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.safety_stock"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.safety_stock
         as
        (

WITH daily_variance AS (
    SELECT
        SKU,
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        NUMBER_OF_PRODUCTS_SOLD
    FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
)

SELECT
    SKU,
    ROUND(1.65 * STDDEV(NUMBER_OF_PRODUCTS_SOLD)) AS safety_stock_level  -- 95% service level
FROM daily_variance
GROUP BY SKU
        );
[0m01:04:44.314704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:46.638172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.323 seconds
[0m01:04:46.641052 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: Close
[0m01:04:46.913305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f53c09b20>]}
[0m01:04:46.915106 [info ] [Thread-1 (]: 9 of 10 OK created sql table model RAW_DATA_analytics.safety_stock ............. [[32mSUCCESS 1[0m in 2.62s]
[0m01:04:46.916384 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.safety_stock
[0m01:04:46.917345 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sku_performance
[0m01:04:46.918263 [info ] [Thread-1 (]: 10 of 10 START sql view model RAW_DATA_analytics.sku_performance ............... [RUN]
[0m01:04:46.919500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.safety_stock, now model.supply_chain_project.sku_performance)
[0m01:04:46.920429 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sku_performance
[0m01:04:46.924105 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sku_performance"
[0m01:04:46.930176 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sku_performance
[0m01:04:46.933945 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sku_performance"
[0m01:04:46.941386 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sku_performance"
[0m01:04:46.942549 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sku_performance"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.sku_performance
  
   as (
    

SELECT
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
GROUP BY SKU
ORDER BY total_profit DESC
  );
[0m01:04:46.943404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:47.733228 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.790 seconds
[0m01:04:47.736098 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: Close
[0m01:04:47.899345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6130c4b4-3a79-489e-b1f3-ee6da7a0f8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8834f3e0>]}
[0m01:04:47.900711 [info ] [Thread-1 (]: 10 of 10 OK created sql view model RAW_DATA_analytics.sku_performance .......... [[32mSUCCESS 1[0m in 0.98s]
[0m01:04:47.901965 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sku_performance
[0m01:04:47.903991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:47.904814 [debug] [MainThread]: Connection 'model.supply_chain_project.sku_performance' was properly closed.
[0m01:04:47.905796 [info ] [MainThread]: 
[0m01:04:47.906742 [info ] [MainThread]: Finished running 4 table models, 6 view models in 0 hours 0 minutes and 18.19 seconds (18.19s).
[0m01:04:47.909313 [debug] [MainThread]: Command end result
[0m01:04:47.963577 [info ] [MainThread]: 
[0m01:04:47.964553 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:04:47.965395 [info ] [MainThread]: 
[0m01:04:47.966277 [error] [MainThread]:   Database Error in model predictions (models/warehouse/predictions.sql)
  000904 (42000): SQL compilation error: error line 10 at position 13
  invalid identifier '"Number_of_products_sold"'
  compiled code at target/run/supply_chain_project/models/warehouse/predictions.sql
[0m01:04:47.967078 [info ] [MainThread]: 
[0m01:04:47.967956 [error] [MainThread]:   Database Error in model raw_data (models/staging/raw_data.sql)
  000904 (42000): SQL compilation error: error line 10 at position 13
  invalid identifier '"Number_of_products_sold"'
  compiled code at target/run/supply_chain_project/models/staging/raw_data.sql
[0m01:04:47.968934 [info ] [MainThread]: 
[0m01:04:47.969929 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m01:04:47.971337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 20.38269, "process_user_time": 4.57026, "process_kernel_time": 1.31006, "process_mem_max_rss": "243748", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m01:04:47.972280 [debug] [MainThread]: Command `dbt run` failed at 01:04:47.972171 after 20.38 seconds
[0m01:04:47.973038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f89f31eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f52e37bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f52e37890>]}
[0m01:04:47.973750 [debug] [MainThread]: Flushing usage events
[0m01:08:29.396679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f25cf740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f256ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f3e36720>]}


============================== 01:08:29.403692 | a7190c14-ae74-4123-ad8c-61d7e7256991 ==============================
[0m01:08:29.403692 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:08:29.404895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:08:30.242261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c25028d0>]}
[0m01:08:30.295537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c0ee1220>]}
[0m01:08:30.298003 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:08:30.387721 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:08:30.679938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:08:30.681416 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/staging/raw_data.sql
[0m01:08:30.682309 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/warehouse/predictions.sql
[0m01:08:30.980530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c09b4f50>]}
[0m01:08:31.146952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c07d92e0>]}
[0m01:08:31.147959 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 4 sources, 8 metrics, 459 macros, 1 semantic model
[0m01:08:31.148976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f328fd10>]}
[0m01:08:31.152065 [info ] [MainThread]: 
[0m01:08:31.153253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:08:31.159104 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_PRICE_DB'
[0m01:08:31.174412 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB"
[0m01:08:31.175719 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB"} */
show terse schemas in database STOCK_PRICE_DB
    limit 10000
[0m01:08:31.176675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:31.921949 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.745 seconds
[0m01:08:31.924576 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: Close
[0m01:08:32.082227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB, now list_DEV_SNAPSHOTS)
[0m01:08:32.092435 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOTS"
[0m01:08:32.093521 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOTS"} */
show objects in DEV.SNAPSHOTS limit 10000
[0m01:08:32.094391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:32.600693 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8c5c4-0003-69f7-0003-431a000d7182
[0m01:08:32.602054 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:08:32.603084 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:08:32.603908 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:08:32.604712 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: Close
[0m01:08:32.767977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOTS, now list_STOCK_PRICE_DB_RAW_DATA_analytics)
[0m01:08:32.772484 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB_RAW_DATA_analytics"
[0m01:08:32.773503 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB_RAW_DATA_analytics"} */
show objects in STOCK_PRICE_DB.RAW_DATA_analytics limit 10000
[0m01:08:32.774346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:33.303340 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.529 seconds
[0m01:08:33.306984 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_analytics: Close
[0m01:08:33.483652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ba6f8b30>]}
[0m01:08:33.485355 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:08:33.486447 [info ] [MainThread]: 
[0m01:08:33.497625 [debug] [Thread-1 (]: Began running node model.supply_chain_project.metricflow_time_spine
[0m01:08:33.499107 [info ] [Thread-1 (]: 1 of 10 START sql table model RAW_DATA_analytics.metricflow_time_spine ......... [RUN]
[0m01:08:33.500777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB_RAW_DATA_analytics, now model.supply_chain_project.metricflow_time_spine)
[0m01:08:33.501774 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.metricflow_time_spine
[0m01:08:33.512318 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.metricflow_time_spine"
[0m01:08:33.519489 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.metricflow_time_spine
[0m01:08:33.552388 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.metricflow_time_spine"
[0m01:08:33.559944 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.metricflow_time_spine"
[0m01:08:33.560991 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.metricflow_time_spine"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.metricflow_time_spine
         as
        (

WITH recursive_date_spine AS (
    -- Start date and end date for the time spine
    SELECT
        CAST('2023-01-01' AS DATE) AS date_spine -- Update start date as needed
    UNION ALL
    SELECT
        date_spine + 1
    FROM
        recursive_date_spine
    WHERE
        date_spine + 1 <= CAST('2030-12-31' AS DATE) -- Update end date as needed
)

SELECT
    date_spine AS time_spine_date,
    DATE_TRUNC('month', date_spine) AS time_spine_month,
    DATE_TRUNC('quarter', date_spine) AS time_spine_quarter,
    DATE_TRUNC('year', date_spine) AS time_spine_year
FROM
    recursive_date_spine
        );
[0m01:08:33.561917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:35.313232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.751 seconds
[0m01:08:35.339378 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: Close
[0m01:08:35.506719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c0c7f530>]}
[0m01:08:35.508377 [info ] [Thread-1 (]: 1 of 10 OK created sql table model RAW_DATA_analytics.metricflow_time_spine .... [[32mSUCCESS 1[0m in 2.01s]
[0m01:08:35.509609 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.metricflow_time_spine
[0m01:08:35.510628 [debug] [Thread-1 (]: Began running node model.supply_chain_project.predictions
[0m01:08:35.511635 [info ] [Thread-1 (]: 2 of 10 START sql view model RAW_DATA_analytics.predictions .................... [RUN]
[0m01:08:35.512610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.metricflow_time_spine, now model.supply_chain_project.predictions)
[0m01:08:35.513420 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.predictions
[0m01:08:35.517215 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.predictions"
[0m01:08:35.523943 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.predictions
[0m01:08:35.546020 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.predictions"
[0m01:08:35.553705 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.predictions"
[0m01:08:35.554745 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.predictions"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.predictions
  
   as (
    

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN Number_of_products_sold > 0 THEN Revenue_Generated/ Number_of_products_sold
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN Stock_levels < (Demand_Factor * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM STOCK_PRICE_DB.raw.supply_chain_data
  );
[0m01:08:35.555636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:36.652508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.097 seconds
[0m01:08:36.655418 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: Close
[0m01:08:36.814221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b9d0fec0>]}
[0m01:08:36.816087 [info ] [Thread-1 (]: 2 of 10 OK created sql view model RAW_DATA_analytics.predictions ............... [[32mSUCCESS 1[0m in 1.30s]
[0m01:08:36.817431 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.predictions
[0m01:08:36.818469 [debug] [Thread-1 (]: Began running node model.supply_chain_project.raw_data
[0m01:08:36.819579 [info ] [Thread-1 (]: 3 of 10 START sql view model RAW_DATA_analytics.raw_data ....................... [RUN]
[0m01:08:36.820697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.predictions, now model.supply_chain_project.raw_data)
[0m01:08:36.821556 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.raw_data
[0m01:08:36.825512 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.raw_data"
[0m01:08:36.832338 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.raw_data
[0m01:08:36.836382 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.raw_data"
[0m01:08:36.843459 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.raw_data"
[0m01:08:36.844505 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.raw_data"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.raw_data
  
   as (
    

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN Number_of_products_sold > 0 THEN Revenue_Generated / Number_of_products_sold
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN Stock_levels < (Demand_Factor * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM STOCK_PRICE_DB.raw.supply_chain_data
  );
[0m01:08:36.845306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:37.789409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.944 seconds
[0m01:08:37.792842 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: Close
[0m01:08:37.947671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b9d0a0f0>]}
[0m01:08:37.949134 [info ] [Thread-1 (]: 3 of 10 OK created sql view model RAW_DATA_analytics.raw_data .................. [[32mSUCCESS 1[0m in 1.13s]
[0m01:08:37.950425 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.raw_data
[0m01:08:37.951320 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sales_data
[0m01:08:37.952209 [info ] [Thread-1 (]: 4 of 10 START sql view model RAW_DATA_analytics.sales_data ..................... [RUN]
[0m01:08:37.953208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.raw_data, now model.supply_chain_project.sales_data)
[0m01:08:37.954276 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sales_data
[0m01:08:37.960594 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sales_data"
[0m01:08:37.966974 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sales_data
[0m01:08:37.971095 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sales_data"
[0m01:08:37.978011 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sales_data"
[0m01:08:37.978994 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sales_data"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
  
   as (
    

SELECT
    TO_TIMESTAMP_NTZ(ld.DATE_INSERT) AS DATE_INSERT,
    ld.SKU,
    ld.PRODUCT_TYPE,
    ld.PRICE,
    ld.NUMBER_OF_PRODUCTS_SOLD,
    ld.STOCK_LEVELS,
    ld.COSTS
FROM DEV.LIVE.live_data ld

UNION ALL

SELECT
    wp.DATE_INSERT,
    wp.SKU,
    NULL AS PRODUCT_TYPE,
    NULL AS PRICE,
    wp.NUMBER_OF_PRODUCTS_SOLD,
    wp.STOCK_LEVELS,
    wp.COSTS
FROM DEV.LIVE.weekly_predictions wp
  );
[0m01:08:37.979939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:39.082245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.102 seconds
[0m01:08:39.085767 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: Close
[0m01:08:39.244020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b9eb9850>]}
[0m01:08:39.245500 [info ] [Thread-1 (]: 4 of 10 OK created sql view model RAW_DATA_analytics.sales_data ................ [[32mSUCCESS 1[0m in 1.29s]
[0m01:08:39.247030 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sales_data
[0m01:08:39.248758 [debug] [Thread-1 (]: Began running node model.supply_chain_project.demand_forecast
[0m01:08:39.249771 [info ] [Thread-1 (]: 5 of 10 START sql table model RAW_DATA_analytics.demand_forecast ............... [RUN]
[0m01:08:39.250924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.sales_data, now model.supply_chain_project.demand_forecast)
[0m01:08:39.251760 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.demand_forecast
[0m01:08:39.255396 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.demand_forecast"
[0m01:08:39.260283 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.demand_forecast
[0m01:08:39.263938 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.demand_forecast"
[0m01:08:39.269833 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.demand_forecast"
[0m01:08:39.270722 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.demand_forecast"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.demand_forecast
         as
        (

WITH historical_sales AS (
    SELECT
        DATE_TRUNC('week', DATE_INSERT) AS sales_week,
        SKU,
        SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold
    FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
    GROUP BY 1, 2
)

SELECT
    SKU,
    DATEADD('week', 1, MAX(sales_week)) AS forecast_week,
    AVG(total_units_sold) AS forecast_units_sold
FROM historical_sales
GROUP BY SKU
        );
[0m01:08:39.271462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:41.731993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.460 seconds
[0m01:08:41.734892 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: Close
[0m01:08:41.896173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b9d8be60>]}
[0m01:08:41.897481 [info ] [Thread-1 (]: 5 of 10 OK created sql table model RAW_DATA_analytics.demand_forecast .......... [[32mSUCCESS 1[0m in 2.65s]
[0m01:08:41.898686 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.demand_forecast
[0m01:08:41.899621 [debug] [Thread-1 (]: Began running node model.supply_chain_project.inventory_efficiency
[0m01:08:41.900510 [info ] [Thread-1 (]: 6 of 10 START sql view model RAW_DATA_analytics.inventory_efficiency ........... [RUN]
[0m01:08:41.901511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.demand_forecast, now model.supply_chain_project.inventory_efficiency)
[0m01:08:41.902466 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.inventory_efficiency
[0m01:08:41.906124 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.inventory_efficiency"
[0m01:08:41.911361 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.inventory_efficiency
[0m01:08:41.914912 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.inventory_efficiency"
[0m01:08:41.921387 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.inventory_efficiency"
[0m01:08:41.922364 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.inventory_efficiency"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.inventory_efficiency
  
   as (
    

SELECT
    SKU,
    AVG(STOCK_LEVELS) AS average_stock,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    (SUM(NUMBER_OF_PRODUCTS_SOLD) / NULLIF(AVG(STOCK_LEVELS), 0)) AS inventory_turnover
FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
GROUP BY SKU
  );
[0m01:08:41.923312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:42.844984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.922 seconds
[0m01:08:42.848463 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: Close
[0m01:08:43.014765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b9d8b650>]}
[0m01:08:43.016239 [info ] [Thread-1 (]: 6 of 10 OK created sql view model RAW_DATA_analytics.inventory_efficiency ...... [[32mSUCCESS 1[0m in 1.11s]
[0m01:08:43.017505 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.inventory_efficiency
[0m01:08:43.018430 [debug] [Thread-1 (]: Began running node model.supply_chain_project.monthly_sales
[0m01:08:43.019337 [info ] [Thread-1 (]: 7 of 10 START sql table model RAW_DATA_analytics.monthly_sales ................. [RUN]
[0m01:08:43.020339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.inventory_efficiency, now model.supply_chain_project.monthly_sales)
[0m01:08:43.021157 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.monthly_sales
[0m01:08:43.024884 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.monthly_sales"
[0m01:08:43.030906 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.monthly_sales
[0m01:08:43.034615 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.monthly_sales"
[0m01:08:43.040354 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.monthly_sales"
[0m01:08:43.041314 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.monthly_sales"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.monthly_sales
         as
        (

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        SKU,
        NUMBER_OF_PRODUCTS_SOLD,
        STOCK_LEVELS,
        COSTS,
        PRICE
    FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
)

SELECT
    DATE_TRUNC('month', sales_date) AS sales_month,
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_products_sold,
    AVG(STOCK_LEVELS) AS average_stock_levels,
    SUM(COSTS) AS total_costs,
    AVG(PRICE) AS average_price,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue
FROM daily_sales
GROUP BY 1, 2
        );
[0m01:08:43.042082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:45.458181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.416 seconds
[0m01:08:45.461180 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: Close
[0m01:08:45.637019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f591fbf0>]}
[0m01:08:45.639106 [info ] [Thread-1 (]: 7 of 10 OK created sql table model RAW_DATA_analytics.monthly_sales ............ [[32mSUCCESS 1[0m in 2.62s]
[0m01:08:45.640852 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.monthly_sales
[0m01:08:45.642237 [debug] [Thread-1 (]: Began running node model.supply_chain_project.product_performance
[0m01:08:45.643690 [info ] [Thread-1 (]: 8 of 10 START sql view model RAW_DATA_analytics.product_performance ............ [RUN]
[0m01:08:45.645351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.monthly_sales, now model.supply_chain_project.product_performance)
[0m01:08:45.646584 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.product_performance
[0m01:08:45.651796 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.product_performance"
[0m01:08:45.659513 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.product_performance
[0m01:08:45.665325 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.product_performance"
[0m01:08:45.672755 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.product_performance"
[0m01:08:45.673790 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.product_performance"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.product_performance
  
   as (
    

SELECT
    PRODUCT_TYPE,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
GROUP BY PRODUCT_TYPE
ORDER BY total_profit DESC
  );
[0m01:08:45.674640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:46.569517 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.895 seconds
[0m01:08:46.573178 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: Close
[0m01:08:46.748608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b9da7e60>]}
[0m01:08:46.750178 [info ] [Thread-1 (]: 8 of 10 OK created sql view model RAW_DATA_analytics.product_performance ....... [[32mSUCCESS 1[0m in 1.10s]
[0m01:08:46.751604 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.product_performance
[0m01:08:46.752742 [debug] [Thread-1 (]: Began running node model.supply_chain_project.safety_stock
[0m01:08:46.753858 [info ] [Thread-1 (]: 9 of 10 START sql table model RAW_DATA_analytics.safety_stock .................. [RUN]
[0m01:08:46.754973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.product_performance, now model.supply_chain_project.safety_stock)
[0m01:08:46.755917 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.safety_stock
[0m01:08:46.759670 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.safety_stock"
[0m01:08:46.766312 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.safety_stock
[0m01:08:46.770274 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.safety_stock"
[0m01:08:46.778120 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.safety_stock"
[0m01:08:46.779290 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.safety_stock"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.safety_stock
         as
        (

WITH daily_variance AS (
    SELECT
        SKU,
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        NUMBER_OF_PRODUCTS_SOLD
    FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
)

SELECT
    SKU,
    ROUND(1.65 * STDDEV(NUMBER_OF_PRODUCTS_SOLD)) AS safety_stock_level  -- 95% service level
FROM daily_variance
GROUP BY SKU
        );
[0m01:08:46.780297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:48.952975 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.173 seconds
[0m01:08:48.956246 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: Close
[0m01:08:49.123033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30c00e1fd0>]}
[0m01:08:49.124594 [info ] [Thread-1 (]: 9 of 10 OK created sql table model RAW_DATA_analytics.safety_stock ............. [[32mSUCCESS 1[0m in 2.37s]
[0m01:08:49.125872 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.safety_stock
[0m01:08:49.126832 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sku_performance
[0m01:08:49.127783 [info ] [Thread-1 (]: 10 of 10 START sql view model RAW_DATA_analytics.sku_performance ............... [RUN]
[0m01:08:49.128775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.safety_stock, now model.supply_chain_project.sku_performance)
[0m01:08:49.129832 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sku_performance
[0m01:08:49.134062 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sku_performance"
[0m01:08:49.140233 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sku_performance
[0m01:08:49.143823 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sku_performance"
[0m01:08:49.150407 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sku_performance"
[0m01:08:49.151469 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sku_performance"} */
create or replace   view STOCK_PRICE_DB.RAW_DATA_analytics.sku_performance
  
   as (
    

SELECT
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
GROUP BY SKU
ORDER BY total_profit DESC
  );
[0m01:08:49.152224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:50.063274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.911 seconds
[0m01:08:50.066678 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: Close
[0m01:08:50.223700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7190c14-ae74-4123-ad8c-61d7e7256991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b9dae330>]}
[0m01:08:50.225268 [info ] [Thread-1 (]: 10 of 10 OK created sql view model RAW_DATA_analytics.sku_performance .......... [[32mSUCCESS 1[0m in 1.09s]
[0m01:08:50.226820 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sku_performance
[0m01:08:50.229258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:50.230356 [debug] [MainThread]: Connection 'model.supply_chain_project.sku_performance' was properly closed.
[0m01:08:50.231818 [info ] [MainThread]: 
[0m01:08:50.233573 [info ] [MainThread]: Finished running 4 table models, 6 view models in 0 hours 0 minutes and 19.08 seconds (19.08s).
[0m01:08:50.236483 [debug] [MainThread]: Command end result
[0m01:08:50.383510 [info ] [MainThread]: 
[0m01:08:50.384623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:08:50.385469 [info ] [MainThread]: 
[0m01:08:50.386319 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:08:50.387665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.09913, "process_user_time": 4.170147, "process_kernel_time": 1.383268, "process_mem_max_rss": "252840", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m01:08:50.388556 [debug] [MainThread]: Command `dbt run` succeeded at 01:08:50.388452 after 21.10 seconds
[0m01:08:50.389304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f34b6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30f2a6e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30b9d0d3d0>]}
[0m01:08:50.390027 [debug] [MainThread]: Flushing usage events
[0m01:58:57.967987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8163cd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc816c86540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8163ce8a0>]}


============================== 01:58:57.975518 | 5163459b-35ef-4418-8155-e9779cc1a153 ==============================
[0m01:58:57.975518 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:58:57.977031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:58:59.011728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc817934920>]}
[0m01:58:59.069583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc81702a270>]}
[0m01:58:59.071501 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m01:58:59.174514 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:58:59.360799 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:58:59.362759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e48393a0>]}
[0m01:59:00.889416 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:59:00.891287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7de40cd10>]}
[0m01:59:01.318076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e4d53020>]}
[0m01:59:01.514092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7de44b740>]}
[0m01:59:01.515575 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 4 sources, 8 metrics, 459 macros, 1 semantic model
[0m01:59:01.516976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7de359d00>]}
[0m01:59:01.520377 [info ] [MainThread]: 
[0m01:59:01.522049 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:59:01.528629 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_STOCK_PRICE_DB'
[0m01:59:01.546290 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB"
[0m01:59:01.547886 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB"} */
show terse schemas in database STOCK_PRICE_DB
    limit 10000
[0m01:59:01.549041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:59:02.178279 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.629 seconds
[0m01:59:02.181228 [debug] [ThreadPool]: On list_STOCK_PRICE_DB: Close
[0m01:59:02.334127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB, now list_STOCK_PRICE_DB_RAW_DATA_analytics)
[0m01:59:02.345196 [debug] [ThreadPool]: Using snowflake connection "list_STOCK_PRICE_DB_RAW_DATA_analytics"
[0m01:59:02.346713 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_STOCK_PRICE_DB_RAW_DATA_analytics"} */
show objects in STOCK_PRICE_DB.RAW_DATA_analytics limit 10000
[0m01:59:02.347926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:59:02.925895 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.578 seconds
[0m01:59:02.930275 [debug] [ThreadPool]: On list_STOCK_PRICE_DB_RAW_DATA_analytics: Close
[0m01:59:03.113561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_STOCK_PRICE_DB_RAW_DATA_analytics, now list_DEV_SNAPSHOTS)
[0m01:59:03.120811 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOTS"
[0m01:59:03.122383 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOTS"} */
show objects in DEV.SNAPSHOTS limit 10000
[0m01:59:03.123851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:59:03.663892 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8c5f7-0003-6dcf-0003-431a000de13a
[0m01:59:03.665564 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m01:59:03.667150 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:59:03.668560 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:59:03.669931 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: Close
[0m01:59:03.863195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8179d9c10>]}
[0m01:59:03.865589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:59:03.867062 [info ] [MainThread]: 
[0m01:59:03.887408 [debug] [Thread-1 (]: Began running node model.supply_chain_project.metricflow_time_spine
[0m01:59:03.889905 [info ] [Thread-1 (]: 1 of 10 START sql table model RAW_DATA_analytics.metricflow_time_spine ......... [RUN]
[0m01:59:03.892273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOTS, now model.supply_chain_project.metricflow_time_spine)
[0m01:59:03.894240 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.metricflow_time_spine
[0m01:59:03.923717 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.metricflow_time_spine"
[0m01:59:03.939247 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.metricflow_time_spine
[0m01:59:04.018276 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.metricflow_time_spine"
[0m01:59:04.030494 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.metricflow_time_spine"
[0m01:59:04.032381 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.metricflow_time_spine"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.metricflow_time_spine
         as
        (

WITH recursive_date_spine AS (
    -- Start date and end date for the time spine
    SELECT
        CAST('2023-01-01' AS DATE) AS date_spine -- Update start date as needed
    UNION ALL
    SELECT
        date_spine + 1
    FROM
        recursive_date_spine
    WHERE
        date_spine + 1 <= CAST('2030-12-31' AS DATE) -- Update end date as needed
)

SELECT
    date_spine AS time_spine_date,
    DATE_TRUNC('month', date_spine) AS time_spine_month,
    DATE_TRUNC('quarter', date_spine) AS time_spine_quarter,
    DATE_TRUNC('year', date_spine) AS time_spine_year
FROM
    recursive_date_spine
        );
[0m01:59:04.034334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:59:05.911337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.877 seconds
[0m01:59:05.940300 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: Close
[0m01:59:06.098347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7e4cc3470>]}
[0m01:59:06.100163 [info ] [Thread-1 (]: 1 of 10 OK created sql table model RAW_DATA_analytics.metricflow_time_spine .... [[32mSUCCESS 1[0m in 2.21s]
[0m01:59:06.101828 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.metricflow_time_spine
[0m01:59:06.103431 [debug] [Thread-1 (]: Began running node model.supply_chain_project.predictions
[0m01:59:06.104795 [info ] [Thread-1 (]: 2 of 10 START sql table model RAW_DATA_analytics.predictions ................... [RUN]
[0m01:59:06.106000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.metricflow_time_spine, now model.supply_chain_project.predictions)
[0m01:59:06.107136 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.predictions
[0m01:59:06.111897 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.predictions"
[0m01:59:06.123289 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.predictions
[0m01:59:06.127627 [debug] [Thread-1 (]: Dropping relation "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."PREDICTIONS" because it is of type view
[0m01:59:06.138515 [debug] [Thread-1 (]: Applying DROP to: "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."PREDICTIONS"
[0m01:59:06.148337 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.predictions"
[0m01:59:06.149796 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.predictions"} */
drop view if exists "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."PREDICTIONS" cascade
[0m01:59:06.150942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:59:06.593483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m01:59:06.596455 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.predictions"
[0m01:59:06.607528 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.predictions"
[0m01:59:06.608954 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.predictions"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.predictions
         as
        (

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN Number_of_products_sold > 0 THEN Revenue_Generated/ Number_of_products_sold
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN Stock_levels < (Demand_Factor * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM STOCK_PRICE_DB.raw.supply_chain_data
        );
[0m01:59:07.642127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.032 seconds
[0m01:59:07.646705 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: Close
[0m01:59:07.909581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dd8d7530>]}
[0m01:59:07.912205 [info ] [Thread-1 (]: 2 of 10 OK created sql table model RAW_DATA_analytics.predictions .............. [[32mSUCCESS 1[0m in 1.80s]
[0m01:59:07.913939 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.predictions
[0m01:59:07.915541 [debug] [Thread-1 (]: Began running node model.supply_chain_project.raw_data
[0m01:59:07.917184 [info ] [Thread-1 (]: 3 of 10 START sql table model RAW_DATA_analytics.raw_data ...................... [RUN]
[0m01:59:07.918861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.predictions, now model.supply_chain_project.raw_data)
[0m01:59:07.920284 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.raw_data
[0m01:59:07.925505 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.raw_data"
[0m01:59:07.939413 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.raw_data
[0m01:59:07.943998 [debug] [Thread-1 (]: Dropping relation "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."RAW_DATA" because it is of type view
[0m01:59:07.950937 [debug] [Thread-1 (]: Applying DROP to: "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."RAW_DATA"
[0m01:59:07.953785 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.raw_data"
[0m01:59:07.955109 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.raw_data"} */
drop view if exists "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."RAW_DATA" cascade
[0m01:59:07.956349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:59:08.554261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m01:59:08.557287 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.raw_data"
[0m01:59:08.568341 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.raw_data"
[0m01:59:08.569782 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.raw_data"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.raw_data
         as
        (

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN Number_of_products_sold > 0 THEN Revenue_Generated / Number_of_products_sold
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN Stock_levels < (Demand_Factor * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM STOCK_PRICE_DB.raw.supply_chain_data
        );
[0m01:59:09.470734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.900 seconds
[0m01:59:09.474378 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: Close
[0m01:59:09.629865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dc6fc0e0>]}
[0m01:59:09.631590 [info ] [Thread-1 (]: 3 of 10 OK created sql table model RAW_DATA_analytics.raw_data ................. [[32mSUCCESS 1[0m in 1.71s]
[0m01:59:09.633026 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.raw_data
[0m01:59:09.634449 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sales_data
[0m01:59:09.635968 [info ] [Thread-1 (]: 4 of 10 START sql table model RAW_DATA_analytics.sales_data .................... [RUN]
[0m01:59:09.637803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.raw_data, now model.supply_chain_project.sales_data)
[0m01:59:09.639267 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sales_data
[0m01:59:09.644125 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sales_data"
[0m01:59:09.654322 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sales_data
[0m01:59:09.658318 [debug] [Thread-1 (]: Dropping relation "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."SALES_DATA" because it is of type view
[0m01:59:09.661935 [debug] [Thread-1 (]: Applying DROP to: "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."SALES_DATA"
[0m01:59:09.664064 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sales_data"
[0m01:59:09.665581 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sales_data"} */
drop view if exists "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."SALES_DATA" cascade
[0m01:59:09.666915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:59:10.191235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m01:59:10.194061 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sales_data"
[0m01:59:10.204273 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sales_data"
[0m01:59:10.205750 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sales_data"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
         as
        (

SELECT
    TO_TIMESTAMP_NTZ(ld.DATE_INSERT) AS DATE_INSERT,
    ld.SKU,
    ld.PRODUCT_TYPE,
    ld.PRICE,
    ld.NUMBER_OF_PRODUCTS_SOLD,
    ld.STOCK_LEVELS,
    ld.COSTS
FROM DEV.LIVE.live_data ld

UNION ALL

SELECT
    wp.DATE_INSERT,
    wp.SKU,
    NULL AS PRODUCT_TYPE,
    NULL AS PRICE,
    wp.NUMBER_OF_PRODUCTS_SOLD,
    wp.STOCK_LEVELS,
    wp.COSTS
FROM DEV.LIVE.weekly_predictions wp
        );
[0m01:59:11.581744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.375 seconds
[0m01:59:11.585361 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: Close
[0m01:59:11.750657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc81751bdd0>]}
[0m01:59:11.752657 [info ] [Thread-1 (]: 4 of 10 OK created sql table model RAW_DATA_analytics.sales_data ............... [[32mSUCCESS 1[0m in 2.11s]
[0m01:59:11.754442 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sales_data
[0m01:59:11.756990 [debug] [Thread-1 (]: Began running node model.supply_chain_project.demand_forecast
[0m01:59:11.758487 [info ] [Thread-1 (]: 5 of 10 START sql table model RAW_DATA_analytics.demand_forecast ............... [RUN]
[0m01:59:11.759937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.sales_data, now model.supply_chain_project.demand_forecast)
[0m01:59:11.761387 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.demand_forecast
[0m01:59:11.765930 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.demand_forecast"
[0m01:59:11.776928 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.demand_forecast
[0m01:59:11.781365 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.demand_forecast"
[0m01:59:11.792229 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.demand_forecast"
[0m01:59:11.793589 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.demand_forecast"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.demand_forecast
         as
        (

WITH historical_sales AS (
    SELECT
        DATE_TRUNC('week', DATE_INSERT) AS sales_week,
        SKU,
        SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold
    FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
    GROUP BY 1, 2
)

SELECT
    SKU,
    DATEADD('week', 1, MAX(sales_week)) AS forecast_week,
    AVG(total_units_sold) AS forecast_units_sold
FROM historical_sales
GROUP BY SKU
        );
[0m01:59:11.794776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:59:13.492992 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.698 seconds
[0m01:59:13.497175 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: Close
[0m01:59:13.644531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dd9a8560>]}
[0m01:59:13.646446 [info ] [Thread-1 (]: 5 of 10 OK created sql table model RAW_DATA_analytics.demand_forecast .......... [[32mSUCCESS 1[0m in 1.88s]
[0m01:59:13.648148 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.demand_forecast
[0m01:59:13.649602 [debug] [Thread-1 (]: Began running node model.supply_chain_project.inventory_efficiency
[0m01:59:13.651164 [info ] [Thread-1 (]: 6 of 10 START sql table model RAW_DATA_analytics.inventory_efficiency .......... [RUN]
[0m01:59:13.652641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.demand_forecast, now model.supply_chain_project.inventory_efficiency)
[0m01:59:13.653834 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.inventory_efficiency
[0m01:59:13.658381 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.inventory_efficiency"
[0m01:59:13.669272 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.inventory_efficiency
[0m01:59:13.672970 [debug] [Thread-1 (]: Dropping relation "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."INVENTORY_EFFICIENCY" because it is of type view
[0m01:59:13.677074 [debug] [Thread-1 (]: Applying DROP to: "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."INVENTORY_EFFICIENCY"
[0m01:59:13.679952 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.inventory_efficiency"
[0m01:59:13.681182 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.inventory_efficiency"} */
drop view if exists "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."INVENTORY_EFFICIENCY" cascade
[0m01:59:13.682329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:59:14.251677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m01:59:14.255266 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.inventory_efficiency"
[0m01:59:14.265844 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.inventory_efficiency"
[0m01:59:14.267355 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.inventory_efficiency"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.inventory_efficiency
         as
        (

SELECT
    SKU,
    AVG(STOCK_LEVELS) AS average_stock,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    (SUM(NUMBER_OF_PRODUCTS_SOLD) / NULLIF(AVG(STOCK_LEVELS), 0)) AS inventory_turnover
FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
GROUP BY SKU
        );
[0m01:59:15.721853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.453 seconds
[0m01:59:15.725672 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: Close
[0m01:59:15.885548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dd9b8da0>]}
[0m01:59:15.887806 [info ] [Thread-1 (]: 6 of 10 OK created sql table model RAW_DATA_analytics.inventory_efficiency ..... [[32mSUCCESS 1[0m in 2.23s]
[0m01:59:15.889403 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.inventory_efficiency
[0m01:59:15.891364 [debug] [Thread-1 (]: Began running node model.supply_chain_project.monthly_sales
[0m01:59:15.894594 [info ] [Thread-1 (]: 7 of 10 START sql table model RAW_DATA_analytics.monthly_sales ................. [RUN]
[0m01:59:15.897396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.inventory_efficiency, now model.supply_chain_project.monthly_sales)
[0m01:59:15.898852 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.monthly_sales
[0m01:59:15.907133 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.monthly_sales"
[0m01:59:15.916085 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.monthly_sales
[0m01:59:15.926782 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.monthly_sales"
[0m01:59:15.938502 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.monthly_sales"
[0m01:59:15.940713 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.monthly_sales"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.monthly_sales
         as
        (

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        SKU,
        NUMBER_OF_PRODUCTS_SOLD,
        STOCK_LEVELS,
        COSTS,
        PRICE
    FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
)

SELECT
    DATE_TRUNC('month', sales_date) AS sales_month,
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_products_sold,
    AVG(STOCK_LEVELS) AS average_stock_levels,
    SUM(COSTS) AS total_costs,
    AVG(PRICE) AS average_price,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue
FROM daily_sales
GROUP BY 1, 2
        );
[0m01:59:15.942049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:59:17.232115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.290 seconds
[0m01:59:17.237527 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: Close
[0m01:59:17.404559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dc737020>]}
[0m01:59:17.406632 [info ] [Thread-1 (]: 7 of 10 OK created sql table model RAW_DATA_analytics.monthly_sales ............ [[32mSUCCESS 1[0m in 1.51s]
[0m01:59:17.408574 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.monthly_sales
[0m01:59:17.410464 [debug] [Thread-1 (]: Began running node model.supply_chain_project.product_performance
[0m01:59:17.411829 [info ] [Thread-1 (]: 8 of 10 START sql table model RAW_DATA_analytics.product_performance ........... [RUN]
[0m01:59:17.413292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.monthly_sales, now model.supply_chain_project.product_performance)
[0m01:59:17.414407 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.product_performance
[0m01:59:17.419142 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.product_performance"
[0m01:59:17.428005 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.product_performance
[0m01:59:17.432012 [debug] [Thread-1 (]: Dropping relation "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."PRODUCT_PERFORMANCE" because it is of type view
[0m01:59:17.436144 [debug] [Thread-1 (]: Applying DROP to: "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."PRODUCT_PERFORMANCE"
[0m01:59:17.438298 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.product_performance"
[0m01:59:17.439906 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.product_performance"} */
drop view if exists "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."PRODUCT_PERFORMANCE" cascade
[0m01:59:17.441120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:59:17.994643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.553 seconds
[0m01:59:17.998080 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.product_performance"
[0m01:59:18.008171 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.product_performance"
[0m01:59:18.009956 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.product_performance"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.product_performance
         as
        (

SELECT
    PRODUCT_TYPE,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
GROUP BY PRODUCT_TYPE
ORDER BY total_profit DESC
        );
[0m01:59:19.493664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.482 seconds
[0m01:59:19.497685 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: Close
[0m01:59:19.660469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dc7102c0>]}
[0m01:59:19.662974 [info ] [Thread-1 (]: 8 of 10 OK created sql table model RAW_DATA_analytics.product_performance ...... [[32mSUCCESS 1[0m in 2.25s]
[0m01:59:19.665397 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.product_performance
[0m01:59:19.667526 [debug] [Thread-1 (]: Began running node model.supply_chain_project.safety_stock
[0m01:59:19.670577 [info ] [Thread-1 (]: 9 of 10 START sql table model RAW_DATA_analytics.safety_stock .................. [RUN]
[0m01:59:19.673052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.product_performance, now model.supply_chain_project.safety_stock)
[0m01:59:19.675035 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.safety_stock
[0m01:59:19.682161 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.safety_stock"
[0m01:59:19.707046 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.safety_stock
[0m01:59:19.715279 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.safety_stock"
[0m01:59:19.729485 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.safety_stock"
[0m01:59:19.732425 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.safety_stock"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.safety_stock
         as
        (

WITH daily_variance AS (
    SELECT
        SKU,
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        NUMBER_OF_PRODUCTS_SOLD
    FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
)

SELECT
    SKU,
    ROUND(1.65 * STDDEV(NUMBER_OF_PRODUCTS_SOLD)) AS safety_stock_level  -- 95% service level
FROM daily_variance
GROUP BY SKU
        );
[0m01:59:19.734483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:59:21.473177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.739 seconds
[0m01:59:21.476951 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: Close
[0m01:59:21.631505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dd8d55e0>]}
[0m01:59:21.633176 [info ] [Thread-1 (]: 9 of 10 OK created sql table model RAW_DATA_analytics.safety_stock ............. [[32mSUCCESS 1[0m in 1.96s]
[0m01:59:21.634568 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.safety_stock
[0m01:59:21.635788 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sku_performance
[0m01:59:21.636959 [info ] [Thread-1 (]: 10 of 10 START sql table model RAW_DATA_analytics.sku_performance .............. [RUN]
[0m01:59:21.638872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.safety_stock, now model.supply_chain_project.sku_performance)
[0m01:59:21.640316 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sku_performance
[0m01:59:21.644921 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sku_performance"
[0m01:59:21.655468 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sku_performance
[0m01:59:21.659497 [debug] [Thread-1 (]: Dropping relation "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."SKU_PERFORMANCE" because it is of type view
[0m01:59:21.662914 [debug] [Thread-1 (]: Applying DROP to: "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."SKU_PERFORMANCE"
[0m01:59:21.664824 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sku_performance"
[0m01:59:21.665986 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sku_performance"} */
drop view if exists "STOCK_PRICE_DB"."RAW_DATA_ANALYTICS"."SKU_PERFORMANCE" cascade
[0m01:59:21.667244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:59:22.182595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m01:59:22.185541 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sku_performance"
[0m01:59:22.195236 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sku_performance"
[0m01:59:22.196618 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sku_performance"} */
create or replace transient table STOCK_PRICE_DB.RAW_DATA_analytics.sku_performance
         as
        (

SELECT
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM STOCK_PRICE_DB.RAW_DATA_analytics.sales_data
GROUP BY SKU
ORDER BY total_profit DESC
        );
[0m01:59:22.963398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m01:59:22.969767 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: Close
[0m01:59:23.149737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5163459b-35ef-4418-8155-e9779cc1a153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7dd9bac00>]}
[0m01:59:23.151531 [info ] [Thread-1 (]: 10 of 10 OK created sql table model RAW_DATA_analytics.sku_performance ......... [[32mSUCCESS 1[0m in 1.51s]
[0m01:59:23.153301 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sku_performance
[0m01:59:23.155873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:59:23.157222 [debug] [MainThread]: Connection 'model.supply_chain_project.sku_performance' was properly closed.
[0m01:59:23.158308 [info ] [MainThread]: 
[0m01:59:23.159596 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 21.64 seconds (21.64s).
[0m01:59:23.162694 [debug] [MainThread]: Command end result
[0m01:59:23.236344 [info ] [MainThread]: 
[0m01:59:23.237953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:59:23.239701 [info ] [MainThread]: 
[0m01:59:23.241909 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m01:59:23.244498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.380774, "process_user_time": 6.544779, "process_kernel_time": 1.515094, "process_mem_max_rss": "250888", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m01:59:23.246133 [debug] [MainThread]: Command `dbt run` succeeded at 01:59:23.245951 after 25.38 seconds
[0m01:59:23.247371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc816c86540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc81685f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc81685f860>]}
[0m01:59:23.248653 [debug] [MainThread]: Flushing usage events
[0m02:02:26.062049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17778218e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1774bc56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1774d122a0>]}


============================== 02:02:26.068967 | cae14138-af99-4575-8c24-732ba6921735 ==============================
[0m02:02:26.068967 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:02:26.070454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:02:26.993507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f75bf50>]}
[0m02:02:27.055971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f82b980>]}
[0m02:02:27.058110 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:02:27.158977 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m02:02:27.323901 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:02:27.325711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1775511a30>]}
[0m02:02:29.100091 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:02:29.101997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173efbfce0>]}
[0m02:02:29.744009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f3b3260>]}
[0m02:02:29.944625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173cf3b9e0>]}
[0m02:02:29.945843 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 4 sources, 8 metrics, 459 macros, 1 semantic model
[0m02:02:29.946943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173cb647d0>]}
[0m02:02:29.950683 [info ] [MainThread]: 
[0m02:02:29.952382 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:02:29.959277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m02:02:29.978297 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m02:02:29.979844 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m02:02:29.981054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:02:30.594992 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.614 seconds
[0m02:02:30.598183 [debug] [ThreadPool]: On list_DEV: Close
[0m02:02:30.748849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV, now create_DEV_RAW_DATA_analytics)
[0m02:02:30.751420 [debug] [ThreadPool]: Creating schema "database: "DEV"
schema: "RAW_DATA_analytics"
"
[0m02:02:30.758422 [debug] [ThreadPool]: Using snowflake connection "create_DEV_RAW_DATA_analytics"
[0m02:02:30.759997 [debug] [ThreadPool]: On create_DEV_RAW_DATA_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "create_DEV_RAW_DATA_analytics"} */
create schema if not exists DEV.RAW_DATA_analytics
[0m02:02:30.761293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:02:31.262143 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.501 seconds
[0m02:02:31.265127 [debug] [ThreadPool]: On create_DEV_RAW_DATA_analytics: Close
[0m02:02:31.435985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_DEV_RAW_DATA_analytics, now list_DEV_SNAPSHOTS)
[0m02:02:31.448623 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOTS"
[0m02:02:31.450368 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOTS"} */
show objects in DEV.SNAPSHOTS limit 10000
[0m02:02:31.451842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:02:32.079961 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8c5fa-0003-6d23-0003-431a000e3062
[0m02:02:32.081726 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m02:02:32.083448 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m02:02:32.084699 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m02:02:32.085926 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: Close
[0m02:02:32.253215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOTS, now list_DEV_RAW_DATA_analytics)
[0m02:02:32.257830 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RAW_DATA_analytics"
[0m02:02:32.259595 [debug] [ThreadPool]: On list_DEV_RAW_DATA_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_RAW_DATA_analytics"} */
show objects in DEV.RAW_DATA_analytics limit 10000
[0m02:02:32.261043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:02:32.903874 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.643 seconds
[0m02:02:32.907134 [debug] [ThreadPool]: On list_DEV_RAW_DATA_analytics: Close
[0m02:02:33.071477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f5879b0>]}
[0m02:02:33.073184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:02:33.074150 [info ] [MainThread]: 
[0m02:02:33.084285 [debug] [Thread-1 (]: Began running node model.supply_chain_project.metricflow_time_spine
[0m02:02:33.086433 [info ] [Thread-1 (]: 1 of 10 START sql table model RAW_DATA_analytics.metricflow_time_spine ......... [RUN]
[0m02:02:33.088345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEV_RAW_DATA_analytics, now model.supply_chain_project.metricflow_time_spine)
[0m02:02:33.089967 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.metricflow_time_spine
[0m02:02:33.099836 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.metricflow_time_spine"
[0m02:02:33.110022 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.metricflow_time_spine
[0m02:02:33.150955 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.metricflow_time_spine"
[0m02:02:33.160229 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.metricflow_time_spine"
[0m02:02:33.162419 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.metricflow_time_spine"} */
create or replace transient table DEV.RAW_DATA_analytics.metricflow_time_spine
         as
        (

WITH recursive_date_spine AS (
    -- Start date and end date for the time spine
    SELECT
        CAST('2023-01-01' AS DATE) AS date_spine -- Update start date as needed
    UNION ALL
    SELECT
        date_spine + 1
    FROM
        recursive_date_spine
    WHERE
        date_spine + 1 <= CAST('2030-12-31' AS DATE) -- Update end date as needed
)

SELECT
    date_spine AS time_spine_date,
    DATE_TRUNC('month', date_spine) AS time_spine_month,
    DATE_TRUNC('quarter', date_spine) AS time_spine_quarter,
    DATE_TRUNC('year', date_spine) AS time_spine_year
FROM
    recursive_date_spine
        );
[0m02:02:33.163823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:35.474253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.310 seconds
[0m02:02:35.504580 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: Close
[0m02:02:35.672721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f53f7a0>]}
[0m02:02:35.674689 [info ] [Thread-1 (]: 1 of 10 OK created sql table model RAW_DATA_analytics.metricflow_time_spine .... [[32mSUCCESS 1[0m in 2.58s]
[0m02:02:35.676621 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.metricflow_time_spine
[0m02:02:35.678319 [debug] [Thread-1 (]: Began running node model.supply_chain_project.predictions
[0m02:02:35.680237 [info ] [Thread-1 (]: 2 of 10 START sql table model RAW_DATA_analytics.predictions ................... [RUN]
[0m02:02:35.682080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.metricflow_time_spine, now model.supply_chain_project.predictions)
[0m02:02:35.683396 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.predictions
[0m02:02:35.689007 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.predictions"
[0m02:02:35.702473 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.predictions
[0m02:02:35.710152 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.predictions"
[0m02:02:35.725736 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.predictions"
[0m02:02:35.727759 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.predictions"} */
create or replace transient table DEV.RAW_DATA_analytics.predictions
         as
        (

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN Number_of_products_sold > 0 THEN Revenue_Generated/ Number_of_products_sold
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN Stock_levels < (Demand_Factor * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM DEV.raw.supply_chain_data
        );
[0m02:02:35.729868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:36.301517 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8c5fa-0003-6d23-0003-431a000e3066
[0m02:02:36.303108 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 29
invalid identifier 'DEMAND_FACTOR'
[0m02:02:36.304475 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: Close
[0m02:02:36.482306 [debug] [Thread-1 (]: Database Error in model predictions (models/warehouse/predictions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 29
  invalid identifier 'DEMAND_FACTOR'
  compiled code at target/run/supply_chain_project/models/warehouse/predictions.sql
[0m02:02:36.483954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173cb6ac30>]}
[0m02:02:36.485405 [error] [Thread-1 (]: 2 of 10 ERROR creating sql table model RAW_DATA_analytics.predictions .......... [[31mERROR[0m in 0.80s]
[0m02:02:36.487142 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.predictions
[0m02:02:36.488470 [debug] [Thread-1 (]: Began running node model.supply_chain_project.raw_data
[0m02:02:36.490519 [info ] [Thread-1 (]: 3 of 10 START sql table model RAW_DATA_analytics.raw_data ...................... [RUN]
[0m02:02:36.492009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.predictions, now model.supply_chain_project.raw_data)
[0m02:02:36.493120 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.raw_data
[0m02:02:36.498118 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.raw_data"
[0m02:02:36.508122 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.raw_data
[0m02:02:36.512461 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.raw_data"
[0m02:02:36.524575 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.raw_data"
[0m02:02:36.526117 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.raw_data"} */
create or replace transient table DEV.RAW_DATA_analytics.raw_data
         as
        (

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN Number_of_products_sold > 0 THEN Revenue_Generated / Number_of_products_sold
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN Stock_levels < (Demand_Factor * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM DEV.raw.supply_chain_data
        );
[0m02:02:36.527307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:36.980394 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8c5fa-0003-6eac-0003-431a000ec06a
[0m02:02:36.981995 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 29
invalid identifier 'DEMAND_FACTOR'
[0m02:02:36.983474 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: Close
[0m02:02:37.167637 [debug] [Thread-1 (]: Database Error in model raw_data (models/staging/raw_data.sql)
  000904 (42000): SQL compilation error: error line 15 at position 29
  invalid identifier 'DEMAND_FACTOR'
  compiled code at target/run/supply_chain_project/models/staging/raw_data.sql
[0m02:02:37.169368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173c0a91f0>]}
[0m02:02:37.171228 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model RAW_DATA_analytics.raw_data ............. [[31mERROR[0m in 0.68s]
[0m02:02:37.173051 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.raw_data
[0m02:02:37.174391 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sales_data
[0m02:02:37.175882 [info ] [Thread-1 (]: 4 of 10 START sql table model RAW_DATA_analytics.sales_data .................... [RUN]
[0m02:02:37.177483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.raw_data, now model.supply_chain_project.sales_data)
[0m02:02:37.179471 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sales_data
[0m02:02:37.184372 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sales_data"
[0m02:02:37.192978 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sales_data
[0m02:02:37.198950 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sales_data"
[0m02:02:37.208107 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sales_data"
[0m02:02:37.209551 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sales_data"} */
create or replace transient table DEV.RAW_DATA_analytics.sales_data
         as
        (

SELECT
    TO_TIMESTAMP_NTZ(ld.DATE_INSERT) AS DATE_INSERT,
    ld.SKU,
    ld.PRODUCT_TYPE,
    ld.PRICE,
    ld.NUMBER_OF_PRODUCTS_SOLD,
    ld.STOCK_LEVELS,
    ld.COSTS
FROM DEV.LIVE.live_data ld

UNION ALL

SELECT
    wp.DATE_INSERT,
    wp.SKU,
    NULL AS PRODUCT_TYPE,
    NULL AS PRICE,
    wp.NUMBER_OF_PRODUCTS_SOLD,
    wp.STOCK_LEVELS,
    wp.COSTS
FROM DEV.LIVE.weekly_predictions wp
        );
[0m02:02:37.210785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:39.588084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.377 seconds
[0m02:02:39.591716 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: Close
[0m02:02:39.892421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173c09b8f0>]}
[0m02:02:39.894413 [info ] [Thread-1 (]: 4 of 10 OK created sql table model RAW_DATA_analytics.sales_data ............... [[32mSUCCESS 1[0m in 2.71s]
[0m02:02:39.896036 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sales_data
[0m02:02:39.898170 [debug] [Thread-1 (]: Began running node model.supply_chain_project.demand_forecast
[0m02:02:39.899484 [info ] [Thread-1 (]: 5 of 10 START sql table model RAW_DATA_analytics.demand_forecast ............... [RUN]
[0m02:02:39.900952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.sales_data, now model.supply_chain_project.demand_forecast)
[0m02:02:39.902179 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.demand_forecast
[0m02:02:39.906713 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.demand_forecast"
[0m02:02:39.915517 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.demand_forecast
[0m02:02:39.919769 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.demand_forecast"
[0m02:02:39.928900 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.demand_forecast"
[0m02:02:39.930218 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.demand_forecast"} */
create or replace transient table DEV.RAW_DATA_analytics.demand_forecast
         as
        (

WITH historical_sales AS (
    SELECT
        DATE_TRUNC('week', DATE_INSERT) AS sales_week,
        SKU,
        SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold
    FROM DEV.RAW_DATA_analytics.sales_data
    GROUP BY 1, 2
)

SELECT
    SKU,
    DATEADD('week', 1, MAX(sales_week)) AS forecast_week,
    AVG(total_units_sold) AS forecast_units_sold
FROM historical_sales
GROUP BY SKU
        );
[0m02:02:39.931447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:41.710639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.779 seconds
[0m02:02:41.714494 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: Close
[0m02:02:41.915228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173f3c8440>]}
[0m02:02:41.917093 [info ] [Thread-1 (]: 5 of 10 OK created sql table model RAW_DATA_analytics.demand_forecast .......... [[32mSUCCESS 1[0m in 2.01s]
[0m02:02:41.918906 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.demand_forecast
[0m02:02:41.920349 [debug] [Thread-1 (]: Began running node model.supply_chain_project.inventory_efficiency
[0m02:02:41.921789 [info ] [Thread-1 (]: 6 of 10 START sql table model RAW_DATA_analytics.inventory_efficiency .......... [RUN]
[0m02:02:41.923141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.demand_forecast, now model.supply_chain_project.inventory_efficiency)
[0m02:02:41.924294 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.inventory_efficiency
[0m02:02:41.928951 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.inventory_efficiency"
[0m02:02:41.939879 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.inventory_efficiency
[0m02:02:41.943812 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.inventory_efficiency"
[0m02:02:41.952381 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.inventory_efficiency"
[0m02:02:41.953539 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.inventory_efficiency"} */
create or replace transient table DEV.RAW_DATA_analytics.inventory_efficiency
         as
        (

SELECT
    SKU,
    AVG(STOCK_LEVELS) AS average_stock,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    (SUM(NUMBER_OF_PRODUCTS_SOLD) / NULLIF(AVG(STOCK_LEVELS), 0)) AS inventory_turnover
FROM DEV.RAW_DATA_analytics.sales_data
GROUP BY SKU
        );
[0m02:02:41.954710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:43.392663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.438 seconds
[0m02:02:43.396143 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: Close
[0m02:02:43.579057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173c222b40>]}
[0m02:02:43.581718 [info ] [Thread-1 (]: 6 of 10 OK created sql table model RAW_DATA_analytics.inventory_efficiency ..... [[32mSUCCESS 1[0m in 1.66s]
[0m02:02:43.583491 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.inventory_efficiency
[0m02:02:43.585405 [debug] [Thread-1 (]: Began running node model.supply_chain_project.monthly_sales
[0m02:02:43.587511 [info ] [Thread-1 (]: 7 of 10 START sql table model RAW_DATA_analytics.monthly_sales ................. [RUN]
[0m02:02:43.589259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.inventory_efficiency, now model.supply_chain_project.monthly_sales)
[0m02:02:43.590690 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.monthly_sales
[0m02:02:43.596534 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.monthly_sales"
[0m02:02:43.606382 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.monthly_sales
[0m02:02:43.611128 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.monthly_sales"
[0m02:02:43.620501 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.monthly_sales"
[0m02:02:43.622260 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.monthly_sales"} */
create or replace transient table DEV.RAW_DATA_analytics.monthly_sales
         as
        (

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        SKU,
        NUMBER_OF_PRODUCTS_SOLD,
        STOCK_LEVELS,
        COSTS,
        PRICE
    FROM DEV.RAW_DATA_analytics.sales_data
)

SELECT
    DATE_TRUNC('month', sales_date) AS sales_month,
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_products_sold,
    AVG(STOCK_LEVELS) AS average_stock_levels,
    SUM(COSTS) AS total_costs,
    AVG(PRICE) AS average_price,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue
FROM daily_sales
GROUP BY 1, 2
        );
[0m02:02:43.623711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:45.117541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.494 seconds
[0m02:02:45.122153 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: Close
[0m02:02:45.305140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1778213e60>]}
[0m02:02:45.309309 [info ] [Thread-1 (]: 7 of 10 OK created sql table model RAW_DATA_analytics.monthly_sales ............ [[32mSUCCESS 1[0m in 1.71s]
[0m02:02:45.313434 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.monthly_sales
[0m02:02:45.316305 [debug] [Thread-1 (]: Began running node model.supply_chain_project.product_performance
[0m02:02:45.320411 [info ] [Thread-1 (]: 8 of 10 START sql table model RAW_DATA_analytics.product_performance ........... [RUN]
[0m02:02:45.324527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.monthly_sales, now model.supply_chain_project.product_performance)
[0m02:02:45.336949 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.product_performance
[0m02:02:45.367641 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.product_performance"
[0m02:02:45.383668 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.product_performance
[0m02:02:45.393370 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.product_performance"
[0m02:02:45.407251 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.product_performance"
[0m02:02:45.409391 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.product_performance"} */
create or replace transient table DEV.RAW_DATA_analytics.product_performance
         as
        (

SELECT
    PRODUCT_TYPE,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM DEV.RAW_DATA_analytics.sales_data
GROUP BY PRODUCT_TYPE
ORDER BY total_profit DESC
        );
[0m02:02:45.410698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:46.821874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.411 seconds
[0m02:02:46.825618 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: Close
[0m02:02:47.034925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1778214200>]}
[0m02:02:47.037334 [info ] [Thread-1 (]: 8 of 10 OK created sql table model RAW_DATA_analytics.product_performance ...... [[32mSUCCESS 1[0m in 1.71s]
[0m02:02:47.040500 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.product_performance
[0m02:02:47.043257 [debug] [Thread-1 (]: Began running node model.supply_chain_project.safety_stock
[0m02:02:47.045136 [info ] [Thread-1 (]: 9 of 10 START sql table model RAW_DATA_analytics.safety_stock .................. [RUN]
[0m02:02:47.047689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.product_performance, now model.supply_chain_project.safety_stock)
[0m02:02:47.049334 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.safety_stock
[0m02:02:47.059125 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.safety_stock"
[0m02:02:47.069614 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.safety_stock
[0m02:02:47.075600 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.safety_stock"
[0m02:02:47.085414 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.safety_stock"
[0m02:02:47.087065 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.safety_stock"} */
create or replace transient table DEV.RAW_DATA_analytics.safety_stock
         as
        (

WITH daily_variance AS (
    SELECT
        SKU,
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        NUMBER_OF_PRODUCTS_SOLD
    FROM DEV.RAW_DATA_analytics.sales_data
)

SELECT
    SKU,
    ROUND(1.65 * STDDEV(NUMBER_OF_PRODUCTS_SOLD)) AS safety_stock_level  -- 95% service level
FROM daily_variance
GROUP BY SKU
        );
[0m02:02:47.088274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:48.878112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.790 seconds
[0m02:02:48.881552 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: Close
[0m02:02:49.053676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173c0bf7d0>]}
[0m02:02:49.055476 [info ] [Thread-1 (]: 9 of 10 OK created sql table model RAW_DATA_analytics.safety_stock ............. [[32mSUCCESS 1[0m in 2.01s]
[0m02:02:49.057100 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.safety_stock
[0m02:02:49.058428 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sku_performance
[0m02:02:49.059773 [info ] [Thread-1 (]: 10 of 10 START sql table model RAW_DATA_analytics.sku_performance .............. [RUN]
[0m02:02:49.061144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.safety_stock, now model.supply_chain_project.sku_performance)
[0m02:02:49.062239 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sku_performance
[0m02:02:49.066405 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sku_performance"
[0m02:02:49.073940 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sku_performance
[0m02:02:49.078687 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sku_performance"
[0m02:02:49.087620 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sku_performance"
[0m02:02:49.089147 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sku_performance"} */
create or replace transient table DEV.RAW_DATA_analytics.sku_performance
         as
        (

SELECT
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM DEV.RAW_DATA_analytics.sales_data
GROUP BY SKU
ORDER BY total_profit DESC
        );
[0m02:02:49.090311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:02:51.573966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.484 seconds
[0m02:02:51.577802 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: Close
[0m02:02:51.810828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae14138-af99-4575-8c24-732ba6921735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173c0a3590>]}
[0m02:02:51.813230 [info ] [Thread-1 (]: 10 of 10 OK created sql table model RAW_DATA_analytics.sku_performance ......... [[32mSUCCESS 1[0m in 2.75s]
[0m02:02:51.815150 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sku_performance
[0m02:02:51.819430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:02:51.821397 [debug] [MainThread]: Connection 'model.supply_chain_project.sku_performance' was properly closed.
[0m02:02:51.823049 [info ] [MainThread]: 
[0m02:02:51.824387 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 21.87 seconds (21.87s).
[0m02:02:51.828617 [debug] [MainThread]: Command end result
[0m02:02:51.902874 [info ] [MainThread]: 
[0m02:02:51.904259 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:02:51.905467 [info ] [MainThread]: 
[0m02:02:51.907066 [error] [MainThread]:   Database Error in model predictions (models/warehouse/predictions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 29
  invalid identifier 'DEMAND_FACTOR'
  compiled code at target/run/supply_chain_project/models/warehouse/predictions.sql
[0m02:02:51.908226 [info ] [MainThread]: 
[0m02:02:51.909449 [error] [MainThread]:   Database Error in model raw_data (models/staging/raw_data.sql)
  000904 (42000): SQL compilation error: error line 15 at position 29
  invalid identifier 'DEMAND_FACTOR'
  compiled code at target/run/supply_chain_project/models/staging/raw_data.sql
[0m02:02:51.910493 [info ] [MainThread]: 
[0m02:02:51.911557 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m02:02:51.913654 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 25.957333, "process_user_time": 6.451084, "process_kernel_time": 1.473395, "process_mem_max_rss": "246212", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m02:02:51.915202 [debug] [MainThread]: Command `dbt run` failed at 02:02:51.915030 after 25.96 seconds
[0m02:02:51.916429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1775c15460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173cc6d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17755770b0>]}
[0m02:02:51.917892 [debug] [MainThread]: Flushing usage events
[0m03:14:27.527355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3476f37a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3476112180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34788ca810>]}


============================== 03:14:27.534984 | deffb14c-cf3c-448f-864d-4575163aa2ab ==============================
[0m03:14:27.534984 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:14:27.536186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m03:14:28.752150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deffb14c-cf3c-448f-864d-4575163aa2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34774243e0>]}
[0m03:14:28.806786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deffb14c-cf3c-448f-864d-4575163aa2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344476de50>]}
[0m03:14:28.808576 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:14:28.905705 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:14:29.199595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:14:29.200758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:14:29.282897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deffb14c-cf3c-448f-864d-4575163aa2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3447d512e0>]}
[0m03:14:29.314381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deffb14c-cf3c-448f-864d-4575163aa2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3444040d10>]}
[0m03:14:29.315405 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 4 sources, 8 metrics, 459 macros, 1 semantic model
[0m03:14:29.316344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deffb14c-cf3c-448f-864d-4575163aa2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3444288050>]}
[0m03:14:29.319969 [info ] [MainThread]: 
[0m03:14:29.321366 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:14:29.328061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV_RAW_DATA_analytics'
[0m03:14:29.353845 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RAW_DATA_analytics"
[0m03:14:29.356600 [debug] [ThreadPool]: On list_DEV_RAW_DATA_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_RAW_DATA_analytics"} */
show objects in DEV.RAW_DATA_analytics limit 10000
[0m03:14:29.358831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:14:30.074602 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.716 seconds
[0m03:14:30.078267 [debug] [ThreadPool]: On list_DEV_RAW_DATA_analytics: Close
[0m03:14:30.273939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_RAW_DATA_analytics, now list_DEV_SNAPSHOTS)
[0m03:14:30.279008 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOTS"
[0m03:14:30.280223 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOTS"} */
show objects in DEV.SNAPSHOTS limit 10000
[0m03:14:30.281287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:14:30.824881 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8c642-0003-6b7a-0003-431a000dd1de
[0m03:14:30.826014 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:14:30.827073 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:14:30.827877 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:14:30.828701 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: Close
[0m03:14:31.016879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deffb14c-cf3c-448f-864d-4575163aa2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344476f710>]}
[0m03:14:31.018224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:14:31.019310 [info ] [MainThread]: 
[0m03:14:31.028444 [debug] [Thread-1 (]: Began running node model.supply_chain_project.metricflow_time_spine
[0m03:14:31.029732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOTS, now model.supply_chain_project.metricflow_time_spine)
[0m03:14:31.030640 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.metricflow_time_spine
[0m03:14:31.040114 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.metricflow_time_spine"
[0m03:14:31.046756 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.metricflow_time_spine
[0m03:14:31.048477 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.metricflow_time_spine
[0m03:14:31.049506 [debug] [Thread-1 (]: Began running node model.supply_chain_project.predictions
[0m03:14:31.050695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.metricflow_time_spine, now model.supply_chain_project.predictions)
[0m03:14:31.051692 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.predictions
[0m03:14:31.055160 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.predictions"
[0m03:14:31.061735 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.predictions
[0m03:14:31.063060 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.predictions
[0m03:14:31.063964 [debug] [Thread-1 (]: Began running node model.supply_chain_project.raw_data
[0m03:14:31.064827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.predictions, now model.supply_chain_project.raw_data)
[0m03:14:31.065632 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.raw_data
[0m03:14:31.069575 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.raw_data"
[0m03:14:31.076027 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.raw_data
[0m03:14:31.077279 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.raw_data
[0m03:14:31.078215 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sales_data
[0m03:14:31.079169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.raw_data, now model.supply_chain_project.sales_data)
[0m03:14:31.080034 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sales_data
[0m03:14:31.083941 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sales_data"
[0m03:14:31.089754 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sales_data
[0m03:14:31.091221 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sales_data
[0m03:14:31.092354 [debug] [Thread-1 (]: Began running node snapshot.supply_chain_project.live_data_snapshot
[0m03:14:31.093619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.sales_data, now snapshot.supply_chain_project.live_data_snapshot)
[0m03:14:31.094614 [debug] [Thread-1 (]: Began compiling node snapshot.supply_chain_project.live_data_snapshot
[0m03:14:31.098898 [debug] [Thread-1 (]: Began executing node snapshot.supply_chain_project.live_data_snapshot
[0m03:14:31.100385 [debug] [Thread-1 (]: Finished running node snapshot.supply_chain_project.live_data_snapshot
[0m03:14:31.101395 [debug] [Thread-1 (]: Began running node test.supply_chain_project.source_not_null_live_live_data_DATE_INSERT.921f8dfa09
[0m03:14:31.102360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.supply_chain_project.live_data_snapshot, now test.supply_chain_project.source_not_null_live_live_data_DATE_INSERT.921f8dfa09)
[0m03:14:31.103248 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.source_not_null_live_live_data_DATE_INSERT.921f8dfa09
[0m03:14:31.116628 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.source_not_null_live_live_data_DATE_INSERT.921f8dfa09"
[0m03:14:31.127983 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.source_not_null_live_live_data_DATE_INSERT.921f8dfa09
[0m03:14:31.129538 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.source_not_null_live_live_data_DATE_INSERT.921f8dfa09
[0m03:14:31.130710 [debug] [Thread-1 (]: Began running node test.supply_chain_project.source_not_null_live_live_data_SKU.d2e9611101
[0m03:14:31.131650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.source_not_null_live_live_data_DATE_INSERT.921f8dfa09, now test.supply_chain_project.source_not_null_live_live_data_SKU.d2e9611101)
[0m03:14:31.132506 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.source_not_null_live_live_data_SKU.d2e9611101
[0m03:14:31.137153 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.source_not_null_live_live_data_SKU.d2e9611101"
[0m03:14:31.144268 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.source_not_null_live_live_data_SKU.d2e9611101
[0m03:14:31.145810 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.source_not_null_live_live_data_SKU.d2e9611101
[0m03:14:31.146852 [debug] [Thread-1 (]: Began running node test.supply_chain_project.source_not_null_live_weekly_predictions_DATE_INSERT.53fb046ee8
[0m03:14:31.147859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.source_not_null_live_live_data_SKU.d2e9611101, now test.supply_chain_project.source_not_null_live_weekly_predictions_DATE_INSERT.53fb046ee8)
[0m03:14:31.148729 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.source_not_null_live_weekly_predictions_DATE_INSERT.53fb046ee8
[0m03:14:31.154723 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.source_not_null_live_weekly_predictions_DATE_INSERT.53fb046ee8"
[0m03:14:31.162021 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.source_not_null_live_weekly_predictions_DATE_INSERT.53fb046ee8
[0m03:14:31.163415 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.source_not_null_live_weekly_predictions_DATE_INSERT.53fb046ee8
[0m03:14:31.164545 [debug] [Thread-1 (]: Began running node test.supply_chain_project.source_not_null_live_weekly_predictions_SKU.055760b17f
[0m03:14:31.165788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.source_not_null_live_weekly_predictions_DATE_INSERT.53fb046ee8, now test.supply_chain_project.source_not_null_live_weekly_predictions_SKU.055760b17f)
[0m03:14:31.166844 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.source_not_null_live_weekly_predictions_SKU.055760b17f
[0m03:14:31.171952 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.source_not_null_live_weekly_predictions_SKU.055760b17f"
[0m03:14:31.179521 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.source_not_null_live_weekly_predictions_SKU.055760b17f
[0m03:14:31.180912 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.source_not_null_live_weekly_predictions_SKU.055760b17f
[0m03:14:31.181939 [debug] [Thread-1 (]: Began running node model.supply_chain_project.demand_forecast
[0m03:14:31.182878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.source_not_null_live_weekly_predictions_SKU.055760b17f, now model.supply_chain_project.demand_forecast)
[0m03:14:31.183743 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.demand_forecast
[0m03:14:31.187358 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.demand_forecast"
[0m03:14:31.193665 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.demand_forecast
[0m03:14:31.195467 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.demand_forecast
[0m03:14:31.196857 [debug] [Thread-1 (]: Began running node model.supply_chain_project.inventory_efficiency
[0m03:14:31.197992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.demand_forecast, now model.supply_chain_project.inventory_efficiency)
[0m03:14:31.198903 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.inventory_efficiency
[0m03:14:31.202628 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.inventory_efficiency"
[0m03:14:31.209139 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.inventory_efficiency
[0m03:14:31.210562 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.inventory_efficiency
[0m03:14:31.211536 [debug] [Thread-1 (]: Began running node model.supply_chain_project.monthly_sales
[0m03:14:31.212731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.inventory_efficiency, now model.supply_chain_project.monthly_sales)
[0m03:14:31.213757 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.monthly_sales
[0m03:14:31.217535 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.monthly_sales"
[0m03:14:31.224373 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.monthly_sales
[0m03:14:31.225805 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.monthly_sales
[0m03:14:31.226857 [debug] [Thread-1 (]: Began running node model.supply_chain_project.product_performance
[0m03:14:31.227984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.monthly_sales, now model.supply_chain_project.product_performance)
[0m03:14:31.228920 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.product_performance
[0m03:14:31.233113 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.product_performance"
[0m03:14:31.240043 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.product_performance
[0m03:14:31.241511 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.product_performance
[0m03:14:31.242573 [debug] [Thread-1 (]: Began running node model.supply_chain_project.safety_stock
[0m03:14:31.243555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.product_performance, now model.supply_chain_project.safety_stock)
[0m03:14:31.244453 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.safety_stock
[0m03:14:31.248026 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.safety_stock"
[0m03:14:31.254291 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.safety_stock
[0m03:14:31.255774 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.safety_stock
[0m03:14:31.256919 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sku_performance
[0m03:14:31.258007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.safety_stock, now model.supply_chain_project.sku_performance)
[0m03:14:31.258882 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sku_performance
[0m03:14:31.262702 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sku_performance"
[0m03:14:31.269581 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sku_performance
[0m03:14:31.270999 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sku_performance
[0m03:14:31.272017 [debug] [Thread-1 (]: Began running node test.supply_chain_project.accepted_range_sales_data_number_of_products_sold__0.5344deecbb
[0m03:14:31.273040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.sku_performance, now test.supply_chain_project.accepted_range_sales_data_number_of_products_sold__0.5344deecbb)
[0m03:14:31.273954 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.accepted_range_sales_data_number_of_products_sold__0.5344deecbb
[0m03:14:31.287000 [debug] [Thread-1 (]: Compilation Error in test accepted_range_sales_data_number_of_products_sold__0 (models/schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:14:31.288488 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.accepted_range_sales_data_number_of_products_sold__0.5344deecbb
[0m03:14:31.289526 [debug] [Thread-1 (]: Began running node test.supply_chain_project.not_null_sales_data_date_insert.dd5d48b4d0
[0m03:14:31.291221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.accepted_range_sales_data_number_of_products_sold__0.5344deecbb, now test.supply_chain_project.not_null_sales_data_date_insert.dd5d48b4d0)
[0m03:14:31.292236 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.not_null_sales_data_date_insert.dd5d48b4d0
[0m03:14:31.296929 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.not_null_sales_data_date_insert.dd5d48b4d0"
[0m03:14:31.307394 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.not_null_sales_data_date_insert.dd5d48b4d0
[0m03:14:31.308890 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.not_null_sales_data_date_insert.dd5d48b4d0
[0m03:14:31.310174 [debug] [Thread-1 (]: Began running node test.supply_chain_project.not_null_sales_data_number_of_products_sold.53ec8e03b6
[0m03:14:31.311444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.not_null_sales_data_date_insert.dd5d48b4d0, now test.supply_chain_project.not_null_sales_data_number_of_products_sold.53ec8e03b6)
[0m03:14:31.312699 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.not_null_sales_data_number_of_products_sold.53ec8e03b6
[0m03:14:31.318717 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.not_null_sales_data_number_of_products_sold.53ec8e03b6"
[0m03:14:31.325941 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.not_null_sales_data_number_of_products_sold.53ec8e03b6
[0m03:14:31.327463 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.not_null_sales_data_number_of_products_sold.53ec8e03b6
[0m03:14:31.328573 [debug] [Thread-1 (]: Began running node test.supply_chain_project.not_null_sales_data_sku.a219036aa0
[0m03:14:31.329630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.not_null_sales_data_number_of_products_sold.53ec8e03b6, now test.supply_chain_project.not_null_sales_data_sku.a219036aa0)
[0m03:14:31.330519 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.not_null_sales_data_sku.a219036aa0
[0m03:14:31.335430 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.not_null_sales_data_sku.a219036aa0"
[0m03:14:31.342184 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.not_null_sales_data_sku.a219036aa0
[0m03:14:31.343532 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.not_null_sales_data_sku.a219036aa0
[0m03:14:31.344672 [debug] [Thread-1 (]: Began running node test.supply_chain_project.unique_sales_data_sku.482420bc29
[0m03:14:31.345853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.not_null_sales_data_sku.a219036aa0, now test.supply_chain_project.unique_sales_data_sku.482420bc29)
[0m03:14:31.346857 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.unique_sales_data_sku.482420bc29
[0m03:14:31.355984 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.unique_sales_data_sku.482420bc29"
[0m03:14:31.363884 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.unique_sales_data_sku.482420bc29
[0m03:14:31.365269 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.unique_sales_data_sku.482420bc29
[0m03:14:31.366234 [debug] [Thread-1 (]: Began running node test.supply_chain_project.accepted_range_monthly_sales_total_products_sold__0.365d4770d6
[0m03:14:31.367174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.unique_sales_data_sku.482420bc29, now test.supply_chain_project.accepted_range_monthly_sales_total_products_sold__0.365d4770d6)
[0m03:14:31.368087 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.accepted_range_monthly_sales_total_products_sold__0.365d4770d6
[0m03:14:31.373566 [debug] [Thread-1 (]: Compilation Error in test accepted_range_monthly_sales_total_products_sold__0 (models/schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:14:31.374681 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.accepted_range_monthly_sales_total_products_sold__0.365d4770d6
[0m03:14:31.375886 [debug] [Thread-1 (]: Began running node test.supply_chain_project.not_null_monthly_sales_sales_month.01a1b95108
[0m03:14:31.376820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.accepted_range_monthly_sales_total_products_sold__0.365d4770d6, now test.supply_chain_project.not_null_monthly_sales_sales_month.01a1b95108)
[0m03:14:31.377679 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.not_null_monthly_sales_sales_month.01a1b95108
[0m03:14:31.382306 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.not_null_monthly_sales_sales_month.01a1b95108"
[0m03:14:31.389610 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.not_null_monthly_sales_sales_month.01a1b95108
[0m03:14:31.391202 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.not_null_monthly_sales_sales_month.01a1b95108
[0m03:14:31.392142 [debug] [Thread-1 (]: Began running node test.supply_chain_project.not_null_monthly_sales_sku.fc01c3091f
[0m03:14:31.393039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.not_null_monthly_sales_sales_month.01a1b95108, now test.supply_chain_project.not_null_monthly_sales_sku.fc01c3091f)
[0m03:14:31.393946 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.not_null_monthly_sales_sku.fc01c3091f
[0m03:14:31.398600 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.not_null_monthly_sales_sku.fc01c3091f"
[0m03:14:31.405283 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.not_null_monthly_sales_sku.fc01c3091f
[0m03:14:31.406862 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.not_null_monthly_sales_sku.fc01c3091f
[0m03:14:31.407995 [debug] [Thread-1 (]: Began running node test.supply_chain_project.not_null_monthly_sales_total_products_sold.3a875fddf7
[0m03:14:31.408937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.supply_chain_project.not_null_monthly_sales_sku.fc01c3091f, now test.supply_chain_project.not_null_monthly_sales_total_products_sold.3a875fddf7)
[0m03:14:31.409784 [debug] [Thread-1 (]: Began compiling node test.supply_chain_project.not_null_monthly_sales_total_products_sold.3a875fddf7
[0m03:14:31.414572 [debug] [Thread-1 (]: Writing injected SQL for node "test.supply_chain_project.not_null_monthly_sales_total_products_sold.3a875fddf7"
[0m03:14:31.421576 [debug] [Thread-1 (]: Began executing node test.supply_chain_project.not_null_monthly_sales_total_products_sold.3a875fddf7
[0m03:14:31.423177 [debug] [Thread-1 (]: Finished running node test.supply_chain_project.not_null_monthly_sales_total_products_sold.3a875fddf7
[0m03:14:31.424241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:14:31.425224 [debug] [MainThread]: Connection 'test.supply_chain_project.not_null_monthly_sales_total_products_sold.3a875fddf7' was properly closed.
[0m03:14:31.426183 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test accepted_range_monthly_sales_total_products_sold__0 (models/schema.yml)
    'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:14:31.427890 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 4.0055437, "process_user_time": 3.62232, "process_kernel_time": 1.959114, "process_mem_max_rss": "242424", "process_in_blocks": "248", "process_out_blocks": "24", "command_success": false}
[0m03:14:31.429077 [debug] [MainThread]: Command `dbt docs generate` failed at 03:14:31.428939 after 4.01 seconds
[0m03:14:31.429940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3476f37a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3444438d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343dd01e80>]}
[0m03:14:31.430723 [debug] [MainThread]: Flushing usage events
[0m13:01:48.271525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244d99370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244663d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244c9ab70>]}


============================== 13:01:48.281183 | 6e613e60-f78c-4d0f-be18-593fe352341b ==============================
[0m13:01:48.281183 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:01:48.282666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:01:50.184657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20ed09dc0>]}
[0m13:01:50.251596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20f2dbad0>]}
[0m13:01:50.254365 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:01:50.369665 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:01:50.724986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m13:01:50.726982 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/inventory_efficiency.sql
[0m13:01:50.728574 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/sales_data.sql
[0m13:01:50.729800 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/monthly_sales.sql
[0m13:01:50.731027 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/staging/raw_data.sql
[0m13:01:50.732266 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/demand_forecast.sql
[0m13:01:50.733562 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/safety_stock.sql
[0m13:01:50.984737 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:01:50.986351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20e647a10>]}
[0m13:01:51.268621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20c5fe2a0>]}
[0m13:01:51.464069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20e675b80>]}
[0m13:01:51.465536 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 4 sources, 8 metrics, 459 macros, 1 semantic model
[0m13:01:51.467193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2459a08c0>]}
[0m13:01:51.470870 [info ] [MainThread]: 
[0m13:01:51.472727 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:51.479132 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:01:51.496853 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:01:51.498175 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:01:51.499151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:52.234641 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.735 seconds
[0m13:01:52.238444 [debug] [ThreadPool]: On list_DEV: Close
[0m13:01:52.410736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV, now list_DEV_RAW_DATA_analytics)
[0m13:01:52.423342 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RAW_DATA_analytics"
[0m13:01:52.424871 [debug] [ThreadPool]: On list_DEV_RAW_DATA_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_RAW_DATA_analytics"} */
show objects in DEV.RAW_DATA_analytics limit 10000
[0m13:01:52.425776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:53.099285 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.673 seconds
[0m13:01:53.102232 [debug] [ThreadPool]: On list_DEV_RAW_DATA_analytics: Close
[0m13:01:53.262955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_RAW_DATA_analytics, now list_DEV_SNAPSHOTS)
[0m13:01:53.267599 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOTS"
[0m13:01:53.268789 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOTS"} */
show objects in DEV.SNAPSHOTS limit 10000
[0m13:01:53.269822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:53.719715 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8d96e-0003-7684-0003-431a0012001a
[0m13:01:53.720895 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m13:01:53.721942 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m13:01:53.722801 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:01:53.723687 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: Close
[0m13:01:53.915727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe243d92150>]}
[0m13:01:53.917033 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:53.918009 [info ] [MainThread]: 
[0m13:01:53.929697 [debug] [Thread-1 (]: Began running node model.supply_chain_project.metricflow_time_spine
[0m13:01:53.931549 [info ] [Thread-1 (]: 1 of 10 START sql table model RAW_DATA_analytics.metricflow_time_spine ......... [RUN]
[0m13:01:53.933720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOTS, now model.supply_chain_project.metricflow_time_spine)
[0m13:01:53.935028 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.metricflow_time_spine
[0m13:01:53.944126 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.metricflow_time_spine"
[0m13:01:53.952383 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.metricflow_time_spine
[0m13:01:53.986178 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.metricflow_time_spine"
[0m13:01:53.994764 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.metricflow_time_spine"
[0m13:01:53.995837 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.metricflow_time_spine"} */
create or replace transient table DEV.RAW_DATA_analytics.metricflow_time_spine
         as
        (

WITH recursive_date_spine AS (
    -- Start date and end date for the time spine
    SELECT
        CAST('2023-01-01' AS DATE) AS date_spine -- Update start date as needed
    UNION ALL
    SELECT
        date_spine + 1
    FROM
        recursive_date_spine
    WHERE
        date_spine + 1 <= CAST('2030-12-31' AS DATE) -- Update end date as needed
)

SELECT
    date_spine AS time_spine_date,
    DATE_TRUNC('month', date_spine) AS time_spine_month,
    DATE_TRUNC('quarter', date_spine) AS time_spine_quarter,
    DATE_TRUNC('year', date_spine) AS time_spine_year
FROM
    recursive_date_spine
        );
[0m13:01:53.996759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:56.031473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.035 seconds
[0m13:01:56.057694 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: Close
[0m13:01:56.205302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20c5fe840>]}
[0m13:01:56.207533 [info ] [Thread-1 (]: 1 of 10 OK created sql table model RAW_DATA_analytics.metricflow_time_spine .... [[32mSUCCESS 1[0m in 2.27s]
[0m13:01:56.209139 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.metricflow_time_spine
[0m13:01:56.210492 [debug] [Thread-1 (]: Began running node model.supply_chain_project.predictions
[0m13:01:56.212099 [info ] [Thread-1 (]: 2 of 10 START sql table model RAW_DATA_analytics.predictions ................... [RUN]
[0m13:01:56.213682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.metricflow_time_spine, now model.supply_chain_project.predictions)
[0m13:01:56.214715 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.predictions
[0m13:01:56.221197 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.predictions"
[0m13:01:56.229408 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.predictions
[0m13:01:56.233514 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.predictions"
[0m13:01:56.242351 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.predictions"
[0m13:01:56.243648 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.predictions"} */
create or replace transient table DEV.RAW_DATA_analytics.predictions
         as
        (

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN Number_of_products_sold > 0 THEN Revenue_Generated/ Number_of_products_sold
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN Stock_levels < (Demand_Factor * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM DEV.raw.supply_chain_data
        );
[0m13:01:56.244532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:56.815541 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8d96e-0003-761b-0003-431a0010f43e
[0m13:01:56.816820 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 29
invalid identifier 'DEMAND_FACTOR'
[0m13:01:56.818279 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: Close
[0m13:01:57.003668 [debug] [Thread-1 (]: Database Error in model predictions (models/warehouse/predictions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 29
  invalid identifier 'DEMAND_FACTOR'
  compiled code at target/run/supply_chain_project/models/warehouse/predictions.sql
[0m13:01:57.005874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20c1c3590>]}
[0m13:01:57.008379 [error] [Thread-1 (]: 2 of 10 ERROR creating sql table model RAW_DATA_analytics.predictions .......... [[31mERROR[0m in 0.79s]
[0m13:01:57.010102 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.predictions
[0m13:01:57.011589 [debug] [Thread-1 (]: Began running node model.supply_chain_project.raw_data
[0m13:01:57.013649 [info ] [Thread-1 (]: 3 of 10 START sql table model RAW_DATA_analytics.raw_data ...................... [RUN]
[0m13:01:57.014841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.predictions, now model.supply_chain_project.raw_data)
[0m13:01:57.015879 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.raw_data
[0m13:01:57.020252 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.raw_data"
[0m13:01:57.028702 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.raw_data
[0m13:01:57.032950 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.raw_data"
[0m13:01:57.041581 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.raw_data"
[0m13:01:57.043062 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.raw_data"} */
create or replace transient table DEV.RAW_DATA_analytics.raw_data
         as
        (

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN NUMBER_OF_PRODUCTS_SOLD > 0 THEN REVENUE_GENERATED / NUMBER_OF_PRODUCTS_SOLD
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN STOCK_LEVELS < (DEMAND_FACTOR * 10) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM DEV.raw.supply_chain_data
WHERE DATE_INSERT IS NOT NULL
  AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
        );
[0m13:01:57.044009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:57.657202 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8d96e-0003-77e1-0003-431a00118056
[0m13:01:57.658586 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 29
invalid identifier 'DEMAND_FACTOR'
[0m13:01:57.660019 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: Close
[0m13:01:57.844912 [debug] [Thread-1 (]: Database Error in model raw_data (models/staging/raw_data.sql)
  000904 (42000): SQL compilation error: error line 15 at position 29
  invalid identifier 'DEMAND_FACTOR'
  compiled code at target/run/supply_chain_project/models/staging/raw_data.sql
[0m13:01:57.846680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20c17be30>]}
[0m13:01:57.848534 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model RAW_DATA_analytics.raw_data ............. [[31mERROR[0m in 0.83s]
[0m13:01:57.850277 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.raw_data
[0m13:01:57.851325 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sales_data
[0m13:01:57.852548 [info ] [Thread-1 (]: 4 of 10 START sql table model RAW_DATA_analytics.sales_data .................... [RUN]
[0m13:01:57.853926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.raw_data, now model.supply_chain_project.sales_data)
[0m13:01:57.855117 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sales_data
[0m13:01:57.859358 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sales_data"
[0m13:01:57.865936 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sales_data
[0m13:01:57.870241 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sales_data"
[0m13:01:57.878656 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sales_data"
[0m13:01:57.880269 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sales_data"} */
create or replace transient table DEV.RAW_DATA_analytics.sales_data
         as
        (

SELECT
    TO_TIMESTAMP_NTZ(ld.DATE_INSERT) AS DATE_INSERT,
    ld.SKU,
    ld.PRODUCT_TYPE,
    ld.PRICE,
    ld.NUMBER_OF_PRODUCTS_SOLD,
    ld.STOCK_LEVELS,
    ld.COSTS
FROM DEV.LIVE.live_data ld
WHERE ld.DATE_INSERT IS NOT NULL
  AND DATE_PART('year', TO_TIMESTAMP_NTZ(ld.DATE_INSERT)) BETWEEN 1900 AND 2100

UNION ALL

SELECT
    wp.DATE_INSERT,
    wp.SKU,
    NULL AS PRODUCT_TYPE,
    NULL AS PRICE,
    wp.NUMBER_OF_PRODUCTS_SOLD,
    wp.STOCK_LEVELS,
    wp.COSTS
FROM DEV.LIVE.weekly_predictions wp
WHERE wp.DATE_INSERT IS NOT NULL
  AND DATE_PART('year', wp.DATE_INSERT) BETWEEN 1900 AND 2100
        );
[0m13:01:57.881299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:00.524095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.643 seconds
[0m13:02:00.528177 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: Close
[0m13:02:01.176903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20c217650>]}
[0m13:02:01.178294 [info ] [Thread-1 (]: 4 of 10 OK created sql table model RAW_DATA_analytics.sales_data ............... [[32mSUCCESS 1[0m in 3.32s]
[0m13:02:01.179895 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sales_data
[0m13:02:01.182063 [debug] [Thread-1 (]: Began running node model.supply_chain_project.demand_forecast
[0m13:02:01.183484 [info ] [Thread-1 (]: 5 of 10 START sql table model RAW_DATA_analytics.demand_forecast ............... [RUN]
[0m13:02:01.184680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.sales_data, now model.supply_chain_project.demand_forecast)
[0m13:02:01.185733 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.demand_forecast
[0m13:02:01.189832 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.demand_forecast"
[0m13:02:01.196659 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.demand_forecast
[0m13:02:01.200602 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.demand_forecast"
[0m13:02:01.208199 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.demand_forecast"
[0m13:02:01.209281 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.demand_forecast"} */
create or replace transient table DEV.RAW_DATA_analytics.demand_forecast
         as
        (

WITH historical_sales AS (
    SELECT
        DATE_TRUNC('week', DATE_INSERT) AS sales_week,
        SKU,
        SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
    GROUP BY 1, 2
)

SELECT
    SKU,
    DATEADD('week', 1, MAX(sales_week)) AS forecast_week,
    AVG(total_units_sold) AS forecast_units_sold
FROM historical_sales
GROUP BY SKU
        );
[0m13:02:01.210830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:03.477669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.267 seconds
[0m13:02:03.481641 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: Close
[0m13:02:03.679145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20c20f440>]}
[0m13:02:03.681187 [info ] [Thread-1 (]: 5 of 10 OK created sql table model RAW_DATA_analytics.demand_forecast .......... [[32mSUCCESS 1[0m in 2.49s]
[0m13:02:03.682837 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.demand_forecast
[0m13:02:03.684887 [debug] [Thread-1 (]: Began running node model.supply_chain_project.inventory_efficiency
[0m13:02:03.686488 [info ] [Thread-1 (]: 6 of 10 START sql table model RAW_DATA_analytics.inventory_efficiency .......... [RUN]
[0m13:02:03.687681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.demand_forecast, now model.supply_chain_project.inventory_efficiency)
[0m13:02:03.688794 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.inventory_efficiency
[0m13:02:03.693479 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.inventory_efficiency"
[0m13:02:03.700814 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.inventory_efficiency
[0m13:02:03.705638 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.inventory_efficiency"
[0m13:02:03.714042 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.inventory_efficiency"
[0m13:02:03.715571 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.inventory_efficiency"} */
create or replace transient table DEV.RAW_DATA_analytics.inventory_efficiency
         as
        (

WITH weekly_sales AS (
    SELECT
        DATE_TRUNC('week', DATE_INSERT) AS sales_week,
        SKU,
        SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
        AVG(STOCK_LEVELS) AS average_stock
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
    GROUP BY 1, 2
)

SELECT
    SKU,
    AVG(average_stock) AS average_stock,
    SUM(total_units_sold) AS total_units_sold,
    SUM(total_units_sold) / NULLIF(SUM(average_stock), 0) AS inventory_turnover  -- Avoid division by zero
FROM weekly_sales
GROUP BY SKU
        );
[0m13:02:03.716794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:05.264372 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.548 seconds
[0m13:02:05.267715 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: Close
[0m13:02:05.461819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20c03be60>]}
[0m13:02:05.463505 [info ] [Thread-1 (]: 6 of 10 OK created sql table model RAW_DATA_analytics.inventory_efficiency ..... [[32mSUCCESS 1[0m in 1.77s]
[0m13:02:05.465032 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.inventory_efficiency
[0m13:02:05.466276 [debug] [Thread-1 (]: Began running node model.supply_chain_project.monthly_sales
[0m13:02:05.467598 [info ] [Thread-1 (]: 7 of 10 START sql table model RAW_DATA_analytics.monthly_sales ................. [RUN]
[0m13:02:05.468767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.inventory_efficiency, now model.supply_chain_project.monthly_sales)
[0m13:02:05.472357 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.monthly_sales
[0m13:02:05.479191 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.monthly_sales"
[0m13:02:05.486690 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.monthly_sales
[0m13:02:05.577868 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.monthly_sales"
[0m13:02:05.585604 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.monthly_sales"
[0m13:02:05.586877 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.monthly_sales"} */
create or replace transient table DEV.RAW_DATA_analytics.monthly_sales
         as
        (

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        SKU,
        NUMBER_OF_PRODUCTS_SOLD,
        STOCK_LEVELS,
        COSTS,
        PRICE
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100  -- Exclude invalid dates
)

SELECT
    DATE_TRUNC('month', sales_date) AS sales_month,
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_products_sold,
    AVG(STOCK_LEVELS) AS average_stock_levels,
    SUM(COSTS) AS total_costs,
    AVG(PRICE) AS average_price,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue
FROM daily_sales
GROUP BY 1, 2
        );
[0m13:02:05.588046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:07.360736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.773 seconds
[0m13:02:07.365614 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: Close
[0m13:02:07.522735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24819fa40>]}
[0m13:02:07.524326 [info ] [Thread-1 (]: 7 of 10 OK created sql table model RAW_DATA_analytics.monthly_sales ............ [[32mSUCCESS 1[0m in 2.05s]
[0m13:02:07.526389 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.monthly_sales
[0m13:02:07.528399 [debug] [Thread-1 (]: Began running node model.supply_chain_project.product_performance
[0m13:02:07.529869 [info ] [Thread-1 (]: 8 of 10 START sql table model RAW_DATA_analytics.product_performance ........... [RUN]
[0m13:02:07.531376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.monthly_sales, now model.supply_chain_project.product_performance)
[0m13:02:07.533170 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.product_performance
[0m13:02:07.538140 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.product_performance"
[0m13:02:07.545654 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.product_performance
[0m13:02:07.550720 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.product_performance"
[0m13:02:07.557919 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.product_performance"
[0m13:02:07.559106 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.product_performance"} */
create or replace transient table DEV.RAW_DATA_analytics.product_performance
         as
        (

SELECT
    PRODUCT_TYPE,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM DEV.RAW_DATA_analytics.sales_data
GROUP BY PRODUCT_TYPE
ORDER BY total_profit DESC
        );
[0m13:02:07.560481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:09.491639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.931 seconds
[0m13:02:09.495083 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: Close
[0m13:02:09.690551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20f2a0140>]}
[0m13:02:09.692235 [info ] [Thread-1 (]: 8 of 10 OK created sql table model RAW_DATA_analytics.product_performance ...... [[32mSUCCESS 1[0m in 2.16s]
[0m13:02:09.693700 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.product_performance
[0m13:02:09.694879 [debug] [Thread-1 (]: Began running node model.supply_chain_project.safety_stock
[0m13:02:09.696300 [info ] [Thread-1 (]: 9 of 10 START sql table model RAW_DATA_analytics.safety_stock .................. [RUN]
[0m13:02:09.697668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.product_performance, now model.supply_chain_project.safety_stock)
[0m13:02:09.698928 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.safety_stock
[0m13:02:09.703774 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.safety_stock"
[0m13:02:09.710126 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.safety_stock
[0m13:02:09.713951 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.safety_stock"
[0m13:02:09.721991 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.safety_stock"
[0m13:02:09.723249 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.safety_stock"} */
create or replace transient table DEV.RAW_DATA_analytics.safety_stock
         as
        (

WITH daily_variance AS (
    SELECT
        SKU,
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        NUMBER_OF_PRODUCTS_SOLD
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
)

SELECT
    SKU,
    ROUND(1.65 * STDDEV(NUMBER_OF_PRODUCTS_SOLD)) AS safety_stock_level  -- 95% service level
FROM daily_variance
GROUP BY SKU
        );
[0m13:02:09.724119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:11.666568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.942 seconds
[0m13:02:11.674669 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: Close
[0m13:02:11.843241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20f2f9580>]}
[0m13:02:11.844722 [info ] [Thread-1 (]: 9 of 10 OK created sql table model RAW_DATA_analytics.safety_stock ............. [[32mSUCCESS 1[0m in 2.15s]
[0m13:02:11.846160 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.safety_stock
[0m13:02:11.847781 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sku_performance
[0m13:02:11.849679 [info ] [Thread-1 (]: 10 of 10 START sql table model RAW_DATA_analytics.sku_performance .............. [RUN]
[0m13:02:11.851075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.safety_stock, now model.supply_chain_project.sku_performance)
[0m13:02:11.852627 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sku_performance
[0m13:02:11.857427 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sku_performance"
[0m13:02:11.863862 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sku_performance
[0m13:02:11.867960 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sku_performance"
[0m13:02:11.876083 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sku_performance"
[0m13:02:11.877460 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sku_performance"} */
create or replace transient table DEV.RAW_DATA_analytics.sku_performance
         as
        (

SELECT
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM DEV.RAW_DATA_analytics.sales_data
GROUP BY SKU
ORDER BY total_profit DESC
        );
[0m13:02:11.878777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:13.391789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.513 seconds
[0m13:02:13.395734 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: Close
[0m13:02:13.565409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e613e60-f78c-4d0f-be18-593fe352341b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20e7c4a70>]}
[0m13:02:13.566720 [info ] [Thread-1 (]: 10 of 10 OK created sql table model RAW_DATA_analytics.sku_performance ......... [[32mSUCCESS 1[0m in 1.71s]
[0m13:02:13.568168 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sku_performance
[0m13:02:13.570324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:13.571203 [debug] [MainThread]: Connection 'model.supply_chain_project.sku_performance' was properly closed.
[0m13:02:13.572145 [info ] [MainThread]: 
[0m13:02:13.573048 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 22.10 seconds (22.10s).
[0m13:02:13.575792 [debug] [MainThread]: Command end result
[0m13:02:13.634773 [info ] [MainThread]: 
[0m13:02:13.636071 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:02:13.637548 [info ] [MainThread]: 
[0m13:02:13.638705 [error] [MainThread]:   Database Error in model predictions (models/warehouse/predictions.sql)
  000904 (42000): SQL compilation error: error line 15 at position 29
  invalid identifier 'DEMAND_FACTOR'
  compiled code at target/run/supply_chain_project/models/warehouse/predictions.sql
[0m13:02:13.639648 [info ] [MainThread]: 
[0m13:02:13.640910 [error] [MainThread]:   Database Error in model raw_data (models/staging/raw_data.sql)
  000904 (42000): SQL compilation error: error line 15 at position 29
  invalid identifier 'DEMAND_FACTOR'
  compiled code at target/run/supply_chain_project/models/staging/raw_data.sql
[0m13:02:13.642167 [info ] [MainThread]: 
[0m13:02:13.644078 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m13:02:13.646249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 25.607494, "process_user_time": 5.56098, "process_kernel_time": 2.345722, "process_mem_max_rss": "243300", "process_in_blocks": "35352", "process_out_blocks": "1272", "command_success": false}
[0m13:02:13.647828 [debug] [MainThread]: Command `dbt run` failed at 13:02:13.647655 after 25.61 seconds
[0m13:02:13.649093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244d99370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20e824ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe20e8275f0>]}
[0m13:02:13.650079 [debug] [MainThread]: Flushing usage events
[0m13:03:01.636452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3612a9fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36124a6b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36124a6c30>]}


============================== 13:03:01.643290 | 46893228-7ff2-4997-8ff0-846164983966 ==============================
[0m13:03:01.643290 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:03:01.644647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:03:02.609920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36132628d0>]}
[0m13:03:02.670140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35e0a1ecf0>]}
[0m13:03:02.672040 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:03:02.778289 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:03:03.122166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:03:03.123845 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/staging/raw_data.sql
[0m13:03:03.124902 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/warehouse/predictions.sql
[0m13:03:03.486981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35e093d1f0>]}
[0m13:03:03.720052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35e0752b10>]}
[0m13:03:03.721703 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 4 sources, 8 metrics, 459 macros, 1 semantic model
[0m13:03:03.723345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3613699d60>]}
[0m13:03:03.728349 [info ] [MainThread]: 
[0m13:03:03.730361 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:03:03.737772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:03:03.759690 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:03:03.761205 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:03:03.762401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:04.400665 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.638 seconds
[0m13:03:04.403548 [debug] [ThreadPool]: On list_DEV: Close
[0m13:03:04.624015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV, now list_DEV_SNAPSHOTS)
[0m13:03:04.634664 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOTS"
[0m13:03:04.636135 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOTS"} */
show objects in DEV.SNAPSHOTS limit 10000
[0m13:03:04.637197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:05.183471 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8d96f-0003-714d-0003-431a001112fe
[0m13:03:05.184836 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m13:03:05.185959 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m13:03:05.187077 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:03:05.188503 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: Close
[0m13:03:05.370484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOTS, now list_DEV_RAW_DATA_analytics)
[0m13:03:05.374367 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RAW_DATA_analytics"
[0m13:03:05.375760 [debug] [ThreadPool]: On list_DEV_RAW_DATA_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_RAW_DATA_analytics"} */
show objects in DEV.RAW_DATA_analytics limit 10000
[0m13:03:05.377174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:05.934357 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.557 seconds
[0m13:03:05.938354 [debug] [ThreadPool]: On list_DEV_RAW_DATA_analytics: Close
[0m13:03:06.106615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35e0751c70>]}
[0m13:03:06.109080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:03:06.110762 [info ] [MainThread]: 
[0m13:03:06.123588 [debug] [Thread-1 (]: Began running node model.supply_chain_project.metricflow_time_spine
[0m13:03:06.125253 [info ] [Thread-1 (]: 1 of 10 START sql table model RAW_DATA_analytics.metricflow_time_spine ......... [RUN]
[0m13:03:06.127630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEV_RAW_DATA_analytics, now model.supply_chain_project.metricflow_time_spine)
[0m13:03:06.129368 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.metricflow_time_spine
[0m13:03:06.139230 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.metricflow_time_spine"
[0m13:03:06.148222 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.metricflow_time_spine
[0m13:03:06.185108 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.metricflow_time_spine"
[0m13:03:06.196129 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.metricflow_time_spine"
[0m13:03:06.197583 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.metricflow_time_spine"} */
create or replace transient table DEV.RAW_DATA_analytics.metricflow_time_spine
         as
        (

WITH recursive_date_spine AS (
    -- Start date and end date for the time spine
    SELECT
        CAST('2023-01-01' AS DATE) AS date_spine -- Update start date as needed
    UNION ALL
    SELECT
        date_spine + 1
    FROM
        recursive_date_spine
    WHERE
        date_spine + 1 <= CAST('2030-12-31' AS DATE) -- Update end date as needed
)

SELECT
    date_spine AS time_spine_date,
    DATE_TRUNC('month', date_spine) AS time_spine_month,
    DATE_TRUNC('quarter', date_spine) AS time_spine_quarter,
    DATE_TRUNC('year', date_spine) AS time_spine_year
FROM
    recursive_date_spine
        );
[0m13:03:06.199921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:08.573401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.374 seconds
[0m13:03:08.599145 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: Close
[0m13:03:08.789046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35e0c13560>]}
[0m13:03:08.790681 [info ] [Thread-1 (]: 1 of 10 OK created sql table model RAW_DATA_analytics.metricflow_time_spine .... [[32mSUCCESS 1[0m in 2.66s]
[0m13:03:08.791953 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.metricflow_time_spine
[0m13:03:08.793351 [debug] [Thread-1 (]: Began running node model.supply_chain_project.predictions
[0m13:03:08.794922 [info ] [Thread-1 (]: 2 of 10 START sql table model RAW_DATA_analytics.predictions ................... [RUN]
[0m13:03:08.796145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.metricflow_time_spine, now model.supply_chain_project.predictions)
[0m13:03:08.797020 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.predictions
[0m13:03:08.801261 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.predictions"
[0m13:03:08.808732 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.predictions
[0m13:03:08.812911 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.predictions"
[0m13:03:08.821657 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.predictions"
[0m13:03:08.823004 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.predictions"} */
create or replace transient table DEV.RAW_DATA_analytics.predictions
         as
        (-- 

-- SELECT 
--     *,
--     -- Calculate average revenue per product
--     CASE 
--         WHEN Number_of_products_sold > 0 THEN Revenue_Generated/ Number_of_products_sold
--         ELSE NULL
--     END AS avg_revenue_per_product,
    
--     -- Restock flag based on stock levels
--     CASE
--         WHEN Stock_levels < (Demand_Factor * 10) THEN 1
--         ELSE 0
--     END AS restock_flag
    
-- FROM DEV.raw.supply_chain_data
        );
[0m13:03:08.824310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:09.382238 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8d96f-0003-77e1-0003-431a00118066
[0m13:03:09.383399 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 8 unexpected ')'.
[0m13:03:09.384418 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: Close
[0m13:03:09.555349 [debug] [Thread-1 (]: Database Error in model predictions (models/warehouse/predictions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 8 unexpected ')'.
  compiled code at target/run/supply_chain_project/models/warehouse/predictions.sql
[0m13:03:09.557010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35da280bc0>]}
[0m13:03:09.558625 [error] [Thread-1 (]: 2 of 10 ERROR creating sql table model RAW_DATA_analytics.predictions .......... [[31mERROR[0m in 0.76s]
[0m13:03:09.560184 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.predictions
[0m13:03:09.561277 [debug] [Thread-1 (]: Began running node model.supply_chain_project.raw_data
[0m13:03:09.563890 [info ] [Thread-1 (]: 3 of 10 START sql table model RAW_DATA_analytics.raw_data ...................... [RUN]
[0m13:03:09.565386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.predictions, now model.supply_chain_project.raw_data)
[0m13:03:09.566326 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.raw_data
[0m13:03:09.570800 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.raw_data"
[0m13:03:09.579132 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.raw_data
[0m13:03:09.583434 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.raw_data"
[0m13:03:09.590696 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.raw_data"
[0m13:03:09.595597 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.raw_data"} */
create or replace transient table DEV.RAW_DATA_analytics.raw_data
         as
        (-- 

-- SELECT 
--     *,
--     -- Calculate average revenue per product
--     CASE 
--         WHEN NUMBER_OF_PRODUCTS_SOLD > 0 THEN REVENUE_GENERATED / NUMBER_OF_PRODUCTS_SOLD
--         ELSE NULL
--     END AS avg_revenue_per_product,
    
--     -- Restock flag based on stock levels
--     CASE
--         WHEN STOCK_LEVELS < (DEMAND_FACTOR * 10) THEN 1
--         ELSE 0
--     END AS restock_flag
    
-- FROM DEV.raw.supply_chain_data
-- WHERE DATE_INSERT IS NOT NULL
--   AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
        );
[0m13:03:09.597068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:10.139933 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8d96f-0003-7564-0003-431a0011903e
[0m13:03:10.141315 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 8 unexpected ')'.
[0m13:03:10.142513 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: Close
[0m13:03:10.314917 [debug] [Thread-1 (]: Database Error in model raw_data (models/staging/raw_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 8 unexpected ')'.
  compiled code at target/run/supply_chain_project/models/staging/raw_data.sql
[0m13:03:10.316704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d98bb4d0>]}
[0m13:03:10.318369 [error] [Thread-1 (]: 3 of 10 ERROR creating sql table model RAW_DATA_analytics.raw_data ............. [[31mERROR[0m in 0.75s]
[0m13:03:10.320037 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.raw_data
[0m13:03:10.321793 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sales_data
[0m13:03:10.323292 [info ] [Thread-1 (]: 4 of 10 START sql table model RAW_DATA_analytics.sales_data .................... [RUN]
[0m13:03:10.324700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.raw_data, now model.supply_chain_project.sales_data)
[0m13:03:10.325967 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sales_data
[0m13:03:10.333489 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sales_data"
[0m13:03:10.342609 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sales_data
[0m13:03:10.347216 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sales_data"
[0m13:03:10.355996 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sales_data"
[0m13:03:10.357752 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sales_data"} */
create or replace transient table DEV.RAW_DATA_analytics.sales_data
         as
        (

SELECT
    TO_TIMESTAMP_NTZ(ld.DATE_INSERT) AS DATE_INSERT,
    ld.SKU,
    ld.PRODUCT_TYPE,
    ld.PRICE,
    ld.NUMBER_OF_PRODUCTS_SOLD,
    ld.STOCK_LEVELS,
    ld.COSTS
FROM DEV.LIVE.live_data ld
WHERE ld.DATE_INSERT IS NOT NULL
  AND DATE_PART('year', TO_TIMESTAMP_NTZ(ld.DATE_INSERT)) BETWEEN 1900 AND 2100

UNION ALL

SELECT
    wp.DATE_INSERT,
    wp.SKU,
    NULL AS PRODUCT_TYPE,
    NULL AS PRICE,
    wp.NUMBER_OF_PRODUCTS_SOLD,
    wp.STOCK_LEVELS,
    wp.COSTS
FROM DEV.LIVE.weekly_predictions wp
WHERE wp.DATE_INSERT IS NOT NULL
  AND DATE_PART('year', wp.DATE_INSERT) BETWEEN 1900 AND 2100
        );
[0m13:03:10.359021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:12.486979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.128 seconds
[0m13:03:12.490408 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: Close
[0m13:03:12.659842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d98392e0>]}
[0m13:03:12.661764 [info ] [Thread-1 (]: 4 of 10 OK created sql table model RAW_DATA_analytics.sales_data ............... [[32mSUCCESS 1[0m in 2.33s]
[0m13:03:12.663356 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sales_data
[0m13:03:12.665421 [debug] [Thread-1 (]: Began running node model.supply_chain_project.demand_forecast
[0m13:03:12.667084 [info ] [Thread-1 (]: 5 of 10 START sql table model RAW_DATA_analytics.demand_forecast ............... [RUN]
[0m13:03:12.668469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.sales_data, now model.supply_chain_project.demand_forecast)
[0m13:03:12.669403 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.demand_forecast
[0m13:03:12.673745 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.demand_forecast"
[0m13:03:12.680010 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.demand_forecast
[0m13:03:12.683726 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.demand_forecast"
[0m13:03:12.690238 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.demand_forecast"
[0m13:03:12.691595 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.demand_forecast"} */
create or replace transient table DEV.RAW_DATA_analytics.demand_forecast
         as
        (

WITH historical_sales AS (
    SELECT
        DATE_TRUNC('week', DATE_INSERT) AS sales_week,
        SKU,
        SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
    GROUP BY 1, 2
)

SELECT
    SKU,
    DATEADD('week', 1, MAX(sales_week)) AS forecast_week,
    AVG(total_units_sold) AS forecast_units_sold
FROM historical_sales
GROUP BY SKU
        );
[0m13:03:12.692644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:14.349472 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.657 seconds
[0m13:03:14.354595 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: Close
[0m13:03:14.536712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35da3b4620>]}
[0m13:03:14.538600 [info ] [Thread-1 (]: 5 of 10 OK created sql table model RAW_DATA_analytics.demand_forecast .......... [[32mSUCCESS 1[0m in 1.87s]
[0m13:03:14.541187 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.demand_forecast
[0m13:03:14.542803 [debug] [Thread-1 (]: Began running node model.supply_chain_project.inventory_efficiency
[0m13:03:14.544429 [info ] [Thread-1 (]: 6 of 10 START sql table model RAW_DATA_analytics.inventory_efficiency .......... [RUN]
[0m13:03:14.546612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.demand_forecast, now model.supply_chain_project.inventory_efficiency)
[0m13:03:14.548022 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.inventory_efficiency
[0m13:03:14.554544 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.inventory_efficiency"
[0m13:03:14.564414 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.inventory_efficiency
[0m13:03:14.569353 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.inventory_efficiency"
[0m13:03:14.579810 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.inventory_efficiency"
[0m13:03:14.581767 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.inventory_efficiency"} */
create or replace transient table DEV.RAW_DATA_analytics.inventory_efficiency
         as
        (

WITH weekly_sales AS (
    SELECT
        DATE_TRUNC('week', DATE_INSERT) AS sales_week,
        SKU,
        SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
        AVG(STOCK_LEVELS) AS average_stock
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
    GROUP BY 1, 2
)

SELECT
    SKU,
    AVG(average_stock) AS average_stock,
    SUM(total_units_sold) AS total_units_sold,
    SUM(total_units_sold) / NULLIF(SUM(average_stock), 0) AS inventory_turnover  -- Avoid division by zero
FROM weekly_sales
GROUP BY SKU
        );
[0m13:03:14.583617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:16.415795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.832 seconds
[0m13:03:16.419350 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: Close
[0m13:03:16.581708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35da3b5100>]}
[0m13:03:16.583640 [info ] [Thread-1 (]: 6 of 10 OK created sql table model RAW_DATA_analytics.inventory_efficiency ..... [[32mSUCCESS 1[0m in 2.03s]
[0m13:03:16.585098 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.inventory_efficiency
[0m13:03:16.586273 [debug] [Thread-1 (]: Began running node model.supply_chain_project.monthly_sales
[0m13:03:16.587764 [info ] [Thread-1 (]: 7 of 10 START sql table model RAW_DATA_analytics.monthly_sales ................. [RUN]
[0m13:03:16.589404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.inventory_efficiency, now model.supply_chain_project.monthly_sales)
[0m13:03:16.590550 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.monthly_sales
[0m13:03:16.594971 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.monthly_sales"
[0m13:03:16.602147 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.monthly_sales
[0m13:03:16.607328 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.monthly_sales"
[0m13:03:16.615626 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.monthly_sales"
[0m13:03:16.616713 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.monthly_sales"} */
create or replace transient table DEV.RAW_DATA_analytics.monthly_sales
         as
        (

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        SKU,
        NUMBER_OF_PRODUCTS_SOLD,
        STOCK_LEVELS,
        COSTS,
        PRICE
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100  -- Exclude invalid dates
)

SELECT
    DATE_TRUNC('month', sales_date) AS sales_month,
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_products_sold,
    AVG(STOCK_LEVELS) AS average_stock_levels,
    SUM(COSTS) AS total_costs,
    AVG(PRICE) AS average_price,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue
FROM daily_sales
GROUP BY 1, 2
        );
[0m13:03:16.617844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:18.546007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.928 seconds
[0m13:03:18.549707 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: Close
[0m13:03:18.706128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3615607b30>]}
[0m13:03:18.707776 [info ] [Thread-1 (]: 7 of 10 OK created sql table model RAW_DATA_analytics.monthly_sales ............ [[32mSUCCESS 1[0m in 2.12s]
[0m13:03:18.709316 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.monthly_sales
[0m13:03:18.710386 [debug] [Thread-1 (]: Began running node model.supply_chain_project.product_performance
[0m13:03:18.711399 [info ] [Thread-1 (]: 8 of 10 START sql table model RAW_DATA_analytics.product_performance ........... [RUN]
[0m13:03:18.712604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.monthly_sales, now model.supply_chain_project.product_performance)
[0m13:03:18.713736 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.product_performance
[0m13:03:18.717960 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.product_performance"
[0m13:03:18.725107 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.product_performance
[0m13:03:18.731230 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.product_performance"
[0m13:03:18.739083 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.product_performance"
[0m13:03:18.740717 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.product_performance"} */
create or replace transient table DEV.RAW_DATA_analytics.product_performance
         as
        (

SELECT
    PRODUCT_TYPE,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM DEV.RAW_DATA_analytics.sales_data
GROUP BY PRODUCT_TYPE
ORDER BY total_profit DESC
        );
[0m13:03:18.741722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:20.303229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.561 seconds
[0m13:03:20.307643 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: Close
[0m13:03:20.479024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d86f0fb0>]}
[0m13:03:20.480748 [info ] [Thread-1 (]: 8 of 10 OK created sql table model RAW_DATA_analytics.product_performance ...... [[32mSUCCESS 1[0m in 1.77s]
[0m13:03:20.482027 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.product_performance
[0m13:03:20.483072 [debug] [Thread-1 (]: Began running node model.supply_chain_project.safety_stock
[0m13:03:20.484918 [info ] [Thread-1 (]: 9 of 10 START sql table model RAW_DATA_analytics.safety_stock .................. [RUN]
[0m13:03:20.486541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.product_performance, now model.supply_chain_project.safety_stock)
[0m13:03:20.487592 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.safety_stock
[0m13:03:20.491830 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.safety_stock"
[0m13:03:20.498945 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.safety_stock
[0m13:03:20.502913 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.safety_stock"
[0m13:03:20.509903 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.safety_stock"
[0m13:03:20.511192 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.safety_stock"} */
create or replace transient table DEV.RAW_DATA_analytics.safety_stock
         as
        (

WITH daily_variance AS (
    SELECT
        SKU,
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        NUMBER_OF_PRODUCTS_SOLD
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
)

SELECT
    SKU,
    ROUND(1.65 * STDDEV(NUMBER_OF_PRODUCTS_SOLD)) AS safety_stock_level  -- 95% service level
FROM daily_variance
GROUP BY SKU
        );
[0m13:03:20.512084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:22.070501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.558 seconds
[0m13:03:22.074084 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: Close
[0m13:03:22.259474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35e09140b0>]}
[0m13:03:22.261618 [info ] [Thread-1 (]: 9 of 10 OK created sql table model RAW_DATA_analytics.safety_stock ............. [[32mSUCCESS 1[0m in 1.77s]
[0m13:03:22.263301 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.safety_stock
[0m13:03:22.264326 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sku_performance
[0m13:03:22.265896 [info ] [Thread-1 (]: 10 of 10 START sql table model RAW_DATA_analytics.sku_performance .............. [RUN]
[0m13:03:22.267871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.safety_stock, now model.supply_chain_project.sku_performance)
[0m13:03:22.269300 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sku_performance
[0m13:03:22.273804 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sku_performance"
[0m13:03:22.279708 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sku_performance
[0m13:03:22.286122 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sku_performance"
[0m13:03:22.293930 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sku_performance"
[0m13:03:22.295044 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sku_performance"} */
create or replace transient table DEV.RAW_DATA_analytics.sku_performance
         as
        (

SELECT
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM DEV.RAW_DATA_analytics.sales_data
GROUP BY SKU
ORDER BY total_profit DESC
        );
[0m13:03:22.296330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:24.197879 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.901 seconds
[0m13:03:24.201607 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: Close
[0m13:03:24.392156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46893228-7ff2-4997-8ff0-846164983966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d98070e0>]}
[0m13:03:24.394165 [info ] [Thread-1 (]: 10 of 10 OK created sql table model RAW_DATA_analytics.sku_performance ......... [[32mSUCCESS 1[0m in 2.12s]
[0m13:03:24.395832 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sku_performance
[0m13:03:24.397865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:24.398969 [debug] [MainThread]: Connection 'model.supply_chain_project.sku_performance' was properly closed.
[0m13:03:24.400222 [info ] [MainThread]: 
[0m13:03:24.401395 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 20.67 seconds (20.67s).
[0m13:03:24.404328 [debug] [MainThread]: Command end result
[0m13:03:24.553455 [info ] [MainThread]: 
[0m13:03:24.554609 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:03:24.555539 [info ] [MainThread]: 
[0m13:03:24.557060 [error] [MainThread]:   Database Error in model predictions (models/warehouse/predictions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 8 unexpected ')'.
  compiled code at target/run/supply_chain_project/models/warehouse/predictions.sql
[0m13:03:24.558376 [info ] [MainThread]: 
[0m13:03:24.559745 [error] [MainThread]:   Database Error in model raw_data (models/staging/raw_data.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 8 unexpected ')'.
  compiled code at target/run/supply_chain_project/models/staging/raw_data.sql
[0m13:03:24.560778 [info ] [MainThread]: 
[0m13:03:24.561819 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m13:03:24.563928 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 23.03971, "process_user_time": 4.776806, "process_kernel_time": 1.437005, "process_mem_max_rss": "249192", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:03:24.565503 [debug] [MainThread]: Command `dbt run` failed at 13:03:24.565321 after 23.04 seconds
[0m13:03:24.566460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361560c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361355f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d9828200>]}
[0m13:03:24.567337 [debug] [MainThread]: Flushing usage events
[0m13:06:11.249829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfd6f3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfdeaa6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfd49d910>]}


============================== 13:06:11.257126 | 3c96819c-29f8-41b4-92ae-d45501959895 ==============================
[0m13:06:11.257126 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:06:11.258545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:06:12.222151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfeaac6e0>]}
[0m13:06:12.279635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bcc409730>]}
[0m13:06:12.281767 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:06:12.385892 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:06:12.683552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:06:12.685153 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/staging/raw_data.sql
[0m13:06:12.686399 [debug] [MainThread]: Partial parsing: updated file: supply_chain_project://models/warehouse/predictions.sql
[0m13:06:13.011877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc7776210>]}
[0m13:06:13.192462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc78c4ef0>]}
[0m13:06:13.193570 [info ] [MainThread]: Found 10 models, 1 snapshot, 13 data tests, 4 sources, 8 metrics, 459 macros, 1 semantic model
[0m13:06:13.194783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc557a1e0>]}
[0m13:06:13.198270 [info ] [MainThread]: 
[0m13:06:13.199993 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:06:13.208047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DEV'
[0m13:06:13.227593 [debug] [ThreadPool]: Using snowflake connection "list_DEV"
[0m13:06:13.229165 [debug] [ThreadPool]: On list_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV"} */
show terse schemas in database DEV
    limit 10000
[0m13:06:13.230360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:13.831909 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.602 seconds
[0m13:06:13.834701 [debug] [ThreadPool]: On list_DEV: Close
[0m13:06:13.988572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV, now list_DEV_SNAPSHOTS)
[0m13:06:14.000081 [debug] [ThreadPool]: Using snowflake connection "list_DEV_SNAPSHOTS"
[0m13:06:14.001635 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_SNAPSHOTS"} */
show objects in DEV.SNAPSHOTS limit 10000
[0m13:06:14.002924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:14.533987 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8d972-0003-766d-0003-431a0010a3e6
[0m13:06:14.535768 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m13:06:14.537189 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m13:06:14.538122 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:06:14.538986 [debug] [ThreadPool]: On list_DEV_SNAPSHOTS: Close
[0m13:06:14.684298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DEV_SNAPSHOTS, now list_DEV_RAW_DATA_analytics)
[0m13:06:14.688410 [debug] [ThreadPool]: Using snowflake connection "list_DEV_RAW_DATA_analytics"
[0m13:06:14.689648 [debug] [ThreadPool]: On list_DEV_RAW_DATA_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "connection_name": "list_DEV_RAW_DATA_analytics"} */
show objects in DEV.RAW_DATA_analytics limit 10000
[0m13:06:14.690432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:15.299187 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.609 seconds
[0m13:06:15.302174 [debug] [ThreadPool]: On list_DEV_RAW_DATA_analytics: Close
[0m13:06:15.491219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bcdb1d7f0>]}
[0m13:06:15.492884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:06:15.494159 [info ] [MainThread]: 
[0m13:06:15.504158 [debug] [Thread-1 (]: Began running node model.supply_chain_project.metricflow_time_spine
[0m13:06:15.506005 [info ] [Thread-1 (]: 1 of 10 START sql table model RAW_DATA_analytics.metricflow_time_spine ......... [RUN]
[0m13:06:15.507653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DEV_RAW_DATA_analytics, now model.supply_chain_project.metricflow_time_spine)
[0m13:06:15.509185 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.metricflow_time_spine
[0m13:06:15.518841 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.metricflow_time_spine"
[0m13:06:15.525862 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.metricflow_time_spine
[0m13:06:15.559009 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.metricflow_time_spine"
[0m13:06:15.567169 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.metricflow_time_spine"
[0m13:06:15.568491 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.metricflow_time_spine"} */
create or replace transient table DEV.RAW_DATA_analytics.metricflow_time_spine
         as
        (

WITH recursive_date_spine AS (
    -- Start date and end date for the time spine
    SELECT
        CAST('2023-01-01' AS DATE) AS date_spine -- Update start date as needed
    UNION ALL
    SELECT
        date_spine + 1
    FROM
        recursive_date_spine
    WHERE
        date_spine + 1 <= CAST('2030-12-31' AS DATE) -- Update end date as needed
)

SELECT
    date_spine AS time_spine_date,
    DATE_TRUNC('month', date_spine) AS time_spine_month,
    DATE_TRUNC('quarter', date_spine) AS time_spine_quarter,
    DATE_TRUNC('year', date_spine) AS time_spine_year
FROM
    recursive_date_spine
        );
[0m13:06:15.569444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:17.625813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.056 seconds
[0m13:06:17.656816 [debug] [Thread-1 (]: On model.supply_chain_project.metricflow_time_spine: Close
[0m13:06:17.923959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc7d67cb0>]}
[0m13:06:17.925808 [info ] [Thread-1 (]: 1 of 10 OK created sql table model RAW_DATA_analytics.metricflow_time_spine .... [[32mSUCCESS 1[0m in 2.41s]
[0m13:06:17.927952 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.metricflow_time_spine
[0m13:06:17.930179 [debug] [Thread-1 (]: Began running node model.supply_chain_project.raw_data
[0m13:06:17.932116 [info ] [Thread-1 (]: 2 of 10 START sql table model RAW_DATA_analytics.raw_data ...................... [RUN]
[0m13:06:17.933688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.metricflow_time_spine, now model.supply_chain_project.raw_data)
[0m13:06:17.935497 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.raw_data
[0m13:06:17.940995 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.raw_data"
[0m13:06:17.950139 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.raw_data
[0m13:06:17.954320 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.raw_data"
[0m13:06:17.963013 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.raw_data"
[0m13:06:17.964338 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.raw_data"} */
create or replace transient table DEV.RAW_DATA_analytics.raw_data
         as
        (

SELECT 
    *,
    -- Calculate average revenue per product
    CASE 
        WHEN NUMBER_OF_PRODUCTS_SOLD > 0 THEN REVENUE_GENERATED / NUMBER_OF_PRODUCTS_SOLD
        ELSE NULL
    END AS avg_revenue_per_product,
    
    -- Restock flag based on stock levels
    CASE
        WHEN STOCK_LEVELS < (10 * NUMBER_OF_PRODUCTS_SOLD) THEN 1
        ELSE 0
    END AS restock_flag
    
FROM DEV.raw.supply_chain_data
WHERE NUMBER_OF_PRODUCTS_SOLD IS NOT NULL
  AND STOCK_LEVELS IS NOT NULL
  AND PRICE > 0
        );
[0m13:06:17.966216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:20.116221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.150 seconds
[0m13:06:20.120165 [debug] [Thread-1 (]: On model.supply_chain_project.raw_data: Close
[0m13:06:20.281021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc4c4bda0>]}
[0m13:06:20.283146 [info ] [Thread-1 (]: 2 of 10 OK created sql table model RAW_DATA_analytics.raw_data ................. [[32mSUCCESS 1[0m in 2.35s]
[0m13:06:20.284605 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.raw_data
[0m13:06:20.286161 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sales_data
[0m13:06:20.288121 [info ] [Thread-1 (]: 3 of 10 START sql table model RAW_DATA_analytics.sales_data .................... [RUN]
[0m13:06:20.289788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.raw_data, now model.supply_chain_project.sales_data)
[0m13:06:20.290812 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sales_data
[0m13:06:20.295956 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sales_data"
[0m13:06:20.304777 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sales_data
[0m13:06:20.309213 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sales_data"
[0m13:06:20.318408 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sales_data"
[0m13:06:20.319501 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sales_data"} */
create or replace transient table DEV.RAW_DATA_analytics.sales_data
         as
        (

SELECT
    TO_TIMESTAMP_NTZ(ld.DATE_INSERT) AS DATE_INSERT,
    ld.SKU,
    ld.PRODUCT_TYPE,
    ld.PRICE,
    ld.NUMBER_OF_PRODUCTS_SOLD,
    ld.STOCK_LEVELS,
    ld.COSTS
FROM DEV.LIVE.live_data ld
WHERE ld.DATE_INSERT IS NOT NULL
  AND DATE_PART('year', TO_TIMESTAMP_NTZ(ld.DATE_INSERT)) BETWEEN 1900 AND 2100

UNION ALL

SELECT
    wp.DATE_INSERT,
    wp.SKU,
    NULL AS PRODUCT_TYPE,
    NULL AS PRICE,
    wp.NUMBER_OF_PRODUCTS_SOLD,
    wp.STOCK_LEVELS,
    wp.COSTS
FROM DEV.LIVE.weekly_predictions wp
WHERE wp.DATE_INSERT IS NOT NULL
  AND DATE_PART('year', wp.DATE_INSERT) BETWEEN 1900 AND 2100
        );
[0m13:06:20.320372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:22.315030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.995 seconds
[0m13:06:22.318514 [debug] [Thread-1 (]: On model.supply_chain_project.sales_data: Close
[0m13:06:22.485707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc4ae9700>]}
[0m13:06:22.487654 [info ] [Thread-1 (]: 3 of 10 OK created sql table model RAW_DATA_analytics.sales_data ............... [[32mSUCCESS 1[0m in 2.20s]
[0m13:06:22.489208 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sales_data
[0m13:06:22.491011 [debug] [Thread-1 (]: Began running node model.supply_chain_project.demand_forecast
[0m13:06:22.492885 [info ] [Thread-1 (]: 4 of 10 START sql table model RAW_DATA_analytics.demand_forecast ............... [RUN]
[0m13:06:22.494563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.sales_data, now model.supply_chain_project.demand_forecast)
[0m13:06:22.495591 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.demand_forecast
[0m13:06:22.500290 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.demand_forecast"
[0m13:06:22.507827 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.demand_forecast
[0m13:06:22.511877 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.demand_forecast"
[0m13:06:22.519231 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.demand_forecast"
[0m13:06:22.520334 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.demand_forecast"} */
create or replace transient table DEV.RAW_DATA_analytics.demand_forecast
         as
        (

WITH historical_sales AS (
    SELECT
        DATE_TRUNC('week', DATE_INSERT) AS sales_week,
        SKU,
        SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
    GROUP BY 1, 2
)

SELECT
    SKU,
    DATEADD('week', 1, MAX(sales_week)) AS forecast_week,
    AVG(total_units_sold) AS forecast_units_sold
FROM historical_sales
GROUP BY SKU
        );
[0m13:06:22.521266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:24.342234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.821 seconds
[0m13:06:24.345504 [debug] [Thread-1 (]: On model.supply_chain_project.demand_forecast: Close
[0m13:06:24.505008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc4a9aab0>]}
[0m13:06:24.506627 [info ] [Thread-1 (]: 4 of 10 OK created sql table model RAW_DATA_analytics.demand_forecast .......... [[32mSUCCESS 1[0m in 2.01s]
[0m13:06:24.507856 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.demand_forecast
[0m13:06:24.508827 [debug] [Thread-1 (]: Began running node model.supply_chain_project.inventory_efficiency
[0m13:06:24.510071 [info ] [Thread-1 (]: 5 of 10 START sql table model RAW_DATA_analytics.inventory_efficiency .......... [RUN]
[0m13:06:24.511682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.demand_forecast, now model.supply_chain_project.inventory_efficiency)
[0m13:06:24.513020 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.inventory_efficiency
[0m13:06:24.517143 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.inventory_efficiency"
[0m13:06:24.523838 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.inventory_efficiency
[0m13:06:24.527666 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.inventory_efficiency"
[0m13:06:24.535773 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.inventory_efficiency"
[0m13:06:24.537159 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.inventory_efficiency"} */
create or replace transient table DEV.RAW_DATA_analytics.inventory_efficiency
         as
        (

WITH weekly_sales AS (
    SELECT
        DATE_TRUNC('week', DATE_INSERT) AS sales_week,
        SKU,
        SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
        AVG(STOCK_LEVELS) AS average_stock
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
    GROUP BY 1, 2
)

SELECT
    SKU,
    AVG(average_stock) AS average_stock,
    SUM(total_units_sold) AS total_units_sold,
    SUM(total_units_sold) / NULLIF(SUM(average_stock), 0) AS inventory_turnover  -- Avoid division by zero
FROM weekly_sales
GROUP BY SKU
        );
[0m13:06:24.538091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:26.286375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.748 seconds
[0m13:06:26.290501 [debug] [Thread-1 (]: On model.supply_chain_project.inventory_efficiency: Close
[0m13:06:26.489075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc7beb140>]}
[0m13:06:26.490603 [info ] [Thread-1 (]: 5 of 10 OK created sql table model RAW_DATA_analytics.inventory_efficiency ..... [[32mSUCCESS 1[0m in 1.98s]
[0m13:06:26.492053 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.inventory_efficiency
[0m13:06:26.493382 [debug] [Thread-1 (]: Began running node model.supply_chain_project.monthly_sales
[0m13:06:26.494841 [info ] [Thread-1 (]: 6 of 10 START sql table model RAW_DATA_analytics.monthly_sales ................. [RUN]
[0m13:06:26.496024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.inventory_efficiency, now model.supply_chain_project.monthly_sales)
[0m13:06:26.496997 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.monthly_sales
[0m13:06:26.504546 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.monthly_sales"
[0m13:06:26.511616 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.monthly_sales
[0m13:06:26.515667 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.monthly_sales"
[0m13:06:26.523184 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.monthly_sales"
[0m13:06:26.524582 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.monthly_sales"} */
create or replace transient table DEV.RAW_DATA_analytics.monthly_sales
         as
        (

WITH daily_sales AS (
    SELECT
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        SKU,
        NUMBER_OF_PRODUCTS_SOLD,
        STOCK_LEVELS,
        COSTS,
        PRICE
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100  -- Exclude invalid dates
)

SELECT
    DATE_TRUNC('month', sales_date) AS sales_month,
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_products_sold,
    AVG(STOCK_LEVELS) AS average_stock_levels,
    SUM(COSTS) AS total_costs,
    AVG(PRICE) AS average_price,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue
FROM daily_sales
GROUP BY 1, 2
        );
[0m13:06:26.525455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:28.614780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.089 seconds
[0m13:06:28.618184 [debug] [Thread-1 (]: On model.supply_chain_project.monthly_sales: Close
[0m13:06:28.810538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c00a43a10>]}
[0m13:06:28.812199 [info ] [Thread-1 (]: 6 of 10 OK created sql table model RAW_DATA_analytics.monthly_sales ............ [[32mSUCCESS 1[0m in 2.31s]
[0m13:06:28.813938 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.monthly_sales
[0m13:06:28.815221 [debug] [Thread-1 (]: Began running node model.supply_chain_project.predictions
[0m13:06:28.816277 [info ] [Thread-1 (]: 7 of 10 START sql table model RAW_DATA_analytics.predictions ................... [RUN]
[0m13:06:28.817451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.monthly_sales, now model.supply_chain_project.predictions)
[0m13:06:28.818378 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.predictions
[0m13:06:28.823260 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.predictions"
[0m13:06:28.830119 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.predictions
[0m13:06:28.834318 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.predictions"
[0m13:06:28.842310 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.predictions"
[0m13:06:28.843711 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.predictions"} */
create or replace transient table DEV.RAW_DATA_analytics.predictions
         as
        (

WITH forecast_data AS (
    SELECT
        SKU,
        DATEADD('week', 1, MAX(DATE_INSERT)) AS forecast_week,
        AVG(NUMBER_OF_PRODUCTS_SOLD) AS forecast_units_sold
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE NUMBER_OF_PRODUCTS_SOLD > 0
    GROUP BY SKU
)

SELECT
    fd.SKU,
    fd.forecast_week,
    fd.forecast_units_sold,
    r.PRODUCT_TYPE,
    r.AVAILABILITY,
    r.STOCK_LEVELS
FROM forecast_data fd
LEFT JOIN DEV.RAW_DATA_analytics.raw_data r
    ON fd.SKU = r.SKU
WHERE r.AVAILABILITY > 0
        );
[0m13:06:28.845056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:31.316322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.471 seconds
[0m13:06:31.319463 [debug] [Thread-1 (]: On model.supply_chain_project.predictions: Close
[0m13:06:31.517046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc4b1f800>]}
[0m13:06:31.518715 [info ] [Thread-1 (]: 7 of 10 OK created sql table model RAW_DATA_analytics.predictions .............. [[32mSUCCESS 1[0m in 2.70s]
[0m13:06:31.520028 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.predictions
[0m13:06:31.521054 [debug] [Thread-1 (]: Began running node model.supply_chain_project.product_performance
[0m13:06:31.522626 [info ] [Thread-1 (]: 8 of 10 START sql table model RAW_DATA_analytics.product_performance ........... [RUN]
[0m13:06:31.524560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.predictions, now model.supply_chain_project.product_performance)
[0m13:06:31.525579 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.product_performance
[0m13:06:31.529915 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.product_performance"
[0m13:06:31.536385 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.product_performance
[0m13:06:31.542738 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.product_performance"
[0m13:06:31.549478 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.product_performance"
[0m13:06:31.550561 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.product_performance"} */
create or replace transient table DEV.RAW_DATA_analytics.product_performance
         as
        (

SELECT
    PRODUCT_TYPE,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM DEV.RAW_DATA_analytics.sales_data
GROUP BY PRODUCT_TYPE
ORDER BY total_profit DESC
        );
[0m13:06:31.551540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:33.440221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.889 seconds
[0m13:06:33.443727 [debug] [Thread-1 (]: On model.supply_chain_project.product_performance: Close
[0m13:06:33.614354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc4b26c30>]}
[0m13:06:33.616064 [info ] [Thread-1 (]: 8 of 10 OK created sql table model RAW_DATA_analytics.product_performance ...... [[32mSUCCESS 1[0m in 2.09s]
[0m13:06:33.617458 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.product_performance
[0m13:06:33.618538 [debug] [Thread-1 (]: Began running node model.supply_chain_project.safety_stock
[0m13:06:33.619831 [info ] [Thread-1 (]: 9 of 10 START sql table model RAW_DATA_analytics.safety_stock .................. [RUN]
[0m13:06:33.621429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.product_performance, now model.supply_chain_project.safety_stock)
[0m13:06:33.622536 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.safety_stock
[0m13:06:33.626899 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.safety_stock"
[0m13:06:33.633955 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.safety_stock
[0m13:06:33.637919 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.safety_stock"
[0m13:06:33.645615 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.safety_stock"
[0m13:06:33.646844 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.safety_stock"} */
create or replace transient table DEV.RAW_DATA_analytics.safety_stock
         as
        (

WITH daily_variance AS (
    SELECT
        SKU,
        DATE_TRUNC('day', DATE_INSERT) AS sales_date,
        NUMBER_OF_PRODUCTS_SOLD
    FROM DEV.RAW_DATA_analytics.sales_data
    WHERE DATE_INSERT IS NOT NULL
      AND DATE_PART('year', DATE_INSERT) BETWEEN 1900 AND 2100
)

SELECT
    SKU,
    ROUND(1.65 * STDDEV(NUMBER_OF_PRODUCTS_SOLD)) AS safety_stock_level  -- 95% service level
FROM daily_variance
GROUP BY SKU
        );
[0m13:06:33.647767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:35.542314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.894 seconds
[0m13:06:35.545396 [debug] [Thread-1 (]: On model.supply_chain_project.safety_stock: Close
[0m13:06:35.750097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c00a44380>]}
[0m13:06:35.751535 [info ] [Thread-1 (]: 9 of 10 OK created sql table model RAW_DATA_analytics.safety_stock ............. [[32mSUCCESS 1[0m in 2.13s]
[0m13:06:35.753221 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.safety_stock
[0m13:06:35.754444 [debug] [Thread-1 (]: Began running node model.supply_chain_project.sku_performance
[0m13:06:35.755757 [info ] [Thread-1 (]: 10 of 10 START sql table model RAW_DATA_analytics.sku_performance .............. [RUN]
[0m13:06:35.757101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supply_chain_project.safety_stock, now model.supply_chain_project.sku_performance)
[0m13:06:35.758313 [debug] [Thread-1 (]: Began compiling node model.supply_chain_project.sku_performance
[0m13:06:35.762709 [debug] [Thread-1 (]: Writing injected SQL for node "model.supply_chain_project.sku_performance"
[0m13:06:35.769765 [debug] [Thread-1 (]: Began executing node model.supply_chain_project.sku_performance
[0m13:06:35.774418 [debug] [Thread-1 (]: Writing runtime sql for node "model.supply_chain_project.sku_performance"
[0m13:06:35.781473 [debug] [Thread-1 (]: Using snowflake connection "model.supply_chain_project.sku_performance"
[0m13:06:35.782758 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "group_project", "target_name": "dev", "node_id": "model.supply_chain_project.sku_performance"} */
create or replace transient table DEV.RAW_DATA_analytics.sku_performance
         as
        (

SELECT
    SKU,
    SUM(NUMBER_OF_PRODUCTS_SOLD) AS total_units_sold,
    SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) AS total_revenue,
    SUM(COSTS) AS total_costs,
    (SUM(NUMBER_OF_PRODUCTS_SOLD * PRICE) - SUM(COSTS)) AS total_profit
FROM DEV.RAW_DATA_analytics.sales_data
GROUP BY SKU
ORDER BY total_profit DESC
        );
[0m13:06:35.784205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:37.885310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.101 seconds
[0m13:06:37.888991 [debug] [Thread-1 (]: On model.supply_chain_project.sku_performance: Close
[0m13:06:38.125461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c96819c-29f8-41b4-92ae-d45501959895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c00a43aa0>]}
[0m13:06:38.127423 [info ] [Thread-1 (]: 10 of 10 OK created sql table model RAW_DATA_analytics.sku_performance ......... [[32mSUCCESS 1[0m in 2.37s]
[0m13:06:38.129724 [debug] [Thread-1 (]: Finished running node model.supply_chain_project.sku_performance
[0m13:06:38.132017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:38.132903 [debug] [MainThread]: Connection 'model.supply_chain_project.sku_performance' was properly closed.
[0m13:06:38.133858 [info ] [MainThread]: 
[0m13:06:38.134929 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 24.93 seconds (24.93s).
[0m13:06:38.137705 [debug] [MainThread]: Command end result
[0m13:06:38.293683 [info ] [MainThread]: 
[0m13:06:38.295126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:06:38.296260 [info ] [MainThread]: 
[0m13:06:38.297281 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:06:38.299657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.166239, "process_user_time": 4.707939, "process_kernel_time": 1.313523, "process_mem_max_rss": "250388", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m13:06:38.301317 [debug] [MainThread]: Command `dbt run` succeeded at 13:06:38.301147 after 27.17 seconds
[0m13:06:38.302327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc4a90ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc4a93b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bc4a932f0>]}
[0m13:06:38.303354 [debug] [MainThread]: Flushing usage events
